var u=Object.defineProperty;var m=(i,t,s)=>t in i?u(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var a=(i,t,s)=>(m(i,typeof t!="symbol"?t+"":t,s),s);import{l as f,w as c}from"./BaseDemo-21616005.js";const o=class{constructor(){a(this,"stage");a(this,"_helpPoint",new f.Point);a(this,"_dragOffset",new f.Point);a(this,"_dragDisplayObject",null)}static getInstance(){return o._instance}enableDrag(t){t.interactive=!0,t.addListener("touchstart",this._dragHandler,this),t.addListener("touchend",this._dragHandler,this),t.addListener("mousedown",this._dragHandler,this),t.addListener("mouseup",this._dragHandler,this)}disableDrag(t){t.removeListener("touchstart",this._dragHandler,this),t.removeListener("touchend",this._dragHandler,this),t.removeListener("mousedown",this._dragHandler,this),t.removeListener("mouseup",this._dragHandler,this)}_dragHandler(t){var s,n,d,l;switch(t.type){case"touchstart":case"mousedown":if(this._dragDisplayObject)return;this._dragDisplayObject=t.target;const g=this._dragDisplayObject.parent,e=g.armature.getBoneByDisplay(this._dragDisplayObject);e&&(this._helpPoint.x=t.data.global.x,this._helpPoint.y=t.data.global.y,g.toLocal(this._helpPoint,this.stage),e.offsetMode!==c.Override&&(e.offsetMode=c.Override,e.offset.x=e.global.x,e.offset.y=e.global.y),this._dragOffset.x=e.offset.x-this._helpPoint.x,this._dragOffset.y=e.offset.y-this._helpPoint.y,(s=this.stage)==null||s.addListener("touchmove",this._dragHandler,this),(n=this.stage)==null||n.addListener("mousemove",this._dragHandler,this));break;case"touchend":case"mouseup":this._dragDisplayObject&&((d=this.stage)==null||d.removeListener("touchmove",this._dragHandler,this),(l=this.stage)==null||l.removeListener("mousemove",this._dragHandler,this),this._dragDisplayObject=null);break;case"touchmove":case"mousemove":if(this._dragDisplayObject){const _=this._dragDisplayObject.parent,r=_.armature.getBoneByDisplay(this._dragDisplayObject);r&&(this._helpPoint.x=t.data.global.x,this._helpPoint.y=t.data.global.y,_.toLocal(this._helpPoint,this.stage),r.offset.x=this._helpPoint.x+this._dragOffset.x,r.offset.y=this._helpPoint.y+this._dragOffset.y,r.invalidUpdate())}break}}};let h=o;a(h,"_instance",new o);export{h as D};
