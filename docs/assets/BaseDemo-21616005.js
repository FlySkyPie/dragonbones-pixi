var xu=Object.defineProperty;var wu=(r,t,i)=>t in r?xu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var xt=(r,t,i)=>(wu(r,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();var bu=Object.defineProperty,Eu=(r,t,i)=>t in r?bu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i,c=(r,t,i)=>(Eu(r,typeof t!="symbol"?t+"":t,i),i);class Su{constructor(t=0){c(this,"time",0),c(this,"timeScale",1),c(this,"_systemTime",0),c(this,"_animatebles",[]),c(this,"_clock",null),this.time=t,this._systemTime=new Date().getTime()*.001}advanceTime(t){t!==t&&(t=0);const i=Date.now()*.001;if(t<0&&(t=i-this._systemTime),this._systemTime=i,this.timeScale!==1&&(t*=this.timeScale),t===0)return;t<0?this.time-=t:this.time+=t;let e=0,n=0,a=this._animatebles.length;for(;e<a;++e){const s=this._animatebles[e];s!==null?(n>0&&(this._animatebles[e-n]=s,this._animatebles[e]=null),s.advanceTime(t)):n++}if(n>0){for(a=this._animatebles.length;e<a;++e){const s=this._animatebles[e];s!==null?this._animatebles[e-n]=s:n++}this._animatebles.length-=n}}contains(t){if(t===this)return!1;let i=t;for(;i!==this&&i!==null;)i=i.clock;return i===this}add(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)}remove(t){const i=this._animatebles.indexOf(t);i>=0&&(this._animatebles[i]=null,t.clock=null)}clear(){for(const t of this._animatebles)t!==null&&(t.clock=null)}get clock(){return this._clock}set clock(t){this._clock!==t&&(this._clock!==null&&this._clock.remove(this),this._clock=t,this._clock!==null&&this._clock.add(this))}}const ct=class{constructor(){c(this,"hashCode",ct._hashCode++),c(this,"_isInPool",!1)}static _returnObject(r){const t=String(r.constructor),i=t in ct._maxCountMap?ct._maxCountMap[t]:ct._defaultMaxCount,e=ct._poolsMap[t]=ct._poolsMap[t]||[];e.length<i&&(r._isInPool?console.warn("The object is already in the pool."):(r._isInPool=!0,e.push(r)))}static toString(){throw new Error}static setMaxCount(r,t){if((t<0||t!==t)&&(t=0),r!==null){const i=String(r),e=i in ct._poolsMap?ct._poolsMap[i]:null;e!==null&&e.length>t&&(e.length=t),ct._maxCountMap[i]=t}else{ct._defaultMaxCount=t;for(let i in ct._poolsMap){const e=ct._poolsMap[i];e.length>t&&(e.length=t),i in ct._maxCountMap&&(ct._maxCountMap[i]=t)}}}static clearPool(r=null){if(r!==null){const t=String(r),i=t in ct._poolsMap?ct._poolsMap[t]:null;i!==null&&i.length>0&&(i.length=0)}else for(let t in ct._poolsMap){const i=ct._poolsMap[t];i.length=0}}static borrowObject(r){const t=String(r),i=t in ct._poolsMap?ct._poolsMap[t]:null;if(i!==null&&i.length>0){const n=i.pop();return n._isInPool=!1,n}const e=new r;return e._onClear(),e}returnToPool(){this._onClear(),ct._returnObject(this)}};let R=ct;c(R,"_hashCode",0),c(R,"_defaultMaxCount",3e3),c(R,"_maxCountMap",{}),c(R,"_poolsMap",{});const _i=class extends R{constructor(){super(...arguments),c(this,"time",0),c(this,"type",""),c(this,"name",""),c(this,"armature",null),c(this,"bone",null),c(this,"slot",null),c(this,"animationState",null),c(this,"actionData",null),c(this,"data",null)}static actionDataToInstance(r,t,i){if(r.name===void 0)throw new Error("data.name is undefined.");if(r.name===void 0)throw new Error("data.name is undefined.");r.type===lt.Play?t.type=_i.FRAME_EVENT:t.type=r.type===lt.Frame?_i.FRAME_EVENT:_i.SOUND_EVENT,t.name=r.name,t.armature=i,t.actionData=r,t.data=r.data,r.bone!==null&&(t.bone=i.getBone(r.bone.name)),r.slot!==null&&(t.slot=i.getSlot(r.slot.name))}static toString(){return"[class dragonBones.EventObject]"}_onClear(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null}};let rt=_i;c(rt,"START","start"),c(rt,"LOOP_COMPLETE","loopComplete"),c(rt,"COMPLETE","complete"),c(rt,"FADE_IN","fadeIn"),c(rt,"FADE_IN_COMPLETE","fadeInComplete"),c(rt,"FADE_OUT","fadeOut"),c(rt,"FADE_OUT_COMPLETE","fadeOutComplete"),c(rt,"FRAME_EVENT","frameEvent"),c(rt,"SOUND_EVENT","soundEvent");var P=(r=>(r[r.WeigthBoneCount=0]="WeigthBoneCount",r[r.WeigthFloatOffset=1]="WeigthFloatOffset",r[r.WeigthBoneIndices=2]="WeigthBoneIndices",r[r.GeometryVertexCount=0]="GeometryVertexCount",r[r.GeometryTriangleCount=1]="GeometryTriangleCount",r[r.GeometryFloatOffset=2]="GeometryFloatOffset",r[r.GeometryWeightOffset=3]="GeometryWeightOffset",r[r.GeometryVertexIndices=4]="GeometryVertexIndices",r[r.TimelineScale=0]="TimelineScale",r[r.TimelineOffset=1]="TimelineOffset",r[r.TimelineKeyFrameCount=2]="TimelineKeyFrameCount",r[r.TimelineFrameValueCount=3]="TimelineFrameValueCount",r[r.TimelineFrameValueOffset=4]="TimelineFrameValueOffset",r[r.TimelineFrameOffset=5]="TimelineFrameOffset",r[r.FramePosition=0]="FramePosition",r[r.FrameTweenType=1]="FrameTweenType",r[r.FrameTweenEasingOrCurveSampleCount=2]="FrameTweenEasingOrCurveSampleCount",r[r.FrameCurveSamples=3]="FrameCurveSamples",r[r.DeformVertexOffset=0]="DeformVertexOffset",r[r.DeformCount=1]="DeformCount",r[r.DeformValueCount=2]="DeformValueCount",r[r.DeformValueOffset=3]="DeformValueOffset",r[r.DeformFloatOffset=4]="DeformFloatOffset",r))(P||{}),oe=(r=>(r[r.Armature=0]="Armature",r[r.MovieClip=1]="MovieClip",r[r.Stage=2]="Stage",r))(oe||{}),mt=(r=>(r[r.Bone=0]="Bone",r[r.Surface=1]="Surface",r))(mt||{}),Q=(r=>(r[r.Image=0]="Image",r[r.Armature=1]="Armature",r[r.Mesh=2]="Mesh",r[r.BoundingBox=3]="BoundingBox",r[r.Path=4]="Path",r))(Q||{}),yt=(r=>(r[r.Rectangle=0]="Rectangle",r[r.Ellipse=1]="Ellipse",r[r.Polygon=2]="Polygon",r))(yt||{}),lt=(r=>(r[r.Play=0]="Play",r[r.Frame=10]="Frame",r[r.Sound=11]="Sound",r))(lt||{}),st=(r=>(r[r.Normal=0]="Normal",r[r.Add=1]="Add",r[r.Alpha=2]="Alpha",r[r.Darken=3]="Darken",r[r.Difference=4]="Difference",r[r.Erase=5]="Erase",r[r.HardLight=6]="HardLight",r[r.Invert=7]="Invert",r[r.Layer=8]="Layer",r[r.Lighten=9]="Lighten",r[r.Multiply=10]="Multiply",r[r.Overlay=11]="Overlay",r[r.Screen=12]="Screen",r[r.Subtract=13]="Subtract",r))(st||{}),ut=(r=>(r[r.None=0]="None",r[r.Line=1]="Line",r[r.Curve=2]="Curve",r[r.QuadIn=3]="QuadIn",r[r.QuadOut=4]="QuadOut",r[r.QuadInOut=5]="QuadInOut",r))(ut||{}),C=(r=>(r[r.Action=0]="Action",r[r.ZOrder=1]="ZOrder",r[r.BoneAll=10]="BoneAll",r[r.BoneTranslate=11]="BoneTranslate",r[r.BoneRotate=12]="BoneRotate",r[r.BoneScale=13]="BoneScale",r[r.Surface=50]="Surface",r[r.BoneAlpha=60]="BoneAlpha",r[r.SlotDisplay=20]="SlotDisplay",r[r.SlotColor=21]="SlotColor",r[r.SlotDeform=22]="SlotDeform",r[r.SlotZIndex=23]="SlotZIndex",r[r.SlotAlpha=24]="SlotAlpha",r[r.IKConstraint=30]="IKConstraint",r[r.AnimationProgress=40]="AnimationProgress",r[r.AnimationWeight=41]="AnimationWeight",r[r.AnimationParameter=42]="AnimationParameter",r))(C||{}),ar=(r=>(r[r.None=0]="None",r[r.Additive=1]="Additive",r[r.Override=2]="Override",r))(ar||{}),$t=(r=>(r[r.SameLayer=1]="SameLayer",r[r.SameGroup=2]="SameGroup",r[r.SameLayerAndGroup=3]="SameLayerAndGroup",r[r.All=4]="All",r[r.Single=5]="Single",r))($t||{}),Ft=(r=>(r[r.None=0]="None",r[r.E1D=1]="E1D",r))(Ft||{}),Se=(r=>(r[r.IK=0]="IK",r[r.Path=1]="Path",r))(Se||{}),Ee=(r=>(r[r.Fixed=0]="Fixed",r[r.Percent=1]="Percent",r))(Ee||{}),Zt=(r=>(r[r.Length=0]="Length",r[r.Fixed=1]="Fixed",r[r.Percent=2]="Percent",r))(Zt||{}),Xt=(r=>(r[r.Tangent=0]="Tangent",r[r.Chain=1]="Chain",r[r.ChainScale=2]="ChainScale",r))(Xt||{});const Fl=class{constructor(r){c(this,"_clock",new Su),c(this,"_events",[]),c(this,"_objects",[]),c(this,"_eventManager",null),this._eventManager=r,console.info(`DragonBones: ${Fl.VERSION}
Website: http://dragonbones.com/
Source and Demo: https://github.com/DragonBones/`)}advanceTime(r){if(this._objects.length>0){for(const t of this._objects)t.returnToPool();this._objects.length=0}if(this._clock.advanceTime(r),this._events.length>0){for(let t=0;t<this._events.length;++t){const i=this._events[t],e=i.armature;if(e===null)throw new Error("armature is null.");e._armatureData!==null&&(e.eventDispatcher.dispatchDBEvent(i.type,i),i.type===rt.SOUND_EVENT&&this._eventManager.dispatchDBEvent(i.type,i)),this.bufferObject(i)}this._events.length=0}}bufferEvent(r){this._events.indexOf(r)<0&&this._events.push(r)}bufferObject(r){this._objects.indexOf(r)<0&&this._objects.push(r)}get clock(){return this._clock}get eventManager(){return this._eventManager}};let Ct=Fl;c(Ct,"VERSION","5.7.000"),c(Ct,"yDown",!0),c(Ct,"debug",!1),c(Ct,"debugDraw",!1);class Ti extends R{constructor(){super(...arguments),c(this,"dirty",!1),c(this,"playState",-1),c(this,"currentPlayTimes",0),c(this,"currentTime",-1),c(this,"target",null),c(this,"_isTween",!1),c(this,"_valueOffset",0),c(this,"_frameValueOffset",0),c(this,"_frameOffset",0),c(this,"_frameRate",0),c(this,"_frameCount",0),c(this,"_frameIndex",-1),c(this,"_frameRateR",0),c(this,"_position",0),c(this,"_duration",0),c(this,"_timeScale",1),c(this,"_timeOffset",0),c(this,"_animationData",null),c(this,"_timelineData",null),c(this,"_armature",null),c(this,"_animationState",null),c(this,"_actionTimeline",null),c(this,"_timelineArray",null),c(this,"_frameArray",null),c(this,"_valueArray",null),c(this,"_frameIndices",null)}_onClear(){this.dirty=!1,this.playState=-1,this.currentPlayTimes=0,this.currentTime=-1,this.target=null,this._isTween=!1,this._valueOffset=0,this._frameValueOffset=0,this._frameOffset=0,this._frameRate=0,this._frameCount=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._valueArray=null,this._timelineArray=null,this._frameIndices=null}_setCurrentTime(t){const i=this.playState,e=this.currentPlayTimes,n=this.currentTime;if(this._actionTimeline!==null&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(this._actionTimeline===null||this._timeScale!==1||this._timeOffset!==0){if(this._animationState===null)throw new Error("this._animationState is null.");if(this._animationData===null)throw new Error("this._animationData is null.");const a=this._animationState.playTimes,s=a*this._duration;t*=this._timeScale,this._timeOffset!==0&&(t+=this._timeOffset*this._animationData.duration),a>0&&(t>=s||t<=-s)?(this.playState<=0&&this._animationState._playheadState===3&&(this.playState=1),this.currentPlayTimes=a,t<0?this.currentTime=0:this.currentTime=this.playState===1?this._duration+1e-6:this._duration):(this.playState!==0&&this._animationState._playheadState===3&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return this.currentPlayTimes===e&&this.currentTime===n?!1:((i<0&&this.playState!==i||this.playState<=0&&this.currentPlayTimes!==e)&&(this._frameIndex=-1),!0)}init(t,i,e){if(this._armature=t,this._animationState=i,this._timelineData=e,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState.animationData,this._animationData.parent===null)throw new Error("this._animationData.parent is null.");if(this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._timelineData!==null){const n=this._animationData.parent.parent;if(n===null)throw new Error("dragonBonesData is null.");if(this._frameArray=n.frameArray,this._timelineArray=n.timelineArray,this._frameIndices=n.frameIndices,this._timelineArray===null)throw new Error("this._timelineArray is null.");this._frameCount=this._timelineArray[this._timelineData.offset+P.TimelineKeyFrameCount],this._frameValueOffset=this._timelineArray[this._timelineData.offset+P.TimelineFrameValueOffset],this._timeScale=100/this._timelineArray[this._timelineData.offset+P.TimelineScale],this._timeOffset=this._timelineArray[this._timelineData.offset+P.TimelineOffset]*.01}}fadeOut(){this.dirty=!1}update(t){if(this._setCurrentTime(t)){if(this._frameCount>1){const i=Math.floor(this.currentTime*this._frameRate);if(this._frameIndices===null)throw new Error("this._frameIndices is null.");const e=this._frameIndices[this._timelineData.frameIndicesOffset+i];if(this._frameIndex!==e){if(this._frameIndex=e,this._animationData===null)throw new Error(" this._animationData is null.");if(this._timelineArray===null)throw new Error(" this._timelineArray is null.");this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameOffset+this._frameIndex],this._onArriveAtFrame()}}else if(this._frameIndex<0){if(this._frameIndex=0,this._timelineData!==null){if(this._animationData===null)throw new Error(" this._animationData is null.");if(this._timelineArray===null)throw new Error(" this._timelineArray is null.");this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameOffset]}this._onArriveAtFrame()}(this._isTween||this.dirty)&&this._onUpdateFrame()}}blend(t){}}class De extends Ti{constructor(){super(...arguments),c(this,"_tweenType",ut.None),c(this,"_curveCount",0),c(this,"_framePosition",0),c(this,"_frameDurationR",0),c(this,"_tweenEasing",0),c(this,"_tweenProgress",0),c(this,"_valueScale",1)}static _getEasingValue(t,i,e){let n=i;switch(t){case ut.QuadIn:n=Math.pow(i,2);break;case ut.QuadOut:n=1-Math.pow(1-i,2);break;case ut.QuadInOut:n=.5*(1-Math.cos(i*Math.PI));break}return(n-i)*e+i}static _getEasingCurveValue(t,i,e,n){if(t<=0)return 0;if(t>=1)return 1;const a=e>0,s=e+1,o=Math.floor(t*s);let l=0,h=0;return a?(l=o===0?0:i[n+o-1],h=o===s-1?1e4:i[n+o]):(l=i[n+o-1],h=i[n+o]),(l+(h-l)*(t*s-o))*1e-4}_onClear(){super._onClear(),this._tweenType=ut.None,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenEasing=0,this._tweenProgress=0,this._valueScale=1}_onArriveAtFrame(){if(this._animationState===null)throw new Error(" this._animationState is null.");if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||this._animationState.playTimes===0||this._animationState.currentPlayTimes<this._animationState.playTimes-1)){if(this._frameArray===null)throw new Error(" this._frameArray is null.");if(this._tweenType=this._frameArray[this._frameOffset+P.FrameTweenType],this._isTween=this._tweenType!==ut.None,this._isTween?this._tweenType===ut.Curve?this._curveCount=this._frameArray[this._frameOffset+P.FrameTweenEasingOrCurveSampleCount]:this._tweenType!==ut.None&&this._tweenType!==ut.Line&&(this._tweenEasing=this._frameArray[this._frameOffset+P.FrameTweenEasingOrCurveSampleCount]*.01):this.dirty=!0,this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._animationData===null)throw new Error(" this._animationData is null.");if(this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{if(this._timelineArray===null)throw new Error(" this._timelineArray is null.");const t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameOffset+this._frameIndex+1],i=this._frameArray[t]*this._frameRateR-this._framePosition;i>0?this._frameDurationR=1/i:this._frameDurationR=0}}else this.dirty=!0,this._isTween=!1}_onUpdateFrame(){if(this._isTween)if(this.dirty=!0,this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,this._tweenType===ut.Curve){if(this._frameArray===null)throw new Error(" this._frameArray is null.");this._tweenProgress=De._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+P.FrameCurveSamples)}else this._tweenType!==ut.Line&&(this._tweenProgress=De._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing))}}class br extends De{constructor(){super(...arguments),c(this,"_currentA",0),c(this,"_currentB",0),c(this,"_differenceA",0),c(this,"_differenceB",0),c(this,"_resultA",0),c(this,"_resultB",0)}_onClear(){super._onClear(),this._currentA=0,this._currentB=0,this._differenceA=0,this._differenceB=0,this._resultA=0,this._resultB=0}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){const t=this._valueScale,i=this._valueArray,e=this._valueOffset+this._frameValueOffset+this._frameIndex*2;if(i===null)throw new Error("valueArray is null.");if(this._isTween){const n=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:e+2;t===1?(this._currentA=i[e],this._currentB=i[e+1],this._differenceA=i[n]-this._currentA,this._differenceB=i[n+1]-this._currentB):(this._currentA=i[e]*t,this._currentB=i[e+1]*t,this._differenceA=i[n]*t-this._currentA,this._differenceB=i[n+1]*t-this._currentB)}else this._resultA=i[e]*t,this._resultB=i[e+1]*t}else this._resultA=0,this._resultB=0}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._resultA=this._currentA+this._differenceA*this._tweenProgress,this._resultB=this._currentB+this._differenceB*this._tweenProgress)}}class wa extends De{constructor(){super(...arguments),c(this,"_valueCount",0),c(this,"_rd",[])}_onClear(){super._onClear(),this._valueCount=0,this._rd.length=0}_onArriveAtFrame(){super._onArriveAtFrame();const t=this._valueCount,i=this._rd;if(this._timelineData!==null){const e=this._valueScale,n=this._valueArray;if(n===null)throw new Error("valueArray is null.");const a=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(this._isTween){const s=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:a+t;if(e===1)for(let o=0;o<t;++o)i[t+o]=n[s+o]-n[a+o];else for(let o=0;o<t;++o)i[t+o]=(n[s+o]-n[a+o])*e}else if(e===1)for(let s=0;s<t;++s)i[s]=n[a+s];else for(let s=0;s<t;++s)i[s]=n[a+s]*e}else for(let e=0;e<t;++e)i[e]=0}_onUpdateFrame(){if(super._onUpdateFrame(),this._isTween){const t=this._valueCount,i=this._valueScale,e=this._tweenProgress,n=this._valueArray,a=this._rd,s=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(n===null)throw new Error("valueArray is null.");if(i===1)for(let o=0;o<t;++o)a[o]=n[s+o]+a[t+o]*e;else for(let o=0;o<t;++o)a[o]=n[s+o]*i+a[t+o]*e}}}class xi extends De{constructor(){super(...arguments),c(this,"_current",0),c(this,"_difference",0),c(this,"_result",0)}_onClear(){super._onClear(),this._current=0,this._difference=0,this._result=0}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){const t=this._valueScale,i=this._valueArray,e=this._valueOffset+this._frameValueOffset+this._frameIndex;if(i===null)throw new Error("valueArray is null.");if(this._isTween){const n=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:e+1;t===1?(this._current=i[e],this._difference=i[n]-this._current):(this._current=i[e]*t,this._difference=i[n]*t-this._current)}else this._result=i[e]*t}else this._result=0}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._result=this._current+this._difference*this._tweenProgress)}}class Du extends R{constructor(){super(...arguments),c(this,"pauseFadeOut",!0),c(this,"fadeOutMode",$t.All),c(this,"fadeOutTweenType",ut.Line),c(this,"fadeOutTime",-1),c(this,"pauseFadeIn",!0),c(this,"actionEnabled",!0),c(this,"additive",!1),c(this,"displayControl",!0),c(this,"resetToPose",!0),c(this,"fadeInTweenType",ut.Line),c(this,"playTimes",-1),c(this,"layer",0),c(this,"position",0),c(this,"duration",-1),c(this,"timeScale",1),c(this,"weight",1),c(this,"fadeInTime",-1),c(this,"autoFadeOutTime",-1),c(this,"name",""),c(this,"animation",""),c(this,"group",""),c(this,"boneMask",[])}static toString(){return"[class dragonBones.AnimationConfig]"}_onClear(){this.pauseFadeOut=!0,this.fadeOutMode=$t.All,this.fadeOutTweenType=ut.Line,this.fadeOutTime=-1,this.actionEnabled=!0,this.additive=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=ut.Line,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0}clear(){this._onClear()}copyFrom(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additive=t.additive,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(let i=0,e=this.boneMask.length;i<e;++i)this.boneMask[i]=t.boneMask[i]}}const Bl=class{constructor(r=0,t=0,i=0,e=0,n=1,a=1){c(this,"x"),c(this,"y"),c(this,"skew"),c(this,"rotation"),c(this,"scaleX"),c(this,"scaleY"),this.x=r,this.y=t,this.skew=i,this.rotation=e,this.scaleX=n,this.scaleY=a}static normalizeRadian(r){return r=(r+Math.PI)%(Math.PI*2),r+=r>0?-Math.PI:Math.PI,r}toString(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+this.skew*180/Math.PI+" skewY:"+this.rotation*180/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY}copyFrom(r){return this.x=r.x,this.y=r.y,this.skew=r.skew,this.rotation=r.rotation,this.scaleX=r.scaleX,this.scaleY=r.scaleY,this}identity(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this}add(r){return this.x+=r.x,this.y+=r.y,this.skew+=r.skew,this.rotation+=r.rotation,this.scaleX*=r.scaleX,this.scaleY*=r.scaleY,this}minus(r){return this.x-=r.x,this.y-=r.y,this.skew-=r.skew,this.rotation-=r.rotation,this.scaleX/=r.scaleX,this.scaleY/=r.scaleY,this}fromMatrix(r){const t=this.scaleX,i=this.scaleY,e=Bl.PI_Q;this.x=r.tx,this.y=r.ty,this.rotation=Math.atan(r.b/r.a);let n=Math.atan(-r.c/r.d);return this.scaleX=this.rotation>-e&&this.rotation<e?r.a/Math.cos(this.rotation):r.b/Math.sin(this.rotation),this.scaleY=n>-e&&n<e?r.d/Math.cos(n):-r.c/Math.sin(n),t>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),i>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,n=n-Math.PI),this.skew=n-this.rotation,this}toMatrix(r){return this.rotation===0?(r.a=1,r.b=0):(r.a=Math.cos(this.rotation),r.b=Math.sin(this.rotation)),this.skew===0?(r.c=-r.b,r.d=r.a):(r.c=-Math.sin(this.skew+this.rotation),r.d=Math.cos(this.skew+this.rotation)),this.scaleX!==1&&(r.a*=this.scaleX,r.b*=this.scaleX),this.scaleY!==1&&(r.c*=this.scaleY,r.d*=this.scaleY),r.tx=this.x,r.ty=this.y,this}};let Y=Bl;c(Y,"PI",Math.PI),c(Y,"PI_D",Math.PI*2),c(Y,"PI_H",Math.PI/2),c(Y,"PI_Q",Math.PI/4),c(Y,"RAD_DEG",180/Math.PI),c(Y,"DEG_RAD",Math.PI/180);class Au extends Ti{static toString(){return"[class dragonBones.ActionTimelineState]"}_onCrossFrame(t){if(this._armature===null)throw new Error("this._armature is null.");if(this._animationState===null)throw new Error("this._animationState is null.");if(this._animationData===null)throw new Error("this._animationData is null.");if(this._timelineArray===null)throw new Error("this._timelineArray is null.");if(this._frameArray===null)throw new Error("this._frameArray is null.");if(this._animationData.parent===null)throw new Error("this._animationData.parent is null.");if(this._armature._dragonBones===null)throw new Error(" this._armature._dragonBones is null.");const i=this._armature.eventDispatcher;if(this._animationState.actionEnabled){const e=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameOffset+t],n=this._frameArray[e+1],a=this._animationData.parent.actions;for(let s=0;s<n;++s){const o=this._frameArray[e+2+s],l=a[o];if(l.type===lt.Play){const h=R.borrowObject(rt);h.time=this._frameArray[e]/this._frameRate,h.animationState=this._animationState,rt.actionDataToInstance(l,h,this._armature),this._armature._bufferAction(h,!0)}else{const h=l.type===lt.Frame?rt.FRAME_EVENT:rt.SOUND_EVENT;if(l.type===lt.Sound||i.hasDBEventListener(h)){const u=R.borrowObject(rt);u.time=this._frameArray[e]/this._frameRate,u.animationState=this._animationState,rt.actionDataToInstance(l,u,this._armature),this._armature._dragonBones.bufferEvent(u)}}}}}_onArriveAtFrame(){}_onUpdateFrame(){}update(t){const i=this.playState;let e=this.currentPlayTimes,n=this.currentTime;if(this._armature===null)throw new Error("this._armature is null.");if(this._animationState===null)throw new Error("this._animationState is null.");if(this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error("this._animationData.parent is null.");if(this._armature._dragonBones===null)throw new Error(" this._armature._dragonBones is null.");if(this._setCurrentTime(t)){const a=this._animationState._parent===null&&this._animationState.actionEnabled,s=this._armature.eventDispatcher;if(i<0)if(this.playState!==i){if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),a&&s.hasDBEventListener(rt.START)){const u=R.borrowObject(rt);u.type=rt.START,u.armature=this._armature,u.animationState=this._animationState,this._armature._dragonBones.bufferEvent(u)}}else return;const o=this._animationState.timeScale<0;let l=null,h=null;if(a&&this.currentPlayTimes!==e&&(s.hasDBEventListener(rt.LOOP_COMPLETE)&&(l=R.borrowObject(rt),l.type=rt.LOOP_COMPLETE,l.armature=this._armature,l.animationState=this._animationState),this.playState>0&&s.hasDBEventListener(rt.COMPLETE)&&(h=R.borrowObject(rt),h.type=rt.COMPLETE,h.armature=this._armature,h.animationState=this._animationState)),this._frameCount>1){const u=this._timelineData,f=Math.floor(this.currentTime*this._frameRate);if(this._frameIndices===null)throw new Error(" this._frameIndices is null.");const d=this._frameIndices[u.frameIndicesOffset+f];if(this._frameIndex!==d){let p=this._frameIndex;if(this._frameIndex=d,this._timelineArray!==null)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[u.offset+P.TimelineFrameOffset+this._frameIndex],o){if(p<0){const _=Math.floor(n*this._frameRate);p=this._frameIndices[u.frameIndicesOffset+_],this.currentPlayTimes===e&&p===d&&(p=-1)}for(;p>=0;){const _=this._animationData.frameOffset+this._timelineArray[u.offset+P.TimelineFrameOffset+p];if(this._frameArray===null)throw new Error("this._frameArray is null.");const m=this._frameArray[_]/this._frameRate;if(this._position<=m&&m<=this._position+this._duration&&this._onCrossFrame(p),l!==null&&p===0&&(this._armature._dragonBones.bufferEvent(l),l=null),p>0?p--:p=this._frameCount-1,p===d)break}}else{if(p<0){const _=Math.floor(n*this._frameRate);p=this._frameIndices[u.frameIndicesOffset+_];const m=this._animationData.frameOffset+this._timelineArray[u.offset+P.TimelineFrameOffset+p];if(this._frameArray===null)throw new Error("this._frameArray is null.");const g=this._frameArray[m]/this._frameRate;this.currentPlayTimes===e&&(n<=g?p>0?p--:p=this._frameCount-1:p===d&&(p=-1))}for(;p>=0;){p<this._frameCount-1?p++:p=0;const _=this._animationData.frameOffset+this._timelineArray[u.offset+P.TimelineFrameOffset+p];if(this._frameArray===null)throw new Error("this._frameArray is null.");const m=this._frameArray[_]/this._frameRate;if(this._position<=m&&m<=this._position+this._duration&&this._onCrossFrame(p),l!==null&&p===0&&(this._armature._dragonBones.bufferEvent(l),l=null),p===d)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,this._timelineData!==null)){if(this._timelineArray===null)throw new Error("this._timelineArray is null.");if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameOffset],this._frameArray===null)throw new Error("this._frameArray is null.");const u=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===e?n<=u&&this._onCrossFrame(this._frameIndex):this._position<=u&&(!o&&l!==null&&(this._armature._dragonBones.bufferEvent(l),l=null),this._onCrossFrame(this._frameIndex))}l!==null&&this._armature._dragonBones.bufferEvent(l),h!==null&&this._armature._dragonBones.bufferEvent(h)}}setCurrentTime(t){this._setCurrentTime(t),this._frameIndex=-1}}class Mu extends Ti{static toString(){return"[class dragonBones.ZOrderTimelineState]"}_onArriveAtFrame(){if(this._armature===null)throw new Error("this._armature is null.");if(this._frameArray===null)throw new Error("this._frameArray is null.");this.playState>=0&&(this._frameArray[this._frameOffset+1]>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))}_onUpdateFrame(){}}class io extends wa{static toString(){return"[class dragonBones.BoneAllTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._isTween&&this._frameIndex===this._frameCount-1&&(this._rd[2]=Y.normalizeRadian(this._rd[2]),this._rd[3]=Y.normalizeRadian(this._rd[3])),this._timelineData===null&&(this._rd[4]=1,this._rd[5]=1)}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=6,this._valueArray=this._animationData.parent.parent.frameFloatArray}fadeOut(){this.dirty=!1,this._rd[2]=Y.normalizeRadian(this._rd[2]),this._rd[3]=Y.normalizeRadian(this._rd[3])}blend(t){if(this._armature===null)throw new Error("this._armature is null.");const i=this._armature.armatureData.scale,e=this._rd,n=this.target,a=n.target,s=n.blendWeight,o=a.animationPose;n.dirty>1?(o.x+=e[0]*s*i,o.y+=e[1]*s*i,o.rotation+=e[2]*s,o.skew+=e[3]*s,o.scaleX+=(e[4]-1)*s,o.scaleY+=(e[5]-1)*s):(o.x=e[0]*s*i,o.y=e[1]*s*i,o.rotation=e[2]*s,o.skew=e[3]*s,o.scaleX=(e[4]-1)*s+1,o.scaleY=(e[5]-1)*s+1),(t||this.dirty)&&(this.dirty=!1,a._transformDirty=!0)}}class Ou extends br{static toString(){return"[class dragonBones.BoneTranslateTimelineState]"}init(t,i,e){if(super.init(t,i,e),this._armature===null)throw new Error("this._armature is null.");if(this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=this._animationData.parent.parent.frameFloatArray}blend(t){const i=this.target,e=i.target,n=i.blendWeight,a=e.animationPose;i.dirty>1?(a.x+=this._resultA*n,a.y+=this._resultB*n):n!==1?(a.x=this._resultA*n,a.y=this._resultB*n):(a.x=this._resultA,a.y=this._resultB),(t||this.dirty)&&(this.dirty=!1,e._transformDirty=!0)}}class Pu extends br{static toString(){return"[class dragonBones.BoneRotateTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._isTween&&this._frameIndex===this._frameCount-1&&(this._differenceA=Y.normalizeRadian(this._differenceA),this._differenceB=Y.normalizeRadian(this._differenceB))}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray}fadeOut(){this.dirty=!1,this._resultA=Y.normalizeRadian(this._resultA),this._resultB=Y.normalizeRadian(this._resultB)}blend(t){const i=this.target,e=i.target,n=i.blendWeight,a=e.animationPose;i.dirty>1?(a.rotation+=this._resultA*n,a.skew+=this._resultB*n):n!==1?(a.rotation=this._resultA*n,a.skew=this._resultB*n):(a.rotation=this._resultA,a.skew=this._resultB),(t||this.dirty)&&(this.dirty=!1,e._transformDirty=!0)}}class Ru extends br{static toString(){return"[class dragonBones.BoneScaleTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._timelineData===null&&(this._resultA=1,this._resultB=1)}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray}blend(t){const i=this.target,e=i.target,n=i.blendWeight,a=e.animationPose;i.dirty>1?(a.scaleX+=(this._resultA-1)*n,a.scaleY+=(this._resultB-1)*n):n!==1?(a.scaleX=(this._resultA-1)*n+1,a.scaleY=(this._resultB-1)*n+1):(a.scaleX=this._resultA,a.scaleY=this._resultB),(t||this.dirty)&&(this.dirty=!1,e._transformDirty=!0)}}class no extends wa{constructor(){super(...arguments),c(this,"_deformCount",0),c(this,"_deformOffset",0),c(this,"_sameValueOffset",0)}static toString(){return"[class dragonBones.SurfaceTimelineState]"}_onClear(){super._onClear(),this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0}init(t,i,e){if(super.init(t,i,e),this._timelineData!==null){if(this._armature===null)throw new Error("this._armature is null.");if(this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");if(this._timelineArray===null)throw new Error("this._timelineArray is null.");const n=this._animationData.parent.parent,a=n.frameIntArray,s=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameValueCount];if(a===null)throw new Error("frameIntArray is null.");this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=a[s+P.DeformValueCount],this._deformCount=a[s+P.DeformCount],this._deformOffset=a[s+P.DeformValueOffset],this._sameValueOffset=a[s+P.DeformFloatOffset]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=n.frameFloatArray,this._rd.length=this._valueCount*2}else this._deformCount=this.target.target._deformVertices.length}blend(t){const i=this.target,e=i.target,n=i.blendWeight,a=e._deformVertices,s=this._valueArray;if(s!==null){const o=this._valueCount,l=this._deformOffset,h=this._sameValueOffset,u=this._rd;for(let f=0;f<this._deformCount;++f){let d=0;f<l?d=s[h+f]:f<l+o?d=u[f-l]:d=s[h+f-o],i.dirty>1?a[f]+=d*n:a[f]=d*n}}else if(i.dirty===1)for(let o=0;o<this._deformCount;++o)a[o]=0;(t||this.dirty)&&(this.dirty=!1,e._transformDirty=!0)}}class ao extends xi{static toString(){return"[class dragonBones.AlphaTimelineState]"}_onArriveAtFrame(){super._onArriveAtFrame(),this._timelineData===null&&(this._result=1)}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray}blend(t){const i=this.target,e=i.target,n=i.blendWeight;if(i.dirty>1?(e._alpha+=this._result*n,e._alpha>1&&(e._alpha=1)):e._alpha=this._result*n,this._armature===null)throw new Error("this._armature is null.");(t||this.dirty)&&(this.dirty=!1,this._armature._alphaDirty=!0)}}class so extends Ti{static toString(){return"[class dragonBones.SlotDisplayTimelineState]"}_onArriveAtFrame(){if(this.playState<0)return;const t=this.target;if(t._slotData===null)throw new Error("slot._slotData is null.");const i=(()=>{if(this._timelineData!==null){if(this._frameArray===null)throw new Error("this._frameArray is null.");return this._frameArray[this._frameOffset+1]}return t._slotData.displayIndex})();t.displayIndex!==i&&t._setDisplayIndex(i,!0)}_onUpdateFrame(){}}class oo extends De{constructor(){super(...arguments),c(this,"_current",[0,0,0,0,0,0,0,0]),c(this,"_difference",[0,0,0,0,0,0,0,0]),c(this,"_result",[0,0,0,0,0,0,0,0])}static toString(){return"[class dragonBones.SlotColorTimelineState]"}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData!==null){if(this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");const t=this._animationData.parent.parent,i=t.colorArray,e=t.frameIntArray,n=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex;if(e===null)throw new Error(" frameIntArray is null.");let a=e[n];if(a<0&&(a+=65536),i===null)throw new Error(" colorArray is null.");this._isTween?(this._current[0]=i[a++],this._current[1]=i[a++],this._current[2]=i[a++],this._current[3]=i[a++],this._current[4]=i[a++],this._current[5]=i[a++],this._current[6]=i[a++],this._current[7]=i[a++],this._frameIndex===this._frameCount-1?a=e[this._animationData.frameIntOffset+this._frameValueOffset]:a=e[n+1],a<0&&(a+=65536),this._difference[0]=i[a++]-this._current[0],this._difference[1]=i[a++]-this._current[1],this._difference[2]=i[a++]-this._current[2],this._difference[3]=i[a++]-this._current[3],this._difference[4]=i[a++]-this._current[4],this._difference[5]=i[a++]-this._current[5],this._difference[6]=i[a++]-this._current[6],this._difference[7]=i[a++]-this._current[7]):(this._result[0]=i[a++]*.01,this._result[1]=i[a++]*.01,this._result[2]=i[a++]*.01,this._result[3]=i[a++]*.01,this._result[4]=i[a++],this._result[5]=i[a++],this._result[6]=i[a++],this._result[7]=i[a++])}else{const t=this.target.slotData.color;if(t===null)throw new Error(" color is null.");this._result[0]=t.alphaMultiplier,this._result[1]=t.redMultiplier,this._result[2]=t.greenMultiplier,this._result[3]=t.blueMultiplier,this._result[4]=t.alphaOffset,this._result[5]=t.redOffset,this._result[6]=t.greenOffset,this._result[7]=t.blueOffset}}_onUpdateFrame(){super._onUpdateFrame(),this._isTween&&(this._result[0]=(this._current[0]+this._difference[0]*this._tweenProgress)*.01,this._result[1]=(this._current[1]+this._difference[1]*this._tweenProgress)*.01,this._result[2]=(this._current[2]+this._difference[2]*this._tweenProgress)*.01,this._result[3]=(this._current[3]+this._difference[3]*this._tweenProgress)*.01,this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress,this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress,this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress,this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress)}fadeOut(){this._isTween=!1}update(t){if(super.update(t),this._isTween||this.dirty){const i=this.target,e=i._colorTransform;if(this._animationState===null)throw new Error("this._animationState is null.");if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){if(e.alphaMultiplier!==this._result[0]||e.redMultiplier!==this._result[1]||e.greenMultiplier!==this._result[2]||e.blueMultiplier!==this._result[3]||e.alphaOffset!==this._result[4]||e.redOffset!==this._result[5]||e.greenOffset!==this._result[6]||e.blueOffset!==this._result[7]){const n=Math.pow(this._animationState._fadeProgress,4);e.alphaMultiplier+=(this._result[0]-e.alphaMultiplier)*n,e.redMultiplier+=(this._result[1]-e.redMultiplier)*n,e.greenMultiplier+=(this._result[2]-e.greenMultiplier)*n,e.blueMultiplier+=(this._result[3]-e.blueMultiplier)*n,e.alphaOffset+=(this._result[4]-e.alphaOffset)*n,e.redOffset+=(this._result[5]-e.redOffset)*n,e.greenOffset+=(this._result[6]-e.greenOffset)*n,e.blueOffset+=(this._result[7]-e.blueOffset)*n,i._colorDirty=!0}}else this.dirty&&(this.dirty=!1,(e.alphaMultiplier!==this._result[0]||e.redMultiplier!==this._result[1]||e.greenMultiplier!==this._result[2]||e.blueMultiplier!==this._result[3]||e.alphaOffset!==this._result[4]||e.redOffset!==this._result[5]||e.greenOffset!==this._result[6]||e.blueOffset!==this._result[7])&&(e.alphaMultiplier=this._result[0],e.redMultiplier=this._result[1],e.greenMultiplier=this._result[2],e.blueMultiplier=this._result[3],e.alphaOffset=this._result[4],e.redOffset=this._result[5],e.greenOffset=this._result[6],e.blueOffset=this._result[7],i._colorDirty=!0))}}}class Iu extends xi{static toString(){return"[class dragonBones.SlotZIndexTimelineState]"}_onArriveAtFrame(){if(super._onArriveAtFrame(),this._timelineData===null){const t=this.target.target;this._result=t.slotData.zIndex}}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueArray=this._animationData.parent.parent.frameIntArray}blend(t){const i=this.target,e=i.target,n=i.blendWeight;if(i.dirty>1?e._zIndex+=this._result*n:e._zIndex=this._result*n,this._armature===null)throw new Error("this._armature is null.");(t||this.dirty)&&(this.dirty=!1,this._armature._zIndexDirty=!0)}}class lo extends wa{constructor(){super(...arguments),c(this,"displayFrame",null),c(this,"_deformCount",0),c(this,"_deformOffset",0),c(this,"_sameValueOffset",0)}static toString(){return"[class dragonBones.DeformTimelineState]"}_onClear(){super._onClear(),this.displayFrame=null,this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0}init(t,i,e){if(super.init(t,i,e),this._timelineData!==null){if(this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");if(this._timelineArray===null)throw new Error("this._timelineArray is null.");const n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+P.TimelineFrameValueCount],a=this._animationData.parent.parent,s=a.frameIntArray;if(s===null)throw new Error("frameIntArray is null.");if(this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=s[n+P.DeformValueCount],this._deformCount=s[n+P.DeformCount],this._deformOffset=s[n+P.DeformValueOffset],this._sameValueOffset=s[n+P.DeformFloatOffset],this._sameValueOffset<0&&(this._sameValueOffset+=65536),this._sameValueOffset+=this._animationData.frameFloatOffset,this._armature===null)throw new Error("this._armature is null.");this._valueScale=this._armature.armatureData.scale,this._valueArray=a.frameFloatArray,this._rd.length=this._valueCount*2}else{if(this.displayFrame===null)throw new Error("this.displayFrame is null.");this._deformCount=this.displayFrame.deformVertices.length}}blend(t){if(this.displayFrame===null)throw new Error("this.displayFrame is null.");const i=this.target,e=i.target,n=i.blendWeight,a=this.displayFrame.deformVertices,s=this._valueArray;if(s!==null){const o=this._valueCount,l=this._deformOffset,h=this._sameValueOffset,u=this._rd;for(let f=0;f<this._deformCount;++f){let d=0;f<l?d=s[h+f]:f<l+o?d=u[f-l]:d=s[h+f-o],i.dirty>1?a[f]+=d*n:a[f]=d*n}}else if(i.dirty===1)for(let o=0;o<this._deformCount;++o)a[o]=0;(t||this.dirty)&&(this.dirty=!1,e._geometryData===this.displayFrame.getGeometryData()&&(e._verticesDirty=!0))}}class ho extends br{static toString(){return"[class dragonBones.IKConstraintTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;if(this._timelineData!==null)t._bendPositive=this._currentA>0,t._weight=this._currentB;else{const i=t._constraintData;t._bendPositive=i.bendPositive,t._weight=i.weight}t.invalidUpdate(),this.dirty=!1}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray}}class Cu extends xi{static toString(){return"[class dragonBones.AnimationProgressTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.currentTime=this._result*t.totalTime),this.dirty=!1}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class Fu extends xi{static toString(){return"[class dragonBones.AnimationWeightTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.weight=this._result),this.dirty=!1}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class Bu extends br{static toString(){return"[class dragonBones.AnimationParametersTimelineState]"}_onUpdateFrame(){super._onUpdateFrame();const t=this.target;t._parent!==null&&(t.parameterX=this._resultA,t.parameterY=this._resultB),this.dirty=!1}init(t,i,e){if(super.init(t,i,e),this._animationData===null)throw new Error("this._animationData is null.");if(this._animationData.parent===null)throw new Error(" this._animationData.parent is null.");if(this._animationData.parent.parent===null)throw new Error(" this._animationData.parent.parent is null.");this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray}}class Lu extends R{constructor(){super(...arguments),c(this,"actionEnabled",!1),c(this,"additive",!1),c(this,"displayControl",!1),c(this,"resetToPose",!1),c(this,"blendType",Ft.None),c(this,"playTimes",1),c(this,"layer",0),c(this,"timeScale",1),c(this,"parameterX",0),c(this,"parameterY",0),c(this,"positionX",0),c(this,"positionY",0),c(this,"autoFadeOutTime",0),c(this,"fadeTotalTime",0),c(this,"name",""),c(this,"group",""),c(this,"_timelineDirty",2),c(this,"_playheadState",0),c(this,"_fadeState",-1),c(this,"_subFadeState",1),c(this,"_position",0),c(this,"_duration",0),c(this,"_weight",1),c(this,"_fadeTime",0),c(this,"_time",0),c(this,"_fadeProgress",0),c(this,"_weightResult",0),c(this,"_boneMask",[]),c(this,"_boneTimelines",[]),c(this,"_boneBlendTimelines",[]),c(this,"_slotTimelines",[]),c(this,"_slotBlendTimelines",[]),c(this,"_constraintTimelines",[]),c(this,"_animationTimelines",[]),c(this,"_poseTimelines",[]),c(this,"_animationData",null),c(this,"_armature",null),c(this,"_actionTimeline",null),c(this,"_zOrderTimeline",null),c(this,"_activeChildA",null),c(this,"_activeChildB",null),c(this,"_parent",null)}static toString(){return"[class dragonBones.AnimationState]"}_onClear(){for(const t of this._boneTimelines)t.returnToPool();for(const t of this._boneBlendTimelines)t.returnToPool();for(const t of this._slotTimelines)t.returnToPool();for(const t of this._slotBlendTimelines)t.returnToPool();for(const t of this._constraintTimelines)t.returnToPool();for(const t of this._animationTimelines){const i=t.target;i._parent===this&&(i._fadeState=1,i._subFadeState=1,i._parent=null),t.returnToPool()}this._actionTimeline!==null&&this._actionTimeline.returnToPool(),this._zOrderTimeline!==null&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additive=!1,this.displayControl=!1,this.resetToPose=!1,this.blendType=Ft.None,this.playTimes=1,this.layer=0,this.timeScale=1,this._weight=1,this.parameterX=0,this.parameterY=0,this.positionX=0,this.positionY=0,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._boneBlendTimelines.length=0,this._slotTimelines.length=0,this._slotBlendTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._activeChildA=null,this._activeChildB=null,this._parent=null}_updateTimelines(){{if(this._armature===null)throw new Error("this._armature is null.");if(this._animationData===null)throw new Error("this._animationData is null.");for(const t of this._armature._constraints){const i=this._animationData.getConstraintTimelines(t.name);if(i!==null)for(const e of i)switch(e.type){case C.IKConstraint:{const n=R.borrowObject(ho);n.target=t,n.init(this._armature,this,e),this._constraintTimelines.push(n);break}}else if(this.resetToPose){const e=R.borrowObject(ho);e.target=t,e.init(this._armature,this,null),this._constraintTimelines.push(e),this._poseTimelines.push(e)}}}}_updateBoneAndSlotTimelines(){var t;{const i={};for(const e of this._boneTimelines){const n=e.target.target.name;n in i||(i[n]=[]),i[n].push(e)}for(const e of this._boneBlendTimelines){const n=e.target.target.name;n in i||(i[n]=[]),i[n].push(e)}if(this._armature===null)throw new Error("this._armature is null.");if(this._animationData===null)throw new Error("this._animationData is null.");for(const e of this._armature.getBones()){const n=e.name;if(this.containsBoneMask(n))if(n in i)delete i[n];else{const a=this._animationData.getBoneTimelines(n),s=this._armature.animation.getBlendState(bt.BONE_TRANSFORM,e.name,e);if(a!==null)for(const o of a)switch(o.type){case C.BoneAll:{const l=R.borrowObject(io);l.target=s,l.init(this._armature,this,o),this._boneTimelines.push(l);break}case C.BoneTranslate:{const l=R.borrowObject(Ou);l.target=s,l.init(this._armature,this,o),this._boneTimelines.push(l);break}case C.BoneRotate:{const l=R.borrowObject(Pu);l.target=s,l.init(this._armature,this,o),this._boneTimelines.push(l);break}case C.BoneScale:{const l=R.borrowObject(Ru);l.target=s,l.init(this._armature,this,o),this._boneTimelines.push(l);break}case C.BoneAlpha:{const l=R.borrowObject(ao);l.target=this._armature.animation.getBlendState(bt.BONE_ALPHA,e.name,e),l.init(this._armature,this,o),this._boneBlendTimelines.push(l);break}case C.Surface:{const l=R.borrowObject(no);l.target=this._armature.animation.getBlendState(bt.SURFACE,e.name,e),l.init(this._armature,this,o),this._boneBlendTimelines.push(l);break}}else if(this.resetToPose)if(((t=e._boneData)==null?void 0:t.type)===mt.Bone){const o=R.borrowObject(io);o.target=s,o.init(this._armature,this,null),this._boneTimelines.push(o),this._poseTimelines.push(o)}else{const o=R.borrowObject(no);o.target=this._armature.animation.getBlendState(bt.SURFACE,e.name,e),o.init(this._armature,this,null),this._boneBlendTimelines.push(o),this._poseTimelines.push(o)}}}for(let e in i)for(const n of i[e]){let a=this._boneTimelines.indexOf(n);a>=0&&(this._boneTimelines.splice(a,1),n.returnToPool()),a=this._boneBlendTimelines.indexOf(n),a>=0&&(this._boneBlendTimelines.splice(a,1),n.returnToPool())}}{const i={},e=[];for(const n of this._slotTimelines){const a=n.target.name;a in i||(i[a]=[]),i[a].push(n)}for(const n of this._slotBlendTimelines){const a=n.target.target.name;a in i||(i[a]=[]),i[a].push(n)}for(const n of this._armature.getSlots()){const a=n.parent.name;if(!this.containsBoneMask(a))continue;const s=n.name;if(s in i)delete i[s];else{let o=!1,l=!1;e.length=0;const h=this._animationData.getSlotTimelines(s);if(h!==null)for(const u of h)switch(u.type){case C.SlotDisplay:{const f=R.borrowObject(so);f.target=n,f.init(this._armature,this,u),this._slotTimelines.push(f),o=!0;break}case C.SlotZIndex:{const f=R.borrowObject(Iu);f.target=this._armature.animation.getBlendState(bt.SLOT_Z_INDEX,n.name,n),f.init(this._armature,this,u),this._slotBlendTimelines.push(f);break}case C.SlotColor:{const f=R.borrowObject(oo);f.target=n,f.init(this._armature,this,u),this._slotTimelines.push(f),l=!0;break}case C.SlotDeform:{if(this._animationData.parent===null)throw new Error("this._animationData.parent is null.");const f=this._animationData.parent.parent;if(f===null)throw new Error("dragonBonesData is null.");const d=f.timelineArray;if(d===null)throw new Error("timelineArray is null.");const p=this._animationData.frameIntOffset+d[u.offset+P.TimelineFrameValueCount],_=f.frameIntArray;if(p===null)throw new Error("frameIntOffset is null.");if(_===null)throw new Error("frameIntArray is null.");let m=_[p+P.DeformVertexOffset];m<0&&(m+=65536);for(let g=0,y=n.displayFrameCount;g<y;++g){const w=n.getDisplayFrameAt(g),T=w.getGeometryData();if(T!==null&&T.offset===m){const x=R.borrowObject(lo);x.target=this._armature.animation.getBlendState(bt.SLOT_DEFORM,w.rawDisplayData.name,n),x.displayFrame=w,x.init(this._armature,this,u),this._slotBlendTimelines.push(x),w.updateDeformVertices(),e.push(m);break}}break}case C.SlotAlpha:{const f=R.borrowObject(ao);f.target=this._armature.animation.getBlendState(bt.SLOT_ALPHA,n.name,n),f.init(this._armature,this,u),this._slotBlendTimelines.push(f);break}}if(this.resetToPose){if(!o){const u=R.borrowObject(so);u.target=n,u.init(this._armature,this,null),this._slotTimelines.push(u),this._poseTimelines.push(u)}if(!l){const u=R.borrowObject(oo);u.target=n,u.init(this._armature,this,null),this._slotTimelines.push(u),this._poseTimelines.push(u)}for(let u=0,f=n.displayFrameCount;u<f;++u){const d=n.getDisplayFrameAt(u);if(d.deformVertices.length===0)continue;const p=d.getGeometryData();if(p!==null&&e.indexOf(p.offset)<0){const _=R.borrowObject(lo);_.displayFrame=d,_.target=this._armature.animation.getBlendState(bt.SLOT_DEFORM,n.name,n),_.init(this._armature,this,null),this._slotBlendTimelines.push(_),this._poseTimelines.push(_)}}}}}for(let n in i)for(const a of i[n]){let s=this._slotTimelines.indexOf(a);s>=0&&(this._slotTimelines.splice(s,1),a.returnToPool()),s=this._slotBlendTimelines.indexOf(a),s>=0&&(this._slotBlendTimelines.splice(s,1),a.returnToPool())}}}_advanceFadeTime(t){const i=this._fadeState>0;if(this._subFadeState<0&&(this._subFadeState=0,this._parent===null&&this.actionEnabled)){const e=i?rt.FADE_OUT:rt.FADE_IN;if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._dragonBones===null)throw new Error("this._armature._dragonBones is null.");if(this._armature.eventDispatcher.hasDBEventListener(e)){const n=R.borrowObject(rt);n.type=e,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}if(t<0&&(t=-t),this._fadeTime+=t,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=i?0:1):this._fadeTime>0?this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=i?1:0,this._subFadeState>0&&(i||(this._playheadState|=1,this._fadeState=0),this._parent===null&&this.actionEnabled)){const e=i?rt.FADE_OUT_COMPLETE:rt.FADE_IN_COMPLETE;if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._dragonBones===null)throw new Error("this._armature._dragonBones is null.");if(this._armature.eventDispatcher.hasDBEventListener(e)){const n=R.borrowObject(rt);n.type=e,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}}init(t,i,e){if(this._armature===null){if(this._armature=t,this._animationData=i,this.resetToPose=e.resetToPose,this.additive=e.additive,this.displayControl=e.displayControl,this.actionEnabled=e.actionEnabled,this.blendType=i.blendType,this.layer=e.layer,this.playTimes=e.playTimes,this.timeScale=e.timeScale,this.fadeTotalTime=e.fadeInTime,this.autoFadeOutTime=e.autoFadeOutTime,this.name=e.name.length>0?e.name:e.animation,this.group=e.group,this._weight=e.weight,e.pauseFadeIn?this._playheadState=2:this._playheadState=3,e.duration<0?(this._position=0,this._duration=this._animationData.duration,e.position!==0?this.timeScale>=0?this._time=e.position:this._time=e.position-this._duration:this._time=0):(this._position=e.position,this._duration=e.duration,this._time=0),this.timeScale<0&&this._time===0&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),e.boneMask.length>0){this._boneMask.length=e.boneMask.length;for(let n=0,a=this._boneMask.length;n<a;++n)this._boneMask[n]=e.boneMask[n]}this._actionTimeline=R.borrowObject(Au),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),this._animationData.zOrderTimeline!==null&&(this._zOrderTimeline=R.borrowObject(Mu),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}}advanceTime(t,i){(this._fadeState!==0||this._subFadeState!==0)&&this._advanceFadeTime(t),this._playheadState===3&&(this.timeScale!==1&&(t*=this.timeScale),this._time+=t),this._timelineDirty!==0&&(this._timelineDirty===2&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines());const e=this._fadeState!==0||this._subFadeState===0,n=this._fadeState===0&&i>0;let a=!0,s=!0,o=this._time;if(this._weightResult=this._weight*this._fadeProgress,this._parent!==null&&(this._weightResult*=this._parent._weightResult),this._actionTimeline===null)throw new Error("this._actionTimeline is null.");if(this._actionTimeline.playState<=0&&this._actionTimeline.update(o),this._weight!==0){if(n){const l=i*2;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*l)/l}if(this._zOrderTimeline!==null&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(o),this._armature===null)throw new Error("this._armature is null.");if(this._animationData===null)throw new Error("this._animationData is null.");if(n){const l=Math.floor(this._actionTimeline.currentTime*i);this._armature._cacheFrameIndex===l?(a=!1,s=!1):(this._armature._cacheFrameIndex=l,this._animationData.cachedFrames[l]?s=!1:this._animationData.cachedFrames[l]=!0)}if(a){let l=!1,h=null;if(s)for(let u=0,f=this._boneTimelines.length;u<f;++u){const d=this._boneTimelines[u];if(d.playState<=0&&d.update(o),d.target!==h){const p=d.target;if(l=p.update(this),h=p,p.dirty===1){const _=p.target.animationPose;_.x=0,_.y=0,_.rotation=0,_.skew=0,_.scaleX=1,_.scaleY=1}}l&&d.blend(e)}for(let u=0,f=this._boneBlendTimelines.length;u<f;++u){const d=this._boneBlendTimelines[u];d.playState<=0&&d.update(o),d.target.update(this)&&d.blend(e)}if(this.displayControl)for(let u=0,f=this._slotTimelines.length;u<f;++u){const d=this._slotTimelines[u];if(d.playState<=0){const p=d.target.displayController;(p===null||p===this.name||p===this.group)&&d.update(o)}}for(let u=0,f=this._slotBlendTimelines.length;u<f;++u){const d=this._slotBlendTimelines[u];if(d.playState<=0){const p=d.target;d.update(o),p.update(this)&&d.blend(e)}}for(let u=0,f=this._constraintTimelines.length;u<f;++u){const d=this._constraintTimelines[u];d.playState<=0&&d.update(o)}if(this._animationTimelines.length>0){let u=100,f=100,d=null,p=null;for(let _=0,m=this._animationTimelines.length;_<m;++_){const g=this._animationTimelines[_];if(g.playState<=0&&g.update(o),this.blendType===Ft.E1D){const y=g.target,w=this.parameterX-y.positionX;w>=0?w<u&&(u=w,d=y):-w<f&&(f=-w,p=y)}}d!==null&&(this._activeChildA!==d&&(this._activeChildA!==null&&(this._activeChildA.weight=0),this._activeChildA=d,this._activeChildA.activeTimeline()),this._activeChildB!==p&&(this._activeChildB!==null&&(this._activeChildB.weight=0),this._activeChildB=p),d.weight=f/(u+f),p&&(p.weight=1-d.weight))}}if(this._fadeState===0){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(const l of this._poseTimelines){let h=this._boneTimelines.indexOf(l);if(h>=0){this._boneTimelines.splice(h,1),l.returnToPool();continue}if(h=this._boneBlendTimelines.indexOf(l),h>=0){this._boneBlendTimelines.splice(h,1),l.returnToPool();continue}if(h=this._slotTimelines.indexOf(l),h>=0){this._slotTimelines.splice(h,1),l.returnToPool();continue}if(h=this._slotBlendTimelines.indexOf(l),h>=0){this._slotBlendTimelines.splice(h,1),l.returnToPool();continue}if(h=this._constraintTimelines.indexOf(l),h>=0){this._constraintTimelines.splice(h,1),l.returnToPool();continue}}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}}play(){this._playheadState=3}stop(){this._playheadState&=1}fadeOut(t,i=!0){if(t<0&&(t=0),i&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(const e of this._boneTimelines)e.fadeOut();for(const e of this._boneBlendTimelines)e.fadeOut();for(const e of this._slotTimelines)e.fadeOut();for(const e of this._slotBlendTimelines)e.fadeOut();for(const e of this._constraintTimelines)e.fadeOut();for(const e of this._animationTimelines)e.fadeOut(),e.target.fadeOut(999999,!0)}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)}containsBoneMask(t){return this._boneMask.length===0||this._boneMask.indexOf(t)>=0}addBoneMask(t,i=!0){if(this._armature===null)throw new Error("this._armature is null.");const e=this._armature.getBone(t);if(e!==null){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),i)for(const n of this._armature.getBones())this._boneMask.indexOf(n.name)<0&&e.contains(n)&&this._boneMask.push(n.name);this._timelineDirty=1}}removeBoneMask(t,i=!0){const e=this._boneMask.indexOf(t);if(e>=0&&this._boneMask.splice(e,1),this._armature===null)throw new Error("this._armature is null.");if(i){const n=this._armature.getBone(t);if(n!==null){const a=this._armature.getBones();if(this._boneMask.length>0)for(const s of a){const o=this._boneMask.indexOf(s.name);o>=0&&n.contains(s)&&this._boneMask.splice(o,1)}else for(const s of a)s!==n&&(n.contains(s)||this._boneMask.push(s.name))}}this._timelineDirty=1}removeAllBoneMask(){this._boneMask.length=0,this._timelineDirty=1}addState(t,i=null){if(i!==null){if(this._armature===null)throw new Error("this._armature is null.");for(const e of i)switch(e.type){case C.AnimationProgress:{const n=R.borrowObject(Cu);if(n.target=t,n.init(this._armature,this,e),this._animationTimelines.push(n),this.blendType!==Ft.None){const a=e;t.positionX=a.x,t.positionY=a.y,t.weight=0}t._parent=this,this.resetToPose=!1;break}case C.AnimationWeight:{const n=R.borrowObject(Fu);n.target=t,n.init(this._armature,this,e),this._animationTimelines.push(n);break}case C.AnimationParameter:{const n=R.borrowObject(Bu);n.target=t,n.init(this._armature,this,e),this._animationTimelines.push(n);break}}}t._parent===null&&(t._parent=this)}activeTimeline(){for(const t of this._slotTimelines)t.dirty=!0,t.currentTime=-1}get isFadeIn(){return this._fadeState<0}get isFadeOut(){return this._fadeState>0}get isFadeComplete(){return this._fadeState===0}get isPlaying(){if(this._actionTimeline===null)throw new Error("this._actionTimeline is null.");return(this._playheadState&2)!==0&&this._actionTimeline.playState<=0}get isCompleted(){if(this._actionTimeline===null)throw new Error("this._actionTimeline is null.");return this._actionTimeline.playState>0}get currentPlayTimes(){if(this._actionTimeline===null)throw new Error("this._actionTimeline is null.");return this._actionTimeline.currentPlayTimes}get totalTime(){return this._duration}get currentTime(){if(this._actionTimeline===null)throw new Error("this._actionTimeline is null.");return this._actionTimeline.currentTime}set currentTime(t){if(this._actionTimeline===null)throw new Error("this._actionTimeline is null.");const i=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+i*this._duration,t<0&&(t+=this._duration)),this.playTimes>0&&i===this.playTimes-1&&t===this._duration&&this._parent===null&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),this._zOrderTimeline!==null&&(this._zOrderTimeline.playState=-1);for(const e of this._boneTimelines)e.playState=-1;for(const e of this._slotTimelines)e.playState=-1}}get weight(){return this._weight}set weight(t){if(this._weight!==t){this._weight=t;for(const i of this._boneTimelines)i.dirty=!0;for(const i of this._boneBlendTimelines)i.dirty=!0;for(const i of this._slotBlendTimelines)i.dirty=!0}}get animationData(){if(this._animationData===null)throw new Error("this._animationData is null.");return this._animationData}}class bt extends R{constructor(){super(...arguments),c(this,"dirty",0),c(this,"layer",0),c(this,"leftWeight",0),c(this,"layerWeight",0),c(this,"blendWeight",0),c(this,"target",null)}static toString(){return"[class dragonBones.BlendState]"}_onClear(){this.reset(),this.target=null}update(t){const i=t.layer;let e=t._weightResult;if(this.dirty>0){if(this.leftWeight>0){if(this.layer!==i){if(this.layerWeight>=this.leftWeight)return this.dirty++,this.layer=i,this.leftWeight=0,this.blendWeight=0,!1;this.layer=i,this.leftWeight-=this.layerWeight,this.layerWeight=0}return e*=this.leftWeight,this.dirty++,this.blendWeight=e,this.layerWeight+=this.blendWeight,!0}return!1}return this.dirty++,this.layer=i,this.leftWeight=1,this.blendWeight=e,this.layerWeight=e,!0}reset(){this.dirty=0,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0}}c(bt,"BONE_TRANSFORM","boneTransform"),c(bt,"BONE_ALPHA","boneAlpha"),c(bt,"SURFACE","surface"),c(bt,"SLOT_DEFORM","slotDeform"),c(bt,"SLOT_ALPHA","slotAlpha"),c(bt,"SLOT_Z_INDEX","slotZIndex");class Nu extends R{constructor(){super(...arguments),c(this,"timeScale",1),c(this,"_animationDirty",!1),c(this,"_inheritTimeScale",1),c(this,"_animationNames",[]),c(this,"_animationStates",[]),c(this,"_animations",{}),c(this,"_blendStates",{}),c(this,"_armature",null),c(this,"_animationConfig",null),c(this,"_lastAnimationState",null)}static toString(){return"[class dragonBones.Animation]"}_onClear(){for(const t of this._animationStates)t.returnToPool();for(let t in this._animations)delete this._animations[t];for(let t in this._blendStates){const i=this._blendStates[t];for(let e in i)i[e].returnToPool();delete this._blendStates[t]}this._animationConfig!==null&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null}_fadeOut(t){switch(t.fadeOutMode){case $t.SameLayer:for(const i of this._animationStates)i._parent===null&&i.layer===t.layer&&i.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case $t.SameGroup:for(const i of this._animationStates)i._parent===null&&i.group===t.group&&i.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case $t.SameLayerAndGroup:for(const i of this._animationStates)i._parent===null&&i.layer===t.layer&&i.group===t.group&&i.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case $t.All:for(const i of this._animationStates)i._parent===null&&i.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case $t.Single:}}init(t){this._armature===null&&(this._armature=t,this._animationConfig=R.borrowObject(Du))}advanceTime(t){if(t<0&&(t=-t),this._armature===null)throw new Error("this._armature is null.");if(this._armature.inheritAnimation&&this._armature._parent!==null){if(this._armature._parent._armature===null)throw new Error(" this._armature._parent._armature is null.");this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale}else this._inheritTimeScale=this.timeScale;this._inheritTimeScale!==1&&(t*=this._inheritTimeScale);for(let e in this._blendStates){const n=this._blendStates[e];for(let a in n)n[a].reset()}const i=this._animationStates.length;if(i===1){const e=this._animationStates[0];if(e._fadeState>0&&e._subFadeState>0){if(this._armature._dragonBones===null)throw new Error("this._armature._dragonBones is null.");this._armature._dragonBones.bufferObject(e),this._animationStates.length=0,this._lastAnimationState=null}else{const n=e.animationData,a=n.cacheFrameRate;if(this._animationDirty&&a>0){this._animationDirty=!1;for(const s of this._armature.getBones())s._cachedFrameIndices=n.getBoneCachedFrameIndices(s.name);for(const s of this._armature.getSlots()){if(s.displayFrameCount>0){const o=s.getDisplayFrameAt(0).rawDisplayData;if(o!==null&&o.parent===this._armature.armatureData.defaultSkin){s._cachedFrameIndices=n.getSlotCachedFrameIndices(s.name);continue}}s._cachedFrameIndices=null}}e.advanceTime(t,a)}}else if(i>1){for(let e=0,n=0;e<i;++e){const a=this._animationStates[e];if(a._fadeState>0&&a._subFadeState>0){if(n++,this._armature._dragonBones===null)throw new Error("this._armature._dragonBones is null.");this._armature._dragonBones.bufferObject(a),this._animationDirty=!0,this._lastAnimationState===a&&(this._lastAnimationState=null)}else n>0&&(this._animationStates[e-n]=a),a.advanceTime(t,0);e===i-1&&n>0&&(this._animationStates.length-=n,this._lastAnimationState===null&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1}reset(){var t;for(const i of this._animationStates)i.returnToPool();this._animationDirty=!1,(t=this._animationConfig)==null||t.clear(),this._animationStates.length=0,this._lastAnimationState=null}stop(t=null){if(t!==null){const i=this.getState(t);i!==null&&i.stop()}else for(const i of this._animationStates)i.stop()}playConfig(t){const i=t.animation;if(!(i in this._animations))return null;const e=this._animations[i];if(t.fadeOutMode===$t.Single){for(const a of this._animationStates)if(a._fadeState<1&&a.layer===t.layer&&a.animationData===e)return a}this._animationStates.length===0?t.fadeInTime=0:t.fadeInTime<0&&(t.fadeInTime=e.fadeInTime),t.fadeOutTime<0&&(t.fadeOutTime=t.fadeInTime),t.timeScale<=-100&&(t.timeScale=1/e.scale),e.frameCount>0?(t.position<0?(t.position%=e.duration,t.position=e.duration-t.position):t.position===e.duration?t.position-=1e-6:t.position>e.duration&&(t.position%=e.duration),t.duration>0&&t.position+t.duration>e.duration&&(t.duration=e.duration-t.position),t.playTimes<0&&(t.playTimes=e.playTimes)):(t.playTimes=1,t.position=0,t.duration>0&&(t.duration=0)),t.duration===0&&(t.duration=-1),this._fadeOut(t);const n=R.borrowObject(Lu);if(this._armature===null)throw new Error("this._armature is null.");if(n.init(this._armature,e,t),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){let a=!1;for(let s=0,o=this._animationStates.length;s<o;++s)if(n.layer>this._animationStates[s].layer){a=!0,this._animationStates.splice(s,0,n);break}else if(s!==o-1&&n.layer>this._animationStates[s+1].layer){a=!0,this._animationStates.splice(s+1,0,n);break}a||this._animationStates.push(n)}else this._animationStates.push(n);for(const a of this._armature.getSlots()){const s=a.childArmature;s!==null&&s.inheritAnimation&&s.animation.hasAnimation(i)&&s.animation.getState(i)===null&&s.animation.fadeIn(i)}for(let a in e.animationTimelines){const s=this.fadeIn(a,0,1,n.layer,"",$t.Single);if(s===null)continue;const o=e.animationTimelines[a];s.actionEnabled=!1,s.resetToPose=!1,s.stop(),n.addState(s,o);const l=this._animationStates.indexOf(n),h=this._animationStates.indexOf(s);h<l&&(this._animationStates.splice(l,1),this._animationStates.splice(h,0,n))}return this._lastAnimationState=n,n}play(t=null,i=-1){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");if(this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t!==null?t:"",t!==null&&t.length>0)this.playConfig(this._animationConfig);else if(this._lastAnimationState===null){if(this._armature===null)throw new Error("this._armature is null.");const e=this._armature.armatureData.defaultAnimation;e!==null&&(this._animationConfig.animation=e.name,this.playConfig(this._animationConfig))}else!this._lastAnimationState.isPlaying&&!this._lastAnimationState.isCompleted?this._lastAnimationState.play():(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig));return this._lastAnimationState}fadeIn(t,i=-1,e=-1,n=0,a=null,s=$t.SameLayerAndGroup){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");return this._animationConfig.clear(),this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=e,this._animationConfig.layer=n,this._animationConfig.fadeInTime=i,this._animationConfig.animation=t,this._animationConfig.group=a!==null?a:"",this.playConfig(this._animationConfig)}gotoAndPlayByTime(t,i=0,e=-1){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");return this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.position=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)}gotoAndPlayByFrame(t,i=0,e=-1){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;const n=t in this._animations?this._animations[t]:null;return n!==null&&(this._animationConfig.position=n.frameCount>0?n.duration*i/n.frameCount:0),this.playConfig(this._animationConfig)}gotoAndPlayByProgress(t,i=0,e=-1){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;const n=t in this._animations?this._animations[t]:null;return n!==null&&(this._animationConfig.position=n.duration*(i>0?i:0)),this.playConfig(this._animationConfig)}gotoAndStopByTime(t,i=0){const e=this.gotoAndPlayByTime(t,i,1);return e!==null&&e.stop(),e}gotoAndStopByFrame(t,i=0){const e=this.gotoAndPlayByFrame(t,i,1);return e!==null&&e.stop(),e}gotoAndStopByProgress(t,i=0){const e=this.gotoAndPlayByProgress(t,i,1);return e!==null&&e.stop(),e}getBlendState(t,i,e){t in this._blendStates||(this._blendStates[t]={});const n=this._blendStates[t];if(!(i in n)){const a=n[i]=R.borrowObject(bt);a.target=e}return n[i]}getState(t,i=-1){let e=this._animationStates.length;for(;e--;){const n=this._animationStates[e];if(n.name===t&&(i<0||n.layer===i))return n}return null}hasAnimation(t){return t in this._animations}getStates(){return this._animationStates}get isPlaying(){for(const t of this._animationStates)if(t.isPlaying)return!0;return!1}get isCompleted(){for(const t of this._animationStates)if(!t.isCompleted)return!1;return this._animationStates.length>0}get lastAnimationName(){return this._lastAnimationState!==null?this._lastAnimationState.name:""}get animationNames(){return this._animationNames}get animations(){return this._animations}set animations(t){if(this._animations!==t){this._animationNames.length=0;for(let i in this._animations)delete this._animations[i];for(let i in t)this._animationNames.push(i),this._animations[i]=t[i]}}get animationConfig(){if(this._animationConfig===null)throw new Error("this._animationConfig is null.");return this._animationConfig.clear(),this._animationConfig}get lastAnimationState(){return this._lastAnimationState}}class le extends R{constructor(){super(...arguments),c(this,"inheritAnimation",!0),c(this,"userData",null),c(this,"_lockUpdate",!1),c(this,"_slotsDirty",!0),c(this,"_zOrderDirty",!1),c(this,"_zIndexDirty",!1),c(this,"_alphaDirty",!0),c(this,"_flipX",!1),c(this,"_flipY",!1),c(this,"_cacheFrameIndex",-1),c(this,"_alpha",1),c(this,"_globalAlpha",1),c(this,"_bones",[]),c(this,"_slots",[]),c(this,"_constraints",[]),c(this,"_actions",[]),c(this,"_armatureData",null),c(this,"_animation",null),c(this,"_proxy",null),c(this,"_display",null),c(this,"_replaceTextureAtlasData",null),c(this,"_replacedTexture",null),c(this,"_dragonBones",null),c(this,"_clock",null),c(this,"_parent",null)}static toString(){return"[class dragonBones.Armature]"}static _onSortSlots(t,i){return t._zIndex*1e3+t._zOrder>i._zIndex*1e3+i._zOrder?1:-1}_onClear(){this._clock!==null&&this._clock.remove(this);for(const t of this._bones)t.returnToPool();for(const t of this._slots)t.returnToPool();for(const t of this._constraints)t.returnToPool();for(const t of this._actions)t.returnToPool();this._animation!==null&&this._animation.returnToPool(),this._proxy!==null&&this._proxy.dbClear(),this._replaceTextureAtlasData!==null&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._zIndexDirty=!1,this._alphaDirty=!0,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._alpha=1,this._globalAlpha=1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null}_sortZOrder(t,i){if(this._armatureData===null)throw new Error("this._armatureData is undefined.");const e=this._armatureData.sortedSlots,n=t===null;if(this._zOrderDirty||!n){for(let a=0,s=e.length;a<s;++a){const o=n?a:t[i+a];if(o<0||o>=s)continue;const l=e[o],h=this.getSlot(l.name);h!==null&&h._setZOrder(a)}this._slotsDirty=!0,this._zOrderDirty=!n}}_addBone(t){this._bones.indexOf(t)<0&&this._bones.push(t)}_addSlot(t){this._slots.indexOf(t)<0&&this._slots.push(t)}_addConstraint(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)}_bufferAction(t,i){this._actions.indexOf(t)<0&&(i?this._actions.push(t):this._actions.unshift(t))}dispose(){if(this._dragonBones===null)throw new Error(" this._dragonBones is null.");this._armatureData!==null&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))}init(t,i,e,n){this._armatureData===null&&(this._armatureData=t,this._animation=R.borrowObject(Nu),this._proxy=i,this._display=e,this._dragonBones=n,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)}advanceTime(t){if(this._lockUpdate)return;if(this._lockUpdate=!0,this._armatureData===null){console.warn("The armature has been disposed.");return}else if(this._armatureData.parent===null){console.warn(`The armature data has been disposed.
Please make sure dispose armature before call factory.clear().`);return}const i=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty||this._zIndexDirty){if(this._slots.sort(le._onSortSlots),this._zIndexDirty)for(let e=0,n=this._slots.length;e<n;++e)this._slots[e]._setZOrder(e);this._slotsDirty=!1,this._zIndexDirty=!1}if(this._alpha===void 0)throw new Error(" this._alpha is undefined.");if(this._alphaDirty){this._alphaDirty=!1,this._globalAlpha=this._alpha*(this._parent!==null?this._parent._globalAlpha:1);for(const e of this._bones)e._updateAlpha();for(const e of this._slots)e._updateAlpha()}if(this._cacheFrameIndex===void 0)throw new Error(" this._cacheFrameIndex is undefined.");if(this._cacheFrameIndex<0||this._cacheFrameIndex!==i){let e=0,n=0;for(e=0,n=this._bones.length;e<n;++e)this._bones[e].update(this._cacheFrameIndex);for(e=0,n=this._slots.length;e<n;++e)this._slots[e].update(this._cacheFrameIndex)}if(this._actions.length>0){for(const e of this._actions){const n=e.actionData;if(n!==null&&n.type===lt.Play)if(e.slot!==null){const a=e.slot.childArmature;a!==null&&a.animation.fadeIn(n.name)}else if(e.bone!==null){for(const a of this.getSlots())if(a.parent===e.bone){const s=a.childArmature;s!==null&&s.animation.fadeIn(n.name)}}else this._animation.fadeIn(n.name);e.returnToPool()}this._actions.length=0}if(this._lockUpdate=!1,this._proxy===null)throw new Error("this._proxy is null.");this._proxy.dbUpdate()}invalidUpdate(t=null,i=!1){if(t!==null&&t.length>0){const e=this.getBone(t);if(e!==null&&(e.invalidUpdate(),i))for(const n of this._slots)n.parent===e&&n.invalidUpdate()}else{for(const e of this._bones)e.invalidUpdate();if(i)for(const e of this._slots)e.invalidUpdate()}}containsPoint(t,i){for(const e of this._slots)if(e.containsPoint(t,i))return e;return null}intersectsSegment(t,i,e,n,a=null,s=null,o=null){const l=t===e;let h=0,u=0,f=0,d=0,p=0,_=0,m=0,g=0,y=null,w=null;for(const T of this._slots)if(T.intersectsSegment(t,i,e,n,a,s,o)>0)if(a!==null||s!==null){if(a!==null){let x=l?a.y-i:a.x-t;x<0&&(x=-x),(y===null||x<h)&&(h=x,f=a.x,d=a.y,y=T,o&&(m=o.x))}if(s!==null){let x=s.x-t;x<0&&(x=-x),(w===null||x>u)&&(u=x,p=s.x,_=s.y,w=T,o!==null&&(g=o.y))}}else{y=T;break}return y!==null&&a!==null&&(a.x=f,a.y=d,o!==null&&(o.x=m)),w!==null&&s!==null&&(s.x=p,s.y=_,o!==null&&(o.y=g)),y}getBone(t){for(const i of this._bones)if(i.name===t)return i;return null}getBoneByDisplay(t){const i=this.getSlotByDisplay(t);return i!==null?i.parent:null}getSlot(t){for(const i of this._slots)if(i.name===t)return i;return null}getSlotByDisplay(t){if(t!==null){for(const i of this._slots)if(i.display===t)return i}return null}getBones(){return this._bones}getSlots(){return this._slots}get flipX(){if(this._flipX===void 0)throw new Error("this._flipX is undefined.");return this._flipX}set flipX(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())}get flipY(){if(this._flipY===void 0)throw new Error("this._flipY is undefined.");return this._flipY}set flipY(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())}get cacheFrameRate(){if(this._armatureData===null)throw new Error("this._armatureData is undefined.");if(this._armatureData.cacheFrameRate===void 0)throw new Error("this._armatureData.cacheFrameRate is undefined.");return this._armatureData.cacheFrameRate}set cacheFrameRate(t){if(this._armatureData===null)throw new Error("this._armatureData is undefined.");if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(const i of this._slots){const e=i.childArmature;e!==null&&(e.cacheFrameRate=t)}}}get name(){if(this._armatureData===null)throw new Error("this._armatureData is undefined.");if(this._armatureData.name===void 0)throw new Error("this._armatureData.name is undefined.");return this._armatureData.name}get armatureData(){if(this._armatureData===null)throw new Error("this._armatureData is undefined.");return this._armatureData}get animation(){if(this._animation===null)throw new Error("this._animation is undefined.");return this._animation}get proxy(){if(this._proxy===null)throw new Error("this._proxy is undefined.");return this._proxy}get eventDispatcher(){if(this._proxy===null)throw new Error("this._proxy is undefined.");return this._proxy}get display(){return this._display}get replacedTexture(){return this._replacedTexture}set replacedTexture(t){if(this._replacedTexture!==t){this._replaceTextureAtlasData!==null&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(const i of this._slots)i.invalidUpdate(),i.update(-1)}}get clock(){return this._clock}set clock(t){if(this._clock!==t){this._clock!==null&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(const i of this._slots){const e=i.childArmature;e!==null&&(e.clock=this._clock)}}}get parent(){return this._parent}getDisplay(){return this._display}}class Ne{constructor(t=1,i=0,e=0,n=1,a=0,s=0){c(this,"a"),c(this,"b"),c(this,"c"),c(this,"d"),c(this,"tx"),c(this,"ty"),this.a=t,this.b=i,this.c=e,this.d=n,this.tx=a,this.ty=s}toString(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}copyFromArray(t,i=0){return this.a=t[i],this.b=t[i+1],this.c=t[i+2],this.d=t[i+3],this.tx=t[i+4],this.ty=t[i+5],this}identity(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this}concat(t){let i=this.a*t.a,e=0,n=0,a=this.d*t.d,s=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;return(this.b!==0||this.c!==0)&&(i+=this.b*t.c,e+=this.b*t.d,n+=this.c*t.a,a+=this.c*t.b),(t.b!==0||t.c!==0)&&(e+=this.a*t.b,n+=this.d*t.c,s+=this.ty*t.c,o+=this.tx*t.b),this.a=i,this.b=e,this.c=n,this.d=a,this.tx=s,this.ty=o,this}invert(){let t=this.a,i=this.b,e=this.c,n=this.d;const a=this.tx,s=this.ty;if(i===0&&e===0)return this.b=this.c=0,t===0||n===0?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,n=this.d=1/n,this.tx=-t*a,this.ty=-n*s),this;let o=t*n-i*e;if(o===0)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;o=1/o;let l=this.a=n*o;return i=this.b=-i*o,e=this.c=-e*o,n=this.d=t*o,this.tx=-(l*a+e*s),this.ty=-(i*a+n*s),this}transformPoint(t,i,e,n=!1){e.x=this.a*t+this.c*i,e.y=this.b*t+this.d*i,n||(e.x+=this.tx,e.y+=this.ty)}transformRectangle(t,i=!1){const e=this.a,n=this.b,a=this.c,s=this.d,o=i?0:this.tx,l=i?0:this.ty,h=t.x,u=t.y,f=h+t.width,d=u+t.height;let p=e*h+a*u+o,_=n*h+s*u+l,m=e*f+a*u+o,g=n*f+s*u+l,y=e*f+a*d+o,w=n*f+s*d+l,T=e*h+a*d+o,x=n*h+s*d+l,E=0;p>m&&(E=p,p=m,m=E),y>T&&(E=y,y=T,T=E),t.x=Math.floor(p<y?p:y),t.width=Math.ceil((m>T?m:T)-t.x),_>g&&(E=_,_=g,g=E),w>x&&(E=w,w=x,x=E),t.y=Math.floor(_<w?_:w),t.height=Math.ceil((g>x?g:x)-t.y)}}class wi{constructor(t=0,i=0){c(this,"x"),c(this,"y"),this.x=t,this.y=i}copyFrom(t){this.x=t.x,this.y=t.y}clear(){this.x=this.y=0}}class fr extends R{constructor(){super(...arguments),c(this,"globalTransformMatrix",new Ne),c(this,"global",new Y),c(this,"offset",new Y),c(this,"origin",null),c(this,"userData"),c(this,"_globalDirty",!1),c(this,"_alpha",1),c(this,"_globalAlpha",1),c(this,"_armature",null)}_onClear(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._alpha=1,this._globalAlpha=1,this._armature=null}updateGlobalTransform(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))}get armature(){if(this._armature===null)throw new Error("this._armature is null.");return this._armature}}c(fr,"_helpMatrix",new Ne),c(fr,"_helpTransform",new Y),c(fr,"_helpPoint",new wi);class Ll extends fr{constructor(){super(...arguments),c(this,"offsetMode",ar.Additive),c(this,"animationPose",new Y),c(this,"_transformDirty",!1),c(this,"_childrenTransformDirty",!1),c(this,"_localDirty",!0),c(this,"_hasConstraint",!1),c(this,"_visible",!0),c(this,"_cachedFrameIndex",-1),c(this,"_boneData",null),c(this,"_parent",null),c(this,"_cachedFrameIndices",null)}static toString(){return"[class dragonBones.Bone]"}_onClear(){super._onClear(),this.offsetMode=ar.Additive,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._boneData=null,this._parent=null,this._cachedFrameIndices=null}_updateGlobalTransformMatrix(t){if(this._armature===null)throw new Error(" this._armature is null.");if(this.origin===void 0)throw new Error(" this.origin is undefined.");const i=this._boneData,e=this.global,n=this.globalTransformMatrix,a=this.origin,s=this.offset,o=this.animationPose,l=this._parent,h=this._armature.flipX,u=this._armature.flipY===Ct.yDown;let f=l!==null,d=0;if(this.offsetMode===ar.Additive?a!==null?(e.x=a.x+s.x+o.x,e.scaleX=a.scaleX*s.scaleX*o.scaleX,e.scaleY=a.scaleY*s.scaleY*o.scaleY,Ct.yDown?(e.y=a.y+s.y+o.y,e.skew=a.skew+s.skew+o.skew,e.rotation=a.rotation+s.rotation+o.rotation):(e.y=a.y-s.y+o.y,e.skew=a.skew-s.skew+o.skew,e.rotation=a.rotation-s.rotation+o.rotation)):(e.copyFrom(s),Ct.yDown||(e.y=-e.y,e.skew=-e.skew,e.rotation=-e.rotation),e.add(o)):this.offsetMode===ar.None?a!==null?e.copyFrom(a).add(o):e.copyFrom(o):(f=!1,e.copyFrom(s),Ct.yDown||(e.y=-e.y,e.skew=-e.skew,e.rotation=-e.rotation)),f){if(l._boneData===null)throw new Error("parent._boneData is undefined.");if(i===null)throw new Error("boneData is undefined.");const p=l._boneData.type===mt.Surface,_=p?l._bone:null,m=p?l._getGlobalTransformMatrix(e.x,e.y):l.globalTransformMatrix;if(i.inheritScale&&(!p||_!==null))p?(i.inheritRotation&&(e.rotation+=l.global.rotation),_.updateGlobalTransform(),e.scaleX*=_.global.scaleX,e.scaleY*=_.global.scaleY,m.transformPoint(e.x,e.y,e),e.toMatrix(n),i.inheritTranslation?(e.x=n.tx,e.y=n.ty):(n.tx=e.x,n.ty=e.y)):(i.inheritRotation||(l.updateGlobalTransform(),h&&u?d=e.rotation-(l.global.rotation+Math.PI):h?d=e.rotation+l.global.rotation+Math.PI:u?d=e.rotation+l.global.rotation:d=e.rotation-l.global.rotation,e.rotation=d),e.toMatrix(n),n.concat(m),i.inheritTranslation?(e.x=n.tx,e.y=n.ty):(n.tx=e.x,n.ty=e.y),t?e.fromMatrix(n):this._globalDirty=!0);else{if(i.inheritTranslation){const g=e.x,y=e.y;e.x=m.a*g+m.c*y+m.tx,e.y=m.b*g+m.d*y+m.ty}else h&&(e.x=-e.x),u&&(e.y=-e.y);i.inheritRotation?(l.updateGlobalTransform(),l.global.scaleX<0?d=e.rotation+l.global.rotation+Math.PI:d=e.rotation+l.global.rotation,m.a*m.d-m.b*m.c<0&&(d-=e.rotation*2,(h!==u||i.inheritReflection)&&(e.skew+=Math.PI),Ct.yDown||(e.skew=-e.skew)),e.rotation=d):(h||u)&&(h&&u?d=e.rotation+Math.PI:(h?d=Math.PI-e.rotation:d=-e.rotation,e.skew+=Math.PI),e.rotation=d),e.toMatrix(n)}}else(h||u)&&(h&&(e.x=-e.x),u&&(e.y=-e.y),h&&u?d=e.rotation+Math.PI:(h?d=Math.PI-e.rotation:d=-e.rotation,e.skew+=Math.PI),e.rotation=d),e.toMatrix(n)}_updateAlpha(){if(this._alpha===void 0)throw new Error("this._alpha is undefined.");if(this._parent!==null){if(this._parent._globalAlpha===void 0)throw new Error("this._parent._globalAlpha is undefined.");this._globalAlpha=this._alpha*this._parent._globalAlpha}else{if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._globalAlpha===void 0)throw new Error("this._armature._globalAlpha is undefined.");this._globalAlpha=this._alpha*this._armature._globalAlpha}}init(t,i){this._boneData===null&&(this._boneData=t,this._armature=i,this._alpha=this._boneData.alpha,this._boneData.parent!==null&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)}update(t){if(this._armature===null)throw new Error("this._armature is null.");if(this._cachedFrameIndex===void 0)throw new Error("this._cachedFrameIndex is undefined.");if(t>=0&&this._cachedFrameIndices!==null){const i=this._cachedFrameIndices[t];if(i>=0&&this._cachedFrameIndex===i)this._transformDirty=!1;else if(i>=0)this._transformDirty=!0,this._cachedFrameIndex=i;else{if(this._hasConstraint)for(const e of this._armature._constraints)e._root===this&&e.update();this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(const i of this._armature._constraints)i._root===this&&i.update();(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");if(this._cachedFrameIndex<0){const i=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(i),i&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0}updateByConstraint(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)}invalidUpdate(){this._transformDirty=!0}contains(t){if(t===this)return!1;let i=t;for(;i!==this&&i!==null;)i=i.parent;return i===this}get boneData(){if(this._boneData===null)throw new Error("this._boneData is undefined.");return this._boneData}get visible(){if(this._visible===void 0)throw new Error("this._visible is undefined.");return this._visible}set visible(t){if(this._armature===null)throw new Error(" this._armature is null.");if(this._visible!==t){this._visible=t;for(const i of this._armature.getSlots())i.parent===this&&i._updateVisible()}}get name(){if(this._boneData===null)throw new Error(" this._boneData is undefined.");return this._boneData.name}get parent(){return this._parent}}class cr extends R{constructor(){super(...arguments),c(this,"_constraintData",null),c(this,"_armature",null),c(this,"_target",null),c(this,"_root",null),c(this,"_bone",null)}_onClear(){this._armature=null,this._target=null,this._root=null,this._bone=null}get name(){var t;if(((t=this._constraintData)==null?void 0:t.name)===void 0)throw new Error("this._constraintData is undefined.");return this._constraintData.name}}c(cr,"_helpMatrix",new Ne),c(cr,"_helpTransform",new Y),c(cr,"_helpPoint",new wi);class uo extends cr{constructor(){super(...arguments),c(this,"_bendPositive",!1),c(this,"_weight",1)}static toString(){return"[class dragonBones.IKConstraint]"}_onClear(){super._onClear(),this._bendPositive=!1,this._weight=1,this._constraintData=null}_computeA(){if(this._target===null)throw new Error("this._target is null.");if(this._root===null)throw new Error("this._root is null.");const t=this._target.global,i=this._root.global,e=this._root.globalTransformMatrix;let n=Math.atan2(t.y-i.y,t.x-i.x);i.scaleX<0&&(n+=Math.PI),i.rotation+=Y.normalizeRadian(n-i.rotation)*this._weight,i.toMatrix(e)}_computeB(){if(this._bone===null)throw new Error("this._bone is null.");if(this._bone._boneData===null)throw new Error("this._bone._boneData is null.");if(this._target===null)throw new Error("this._target is null.");const t=this._bone._boneData.length,i=this._root,e=this._target.global,n=i.global,a=this._bone.global,s=this._bone.globalTransformMatrix,o=s.a*t,l=s.b*t,h=o*o+l*l,u=Math.sqrt(h);let f=a.x-n.x,d=a.y-n.y;const p=f*f+d*d,_=Math.sqrt(p),m=a.rotation,g=n.rotation,y=Math.atan2(d,f);f=e.x-n.x,d=e.y-n.y;const w=f*f+d*d,T=Math.sqrt(w);let x=0;if(u+_<=T||T+u<=_||T+_<=u)x=Math.atan2(e.y-n.y,e.x-n.x),u+_<=T||_<u&&(x+=Math.PI);else{const S=(p-h+w)/(2*w),M=Math.sqrt(p-S*S*w)/T,O=n.x+f*S,F=n.y+d*S,L=-d*M,B=f*M;let I=!1;const U=i.parent;if(U!==null){const G=U.globalTransformMatrix;I=G.a*G.d-G.b*G.c<0}I!==this._bendPositive?(a.x=O-L,a.y=F-B):(a.x=O+L,a.y=F+B),x=Math.atan2(a.y-n.y,a.x-n.x)}const E=Y.normalizeRadian(x-y);n.rotation=g+E*this._weight,n.toMatrix(i.globalTransformMatrix);const b=y+E*this._weight;a.x=n.x+Math.cos(b)*_,a.y=n.y+Math.sin(b)*_;let D=Math.atan2(e.y-a.y,e.x-a.x);a.scaleX<0&&(D+=Math.PI),a.rotation=n.rotation+m-g+Y.normalizeRadian(D-E-m)*this._weight,a.toMatrix(s)}init(t,i){if(this._constraintData===null){if(t.target===null)throw new Error("constraintData.target is null.");if(t.root===null)throw new Error("constraintData.root is null.");this._constraintData=t,this._armature=i,this._target=this._armature.getBone(t.target.name),this._root=this._armature.getBone(t.root.name),this._bone=this._constraintData.bone!==null?this._armature.getBone(this._constraintData.bone.name):null;{const e=this._constraintData;this._bendPositive=e.bendPositive,this._weight=e.weight}if(this._root===null)throw new Error("this._root is null.");this._root._hasConstraint=!0}}update(){if(this._root===null)throw new Error("this._root is null.");this._root.updateByConstraint(),this._bone!==null?(this._bone.updateByConstraint(),this._computeB()):this._computeA()}invalidUpdate(){if(this._root===null)throw new Error("this._root is null.");this._root.invalidUpdate(),this._bone!==null&&this._bone.invalidUpdate()}}class ku extends cr{constructor(){super(...arguments),c(this,"dirty",!1),c(this,"pathOffset",0),c(this,"position",0),c(this,"spacing",0),c(this,"rotateOffset",0),c(this,"rotateMix",1),c(this,"translateMix",1),c(this,"_pathSlot",null),c(this,"_bones",[]),c(this,"_spaces",[]),c(this,"_positions",[]),c(this,"_curves",[]),c(this,"_boneLengths",[]),c(this,"_pathGlobalVertices",[]),c(this,"_segments",[10])}static toString(){return"[class dragonBones.PathConstraint]"}_onClear(){super._onClear(),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0}_updatePathVertices(t){if(this._armature===null)throw new Error("this._armature is null.");const i=this._armature,e=i.armatureData.parent,n=i.armatureData.scale;if(e===null)throw new Error("dragonBonesData is null.");const a=e.intArray,s=e.floatArray;if(a===null)throw new Error("intArray is null.");if(s===null)throw new Error("floatArray is null.");if(this._pathSlot===null)throw new Error("this._pathSlot is null.");const o=t.offset,l=a[o+P.GeometryVertexCount],h=a[o+P.GeometryFloatOffset];this._pathGlobalVertices.length=l*2;const u=t.weight;if(u===null){const g=this._pathSlot.parent;g.updateByConstraint();const y=g.globalTransformMatrix;for(let w=0,T=h;w<l;w+=2){const x=s[T++]*n,E=s[T++]*n,b=y.a*x+y.c*E+y.tx,D=y.b*x+y.d*E+y.ty;this._pathGlobalVertices[w]=b,this._pathGlobalVertices[w+1]=D}return}const f=this._pathSlot._geometryBones,d=u.bones.length,p=u.offset;let _=a[p+P.WeigthFloatOffset],m=p+P.WeigthBoneIndices+d;for(let g=0,y=0;g<l;g++){const w=a[m++];let T=0,x=0;for(let E=0,b=w;E<b;E++){const D=a[m++],S=f[D];if(S===null)continue;S.updateByConstraint();const M=S.globalTransformMatrix,O=s[_++],F=s[_++]*n,L=s[_++]*n;T+=(M.a*F+M.c*L+M.tx)*O,x+=(M.b*F+M.d*L+M.ty)*O}this._pathGlobalVertices[y++]=T,this._pathGlobalVertices[y++]=x}}_computeVertices(t,i,e,n){for(let a=e,s=t;a<i;a+=2)n[a]=this._pathGlobalVertices[s++],n[a+1]=this._pathGlobalVertices[s++]}_computeBezierCurve(t,i,e,n,a){if(this._armature===null)throw new Error("this._armature is null.");const s=this._armature;if(s.armatureData.parent===null)throw new Error("armature.armatureData.parent is null.");const o=s.armatureData.parent.intArray;if(o===null)throw new Error("intArray is null.");const l=o[t.geometry.offset+P.GeometryVertexCount],h=this._positions,u=this._spaces,f=t.closed,d=Array();let p=l*2,_=p/6,m=-1,g=this.position;h.length=i*3+2;let y=0;if(!t.constantSpeed){const H=t.curveLengths;if(_-=f?1:2,y=H[_],n&&(g*=y),a)for(let et=0;et<i;et++)u[et]*=y;d.length=8;for(let et=0,it=0,j=0;et<i;et++,it+=3){const wt=u[et];if(g+=wt,f)g%=y,g<0&&(g+=y),j=0;else if(g<0||g>y)continue;let ot=0;for(;;j++){const nt=H[j];if(!(g>nt)){if(j===0)ot=g/nt;else{const Rt=H[j-1];ot=(g-Rt)/(nt-Rt)}break}}j!==m&&(m=j,f&&j===_?(this._computeVertices(p-4,4,0,d),this._computeVertices(0,4,4,d)):this._computeVertices(j*6+2,8,0,d)),this.addCurvePosition(ot,d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],h,it,e)}return}f?(p+=2,d.length=l,this._computeVertices(2,p-4,0,d),this._computeVertices(0,2,p-4,d),d[p-2]=d[0],d[p-1]=d[1]):(_--,p-=4,d.length=p,this._computeVertices(2,p,0,d));let w=new Array(_);y=0;let T=d[0],x=d[1],E=0,b=0,D=0,S=0,M=0,O=0,F,L,B,I,U,G,$,k;for(let H=0,et=2;H<_;H++,et+=6)E=d[et],b=d[et+1],D=d[et+2],S=d[et+3],M=d[et+4],O=d[et+5],F=(T-E*2+D)*.1875,L=(x-b*2+S)*.1875,B=((E-D)*3-T+M)*.09375,I=((b-S)*3-x+O)*.09375,U=F*2+B,G=L*2+I,$=(E-T)*.75+F+B*.16666667,k=(b-x)*.75+L+I*.16666667,y+=Math.sqrt($*$+k*k),$+=U,k+=G,U+=B,G+=I,y+=Math.sqrt($*$+k*k),$+=U,k+=G,y+=Math.sqrt($*$+k*k),$+=U+B,k+=G+I,y+=Math.sqrt($*$+k*k),w[H]=y,T=M,x=O;if(n&&(g*=y),a)for(let H=0;H<i;H++)u[H]*=y;let q=this._segments,z=0;for(let H=0,et=0,it=0,j=0;H<i;H++,et+=3){const wt=u[H];g+=wt;let ot=g;if(f)ot%=y,ot<0&&(ot+=y),it=0;else if(ot<0||ot>y)continue;for(;;it++){const nt=w[it];if(!(ot>nt)){if(it===0)ot/=nt;else{const Rt=w[it-1];ot=(ot-Rt)/(nt-Rt)}break}}if(it!==m){m=it;let nt=it*6;for(T=d[nt],x=d[nt+1],E=d[nt+2],b=d[nt+3],D=d[nt+4],S=d[nt+5],M=d[nt+6],O=d[nt+7],F=(T-E*2+D)*.03,L=(x-b*2+S)*.03,B=((E-D)*3-T+M)*.006,I=((b-S)*3-x+O)*.006,U=F*2+B,G=L*2+I,$=(E-T)*.3+F+B*.16666667,k=(b-x)*.3+L+I*.16666667,z=Math.sqrt($*$+k*k),q[0]=z,nt=1;nt<8;nt++)$+=U,k+=G,U+=B,G+=I,z+=Math.sqrt($*$+k*k),q[nt]=z;$+=U,k+=G,z+=Math.sqrt($*$+k*k),q[8]=z,$+=U+B,k+=G+I,z+=Math.sqrt($*$+k*k),q[9]=z,j=0}for(ot*=z;;j++){const nt=q[j];if(!(ot>nt)){if(j===0)ot/=nt;else{const Rt=q[j-1];ot=j+(ot-Rt)/(nt-Rt)}break}}this.addCurvePosition(ot*.1,T,x,E,b,D,S,M,O,h,et,e)}}addCurvePosition(t,i,e,n,a,s,o,l,h,u,f,d){if(t===0){u[f]=i,u[f+1]=e,u[f+2]=0;return}if(t===1){u[f]=l,u[f+1]=h,u[f+2]=0;return}const p=1-t,_=p*p,m=t*t,g=_*p,y=_*t*3,w=p*m*3,T=t*m,x=g*i+y*n+w*s+T*l,E=g*e+y*a+w*o+T*h;u[f]=x,u[f+1]=E,d?u[f+2]=Math.atan2(E-(g*e+y*a+w*o),x-(g*i+y*n+w*s)):u[f+2]=0}init(t,i){this._constraintData=t,this._armature=i;let e=t;if(e.pathDisplayData===null)throw new Error("data.pathDisplayData is null.");if(e.root===null)throw new Error("data.root is null.");if(e.target===null)throw new Error("data.target is null.");if(e.pathSlot===null)throw new Error("data.pathSlot is null.");this.pathOffset=e.pathDisplayData.geometry.offset,this.position=e.position,this.spacing=e.spacing,this.rotateOffset=e.rotateOffset,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this._root=this._armature.getBone(e.root.name),this._target=this._armature.getBone(e.target.name),this._pathSlot=this._armature.getSlot(e.pathSlot.name);for(let n=0,a=e.bones.length;n<a;n++){const s=this._armature.getBone(e.bones[n].name);s!==null&&this._bones.push(s)}e.rotateMode===Xt.ChainScale&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0}update(){const t=this._pathSlot;if(t===null)throw new Error("pathSlot is null.");if(t._geometryData===null||t._geometryData.offset!==this.pathOffset)return;const i=this._constraintData;if(this._root===null)throw new Error("this._root is null.");let e=!1;if(this._root._childrenTransformDirty?(this._updatePathVertices(t._geometryData),e=!0):(t._verticesDirty||t._isBonesUpdate())&&(this._updatePathVertices(t._geometryData),t._verticesDirty=!1,e=!0),!e&&!this.dirty)return;const n=i.positionMode,a=i.spacingMode,s=i.rotateMode,o=this._bones,l=a===Zt.Length,h=s===Xt.ChainScale,u=s===Xt.Tangent,f=o.length,d=u?f:f+1,p=this.spacing;let _=this._spaces;if(_.length=d,h||l){_[0]=0;for(let b=0,D=d-1;b<D;b++){const S=o[b];if(S.updateByConstraint(),S._boneData===null)throw new Error("bone._boneData is null.");const M=S._boneData.length,O=S.globalTransformMatrix,F=M*O.a,L=M*O.b,B=Math.sqrt(F*F+L*L);h&&(this._boneLengths[b]=B),_[b+1]=(M+p)*B/M}}else for(let b=0;b<d;b++)_[b]=p;this._computeBezierCurve(t._displayFrame.rawDisplayData,d,u,n===Ee.Percent,a===Zt.Percent);const m=this._positions;let g=this.rotateOffset,y=m[0],w=m[1],T;if(g===0)T=s===Xt.Chain;else{T=!1;const b=t.parent;if(b!==null){const D=b.globalTransformMatrix;g*=D.a*D.d-D.b*D.c>0?Y.DEG_RAD:-Y.DEG_RAD}}const x=this.rotateMix,E=this.translateMix;for(let b=0,D=3;b<f;b++,D+=3){let S=o[b];if(S._boneData===null)throw new Error("bone._boneData is null.");S.updateByConstraint();let M=S.globalTransformMatrix;M.tx+=(y-M.tx)*E,M.ty+=(w-M.ty)*E;const O=m[D],F=m[D+1],L=O-y,B=F-w;if(h){const I=this._boneLengths[b],U=(Math.sqrt(L*L+B*B)/I-1)*x+1;M.a*=U,M.b*=U}if(y=O,w=F,x>0){let I=M.a,U=M.b,G=M.c,$=M.d,k,q,z;if(u?k=m[D-1]:k=Math.atan2(B,L),k-=Math.atan2(U,I),T){q=Math.cos(k),z=Math.sin(k);const H=S._boneData.length;y+=(H*(q*I-z*U)-L)*x,w+=(H*(z*I+q*U)-B)*x}else k+=g;k>Y.PI?k-=Y.PI_D:k<-Y.PI&&(k+=Y.PI_D),k*=x,q=Math.cos(k),z=Math.sin(k),M.a=q*I-z*U,M.b=z*I+q*U,M.c=q*G-z*$,M.d=z*G+q*$}S.global.fromMatrix(M)}this.dirty=!1}invalidUpdate(){}}class bi{constructor(t=1,i=1,e=1,n=1,a=0,s=0,o=0,l=0){c(this,"alphaMultiplier"),c(this,"redMultiplier"),c(this,"greenMultiplier"),c(this,"blueMultiplier"),c(this,"alphaOffset"),c(this,"redOffset"),c(this,"greenOffset"),c(this,"blueOffset"),this.alphaMultiplier=t,this.redMultiplier=i,this.greenMultiplier=e,this.blueMultiplier=n,this.alphaOffset=a,this.redOffset=s,this.greenOffset=o,this.blueOffset=l}copyFrom(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset}identity(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0}}class Uu extends R{constructor(){super(...arguments),c(this,"rawDisplayData",null),c(this,"displayData",null),c(this,"textureData",null),c(this,"display",null),c(this,"deformVertices",[])}static toString(){return"[class dragonBones.DisplayFrame]"}_onClear(){this.rawDisplayData=null,this.displayData=null,this.textureData=null,this.display=null,this.deformVertices.length=0}updateDeformVertices(){if(this.rawDisplayData===null||this.deformVertices.length!==0)return;let t;if(this.rawDisplayData.type===Q.Mesh)t=this.rawDisplayData.geometry;else if(this.rawDisplayData.type===Q.Path)t=this.rawDisplayData.geometry;else return;let i=0;if(t.weight!==null)i=t.weight.count*2;else{if(t.data===null)throw new Error("rawGeometryData.data is null.");if(t.data.intArray===null)throw new Error("rawGeometryData.data.intArray is null.");i=t.data.intArray[t.offset+P.GeometryVertexCount]*2}this.deformVertices.length=i;for(let e=0,n=this.deformVertices.length;e<n;++e)this.deformVertices[e]=0}getGeometryData(){if(this.displayData!==null){if(this.displayData.type===Q.Mesh)return this.displayData.geometry;if(this.displayData.type===Q.Path)return this.displayData.geometry}if(this.rawDisplayData!==null){if(this.rawDisplayData.type===Q.Mesh)return this.rawDisplayData.geometry;if(this.rawDisplayData.type===Q.Path)return this.rawDisplayData.geometry}return null}getBoundingBox(){return this.displayData!==null&&this.displayData.type===Q.BoundingBox?this.displayData.boundingBox:this.rawDisplayData!==null&&this.rawDisplayData.type===Q.BoundingBox?this.rawDisplayData.boundingBox:null}getTextureData(){if(this.displayData!==null){if(this.displayData.type===Q.Image)return this.displayData.texture;if(this.displayData.type===Q.Mesh)return this.displayData.texture}if(this.textureData!==null)return this.textureData;if(this.rawDisplayData!==null){if(this.rawDisplayData.type===Q.Image)return this.rawDisplayData.texture;if(this.rawDisplayData.type===Q.Mesh)return this.rawDisplayData.texture}return null}}class tt extends fr{constructor(){super(...arguments),c(this,"displayController",null),c(this,"_displayDataDirty",!1),c(this,"_displayDirty",!1),c(this,"_geometryDirty",!1),c(this,"_textureDirty",!1),c(this,"_visibleDirty",!1),c(this,"_blendModeDirty",!1),c(this,"_zOrderDirty",!1),c(this,"_colorDirty",!1),c(this,"_verticesDirty",!1),c(this,"_transformDirty",!1),c(this,"_visible",!0),c(this,"_blendMode",st.Normal),c(this,"_displayIndex",-1),c(this,"_animationDisplayIndex",-1),c(this,"_cachedFrameIndex",-1),c(this,"_zOrder",0),c(this,"_zIndex",0),c(this,"_pivotX",0),c(this,"_pivotY",0),c(this,"_localMatrix",new Ne),c(this,"_colorTransform",new bi),c(this,"_displayFrames",[]),c(this,"_geometryBones",[]),c(this,"_slotData",null),c(this,"_displayFrame",null),c(this,"_geometryData",null),c(this,"_boundingBoxData",null),c(this,"_textureData",null),c(this,"_rawDisplay",null),c(this,"_meshDisplay",null),c(this,"_display",null),c(this,"_childArmature",null),c(this,"_parent",null),c(this,"_cachedFrameIndices",null)}_onClear(){super._onClear();const t=[];for(const i of this._displayFrames){const e=i.display;e!==this._rawDisplay&&e!==this._meshDisplay&&t.indexOf(e)<0&&t.push(e),i.returnToPool()}for(const i of t)i instanceof le?i.dispose():this._disposeDisplay(i,!0);this._meshDisplay!==null&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),this._rawDisplay!==null&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDataDirty=!1,this._displayDirty=!1,this._geometryDirty=!1,this._textureDirty=!1,this._visibleDirty=!1,this._blendModeDirty=!1,this._zOrderDirty=!1,this._colorDirty=!1,this._verticesDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=st.Normal,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._zIndex=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayFrames.length=0,this._geometryBones.length=0,this._slotData=null,this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null}_hasDisplay(t){for(const i of this._displayFrames)if(i.display===t)return!0;return!1}_isBonesUpdate(){for(const t of this._geometryBones)if(t!==null&&t._childrenTransformDirty)return!0;return!1}_updateAlpha(){if(this._parent===null)throw new Error("this._parent is null.");const t=this._alpha*this._parent._globalAlpha;this._globalAlpha!==t&&(this._globalAlpha=t,this._colorDirty=!0)}_updateDisplayData(){const t=this._displayFrame,i=this._geometryData,e=this._textureData;let n=null,a=null;if(this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&this._displayIndex<this._displayFrames.length&&(this._displayFrame=this._displayFrames[this._displayIndex],n=this._displayFrame.rawDisplayData,a=this._displayFrame.displayData,this._geometryData=this._displayFrame.getGeometryData(),this._boundingBoxData=this._displayFrame.getBoundingBox(),this._textureData=this._displayFrame.getTextureData()),this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");if(this._displayFrame!==t||this._geometryData!==i||this._textureData!==e){if(this._geometryData===null&&this._textureData!==null){if(this._textureData.parent===null)throw new Error("this._textureData.parent is null.");const s=a!==null&&a.type===Q.Image?a:n,o=this._textureData.parent.scale*this._armature._armatureData.scale,l=this._textureData.frame;this._pivotX=s.pivot.x,this._pivotY=s.pivot.y;const h=l!==null?l:this._textureData.region;let u=h.width,f=h.height;this._textureData.rotated&&l===null&&(u=h.height,f=h.width),this._pivotX*=u*o,this._pivotY*=f*o,l!==null&&(this._pivotX+=l.x*o,this._pivotY+=l.y*o),n!==null&&s!==n&&(n.transform.toMatrix(tt._helpMatrix),tt._helpMatrix.invert(),tt._helpMatrix.transformPoint(0,0,tt._helpPoint),this._pivotX-=tt._helpPoint.x,this._pivotY-=tt._helpPoint.y,s.transform.toMatrix(tt._helpMatrix),tt._helpMatrix.invert(),tt._helpMatrix.transformPoint(0,0,tt._helpPoint),this._pivotX+=tt._helpPoint.x,this._pivotY+=tt._helpPoint.y),Ct.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*o-this._pivotY)}else this._pivotX=0,this._pivotY=0;if(n!==null?this.origin=n.transform:a!==null?this.origin=a.transform:this.origin=null,this.origin!==null?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix),this._geometryData!==i)if(this._geometryDirty=!0,this._verticesDirty=!0,this._geometryData!==null){if(this._geometryBones.length=0,this._geometryData.weight!==null)for(let s=0,o=this._geometryData.weight.bones.length;s<o;++s){const l=this._armature.getBone(this._geometryData.weight.bones[s].name);this._geometryBones.push(l)}}else this._geometryBones.length=0,this._geometryData=null;this._textureDirty=this._textureData!==e,this._transformDirty=!0}}_updateDisplay(){const t=this._display!==null?this._display:this._rawDisplay,i=this._childArmature;if(this._displayFrame!==null?(this._display=this._displayFrame.display,this._display!==null&&this._display instanceof le?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null),(this._display!==null?this._display:this._rawDisplay)!==t&&(this._textureDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._transformDirty=!0,this._onUpdateDisplay(),this._replaceDisplay(t)),this._childArmature!==i){if(i!==null&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),this._armature===null)throw new Error("this._armature is null.");if(this._childArmature!==null&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation)){if(this._childArmature.cacheFrameRate===0){const e=this._armature.cacheFrameRate;e!==0&&(this._childArmature.cacheFrameRate=e)}if(this._displayFrame!==null){let e=null,n=this._displayFrame.displayData!==null?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(n!==null&&n.type===Q.Armature&&(e=n.actions),e!==null&&e.length>0)for(const a of e){const s=R.borrowObject(rt);rt.actionDataToInstance(a,s,this._armature),s.slot=this,this._armature._bufferAction(s,!1)}else this._childArmature.animation.play()}}}}_updateGlobalTransformMatrix(t){if(this._parent===null)throw new Error("this._parent is null.");if(this._parent._boneData===null)throw new Error("this._parent._boneData is null.");const i=this._parent._boneData.type===mt.Bone?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(i),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0}_setDisplayIndex(t,i=!1){if(i){if(this._animationDisplayIndex===t)return;this._animationDisplayIndex=t}this._displayIndex!==t&&(this._displayIndex=t<this._displayFrames.length?t:this._displayFrames.length-1,this._displayDataDirty=!0,this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display)}_setZOrder(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty}_setColor(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0}init(t,i,e,n){if(this._slotData!==null)return;if(t.color===null)throw new Error("slotData.color is null.");if(this._slotData=t,this._colorDirty=!0,this._blendModeDirty=!0,this._blendMode=t.blendMode,this._zOrder=t.zOrder,this._zIndex=t.zIndex,this._alpha=t.alpha,this._colorTransform.copyFrom(t.color),this._rawDisplay=e,this._meshDisplay=n,this._armature=i,t.parent===null)throw new Error("slotData.parent is null.");const a=this._armature.getBone(t.parent.name);a!==null&&(this._parent=a),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}update(t){if(this._displayDataDirty&&(this._updateDisplayData(),this._displayDataDirty=!1),this._displayDirty&&(this._updateDisplay(),this._displayDirty=!1),(this._geometryDirty||this._textureDirty)&&((this._display===null||this._display===this._rawDisplay||this._display===this._meshDisplay)&&this._updateFrame(),this._geometryDirty=!1,this._textureDirty=!1),this._display!==null){if(this._visibleDirty&&(this._updateVisible(),this._visibleDirty=!1),this._blendModeDirty&&(this._updateBlendMode(),this._blendModeDirty=!1),this._colorDirty&&(this._updateColor(),this._colorDirty=!1),this._zOrderDirty&&(this._updateZOrder(),this._zOrderDirty=!1),this._parent===null)throw new Error("this._parent is null.");if(this._parent._boneData===null)throw new Error("this._parent._boneData is null.");if(this._geometryData!==null&&this._display===this._meshDisplay){const i=this._geometryData.weight!==null,e=this._parent._boneData.type!==mt.Bone;if((this._verticesDirty||i&&this._isBonesUpdate()||e&&this._parent._childrenTransformDirty)&&(this._verticesDirty=!1,this._updateMesh()),i||e)return}if(t>=0&&this._cachedFrameIndices!==null){const i=this._cachedFrameIndices[t];i>=0&&this._cachedFrameIndex===i?this._transformDirty=!1:i>=0?(this._transformDirty=!0,this._cachedFrameIndex=i):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._armature===null)throw new Error(" this._armature is null.");if(this._armature._armatureData===null)throw new Error("  this._armature._armatureData is null.");if(this._transformDirty){if(this._cachedFrameIndex<0){const i=t>=0;this._updateGlobalTransformMatrix(i),i&&this._cachedFrameIndices!==null&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(),this._transformDirty=!1}}}invalidUpdate(){this._displayDataDirty=!0,this._displayDirty=!0,this._transformDirty=!0}updateTransformAndMatrix(){this._transformDirty&&(this._updateGlobalTransformMatrix(!1),this._transformDirty=!1)}replaceRawDisplayData(t,i=-1){if(i<0)i=this._displayIndex<0?0:this._displayIndex;else if(i>=this._displayFrames.length)return;if(this._armature===null)throw new Error(" this._armature is null.");if(this._armature._armatureData===null)throw new Error("  this._armature._armatureData is null.");if(this._slotData===null)throw new Error("  this._slotData is null.");const e=this._displayFrames[i];if(e.rawDisplayData!==t){if(e.deformVertices.length=0,e.rawDisplayData=t,e.rawDisplayData===null){const n=this._armature._armatureData.defaultSkin;if(n!==null){const a=n.getDisplays(this._slotData.name);a!==null&&i<a.length&&(e.rawDisplayData=a[i])}}i===this._displayIndex&&(this._displayDataDirty=!0)}}replaceDisplayData(t,i=-1){if(i<0)i=this._displayIndex<0?0:this._displayIndex;else if(i>=this._displayFrames.length)return;const e=this._displayFrames[i];e.displayData!==t&&e.rawDisplayData!==t&&(e.displayData=t,i===this._displayIndex&&(this._displayDataDirty=!0))}replaceTextureData(t,i=-1){if(i<0)i=this._displayIndex<0?0:this._displayIndex;else if(i>=this._displayFrames.length)return;const e=this._displayFrames[i];e.textureData!==t&&(e.textureData=t,i===this._displayIndex&&(this._displayDataDirty=!0))}replaceDisplay(t,i=-1){if(i<0)i=this._displayIndex<0?0:this._displayIndex;else if(i>=this._displayFrames.length)return;const e=this._displayFrames[i];if(e.display!==t){const n=e.display;e.display=t,n!==null&&n!==this._rawDisplay&&n!==this._meshDisplay&&!this._hasDisplay(n)&&(n instanceof le||this._disposeDisplay(n,!0)),t!==null&&t!==this._rawDisplay&&t!==this._meshDisplay&&!this._hasDisplay(n)&&!(t instanceof le)&&this._initDisplay(t,!0),i===this._displayIndex&&(this._displayDirty=!0)}}containsPoint(t,i){return this._boundingBoxData===null?!1:(this.updateTransformAndMatrix(),tt._helpMatrix.copyFrom(this.globalTransformMatrix),tt._helpMatrix.invert(),tt._helpMatrix.transformPoint(t,i,tt._helpPoint),this._boundingBoxData.containsPoint(tt._helpPoint.x,tt._helpPoint.y))}intersectsSegment(t,i,e,n,a=null,s=null,o=null){if(this._boundingBoxData===null)return 0;this.updateTransformAndMatrix(),tt._helpMatrix.copyFrom(this.globalTransformMatrix),tt._helpMatrix.invert(),tt._helpMatrix.transformPoint(t,i,tt._helpPoint),t=tt._helpPoint.x,i=tt._helpPoint.y,tt._helpMatrix.transformPoint(e,n,tt._helpPoint),e=tt._helpPoint.x,n=tt._helpPoint.y;const l=this._boundingBoxData.intersectsSegment(t,i,e,n,a,s,o);return l>0&&(l===1||l===2?a!==null?(this.globalTransformMatrix.transformPoint(a.x,a.y,a),s!==null&&(s.x=a.x,s.y=a.y)):s!==null&&this.globalTransformMatrix.transformPoint(s.x,s.y,s):(a!==null&&this.globalTransformMatrix.transformPoint(a.x,a.y,a),s!==null&&this.globalTransformMatrix.transformPoint(s.x,s.y,s)),o!==null&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),tt._helpPoint,!0),o.x=Math.atan2(tt._helpPoint.y,tt._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),tt._helpPoint,!0),o.y=Math.atan2(tt._helpPoint.y,tt._helpPoint.x))),l}getDisplayFrameAt(t){return this._displayFrames[t]}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateVisible())}get displayFrameCount(){return this._displayFrames.length}set displayFrameCount(t){const i=this._displayFrames.length;if(i<t){this._displayFrames.length=t;for(let e=i;e<t;++e)this._displayFrames[e]=R.borrowObject(Uu)}else if(i>t){for(let e=i-1;e<t;--e)this.replaceDisplay(null,e),this._displayFrames[e].returnToPool();this._displayFrames.length=t}}get displayIndex(){return this._displayIndex}set displayIndex(t){this._setDisplayIndex(t),this.update(-1)}get name(){if(this._slotData===null)throw new Error("  this._slotData is null.");return this._slotData.name}get displayList(){const t=new Array;for(const i of this._displayFrames)t.push(i.display);return t}set displayList(t){this.displayFrameCount=t.length;let i=0;for(const e of t)this.replaceDisplay(e,i++)}get slotData(){if(this._slotData===null)throw new Error("  this._slotData is null.");return this._slotData}get boundingBoxData(){return this._boundingBoxData}get rawDisplay(){return this._rawDisplay}get meshDisplay(){return this._meshDisplay}get display(){return this._display}set display(t){this._display!==t&&(this._displayFrames.length===0&&(this.displayFrameCount=1,this._displayIndex=0),this.replaceDisplay(t,this._displayIndex))}get childArmature(){return this._childArmature}set childArmature(t){this._childArmature!==t&&(this.display=t)}get parent(){if(this._parent===null)throw new Error("this._parent is null.");return this._parent}getDisplay(){return this._display}setDisplay(t){this.display=t}}class Et extends Ll{constructor(){super(...arguments),c(this,"_dX",0),c(this,"_dY",0),c(this,"_k",0),c(this,"_kX",0),c(this,"_kY",0),c(this,"_vertices",[]),c(this,"_deformVertices",[]),c(this,"_hullCache",[]),c(this,"_matrixCahce",[]),c(this,"_bone",null)}static toString(){return"[class dragonBones.Surface]"}_onClear(){super._onClear(),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0,this._bone=null}_getAffineTransform(t,i,e,n,a,s,o,l,h,u,f,d,p){const _=o-a,m=l-s,g=h-a,y=u-s;f.rotation=Math.atan2(m,_),f.skew=Math.atan2(y,g)-Math.PI*.5-f.rotation,p&&(f.rotation+=Math.PI),f.scaleX=Math.sqrt(_*_+m*m)/e,f.scaleY=Math.sqrt(g*g+y*y)/n,f.toMatrix(d),f.x=d.tx=a-(d.a*t+d.c*i),f.y=d.ty=s-(d.b*t+d.d*i)}_updateVertices(){if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");const t=this._armature.armatureData.parent;if(t===null)throw new Error("data is null.");const i=this._boneData.geometry,e=t.intArray,n=t.floatArray;if(e===null)throw new Error("intArray is null.");if(n===null)throw new Error("floatArray is null.");const a=e[i.offset+P.GeometryVertexCount],s=e[i.offset+P.GeometryFloatOffset],o=this._vertices,l=this._deformVertices;if(this._parent!==null){if(this._parent._boneData===null)throw new Error("this._parent._boneData is null.");if(this._parent._boneData.type===mt.Surface)for(let h=0,u=a;h<u;++h){const f=h*2,d=n[s+f]+l[f],p=n[s+f+1]+l[f+1],_=this._parent._getGlobalTransformMatrix(d,p);o[f]=_.a*d+_.c*p+_.tx,o[f+1]=_.b*d+_.d*p+_.ty}else{const h=this._parent.globalTransformMatrix;for(let u=0,f=a;u<f;++u){const d=u*2,p=n[s+d]+l[d],_=n[s+d+1]+l[d+1];o[d]=h.a*p+h.c*_+h.tx,o[d+1]=h.b*p+h.d*_+h.ty}}}else for(let h=0,u=a;h<u;++h){const f=h*2;o[f]=n[s+f]+l[f],o[f+1]=n[s+f+1]+l[f+1]}}_updateGlobalTransformMatrix(t){if(this._boneData===null)throw new Error("this._boneData is null.");const i=this._boneData.segmentX*2,e=this._vertices.length-2,n=200,a=this._vertices[0],s=this._vertices[1],o=this._vertices[i],l=this._vertices[i+1],h=this._vertices[e],u=this._vertices[e+1],f=this._vertices[e-i],d=this._vertices[e-i+1],p=a+(h-a)*.5,_=s+(u-s)*.5,m=o+(f-o)*.5,g=l+(d-l)*.5,y=p+(m-p)*.5,w=_+(g-_)*.5,T=o+(h-o)*.5,x=l+(u-l)*.5,E=f+(h-f)*.5,b=d+(u-d)*.5;this._getAffineTransform(0,0,n,n,y,w,T,x,E,b,this.global,this.globalTransformMatrix,!1),this._globalDirty=!1}_getGlobalTransformMatrix(t,i){if(t<-1e3||1e3<t||i<-1e3||1e3<i)return this.globalTransformMatrix;let e=!1;const n=this._boneData,a=n.segmentX,s=n.segmentY,o=n.segmentX*2,l=this._dX,h=this._dY,u=Math.floor((t+200)/l),f=Math.floor((i+200)/h);let d=0,p=u*l-200,_=f*h-200;const m=this._matrixCahce,g=Et._helpMatrix;if(t<-200){if(i<-200||i>=200)return this.globalTransformMatrix;if(e=i>this._kX*(t+200)+_,d=((a*s+a+s+s+f)*2+(e?1:0))*7,m[d]>0)g.copyFromArray(m,d+1);else{const y=f*(o+2),w=this._hullCache[4],T=this._hullCache[5],x=this._hullCache[2]-(s-f)*w,E=this._hullCache[3]-(s-f)*T,b=this._vertices;e?this._getAffineTransform(-200,_+h,1e3-200,h,b[y+o+2],b[y+o+3],x+w,E+T,b[y],b[y+1],Et._helpTransform,g,!0):this._getAffineTransform(-1e3,_,1e3-200,h,x,E,b[y],b[y+1],x+w,E+T,Et._helpTransform,g,!1),m[d]=1,m[d+1]=g.a,m[d+2]=g.b,m[d+3]=g.c,m[d+4]=g.d,m[d+5]=g.tx,m[d+6]=g.ty}}else if(t>=200){if(i<-200||i>=200)return this.globalTransformMatrix;if(e=i>this._kX*(t-1e3)+_,d=((a*s+a+f)*2+(e?1:0))*7,m[d]>0)g.copyFromArray(m,d+1);else{const y=(f+1)*(o+2)-2,w=this._hullCache[4],T=this._hullCache[5],x=this._hullCache[0]+f*w,E=this._hullCache[1]+f*T,b=this._vertices;e?this._getAffineTransform(1e3,_+h,1e3-200,h,x+w,E+T,b[y+o+2],b[y+o+3],x,E,Et._helpTransform,g,!0):this._getAffineTransform(200,_,1e3-200,h,b[y],b[y+1],x,E,b[y+o+2],b[y+o+3],Et._helpTransform,g,!1),m[d]=1,m[d+1]=g.a,m[d+2]=g.b,m[d+3]=g.c,m[d+4]=g.d,m[d+5]=g.tx,m[d+6]=g.ty}}else if(i<-200){if(t<-200||t>=200)return this.globalTransformMatrix;if(e=i>this._kY*(t-p-l)-1e3,d=((a*s+u)*2+(e?1:0))*7,m[d]>0)g.copyFromArray(m,d+1);else{const y=u*2,w=this._hullCache[10],T=this._hullCache[11],x=this._hullCache[8]+u*w,E=this._hullCache[9]+u*T,b=this._vertices;e?this._getAffineTransform(p+l,-200,l,1e3-200,b[y+2],b[y+3],b[y],b[y+1],x+w,E+T,Et._helpTransform,g,!0):this._getAffineTransform(p,-1e3,l,1e3-200,x,E,x+w,E+T,b[y],b[y+1],Et._helpTransform,g,!1),m[d]=1,m[d+1]=g.a,m[d+2]=g.b,m[d+3]=g.c,m[d+4]=g.d,m[d+5]=g.tx,m[d+6]=g.ty}}else if(i>=200){if(t<-200||t>=200)return this.globalTransformMatrix;if(e=i>this._kY*(t-p-l)+200,d=((a*s+a+s+u)*2+(e?1:0))*7,m[d]>0)g.copyFromArray(m,d+1);else{const y=s*(o+2)+u*2,w=this._hullCache[10],T=this._hullCache[11],x=this._hullCache[6]-(a-u)*w,E=this._hullCache[7]-(a-u)*T,b=this._vertices;e?this._getAffineTransform(p+l,1e3,l,1e3-200,x+w,E+T,x,E,b[y+2],b[y+3],Et._helpTransform,g,!0):this._getAffineTransform(p,200,l,1e3-200,b[y],b[y+1],b[y+2],b[y+3],x,E,Et._helpTransform,g,!1),m[d]=1,m[d+1]=g.a,m[d+2]=g.b,m[d+3]=g.c,m[d+4]=g.d,m[d+5]=g.tx,m[d+6]=g.ty}}else if(e=i>this._k*(t-p-l)+_,d=((a*f+u)*2+(e?1:0))*7,m[d]>0)g.copyFromArray(m,d+1);else{const y=u*2+f*(o+2),w=this._vertices;e?this._getAffineTransform(p+l,_+h,l,h,w[y+o+4],w[y+o+5],w[y+o+2],w[y+o+3],w[y+2],w[y+3],Et._helpTransform,g,!0):this._getAffineTransform(p,_,l,h,w[y],w[y+1],w[y+2],w[y+3],w[y+o+2],w[y+o+3],Et._helpTransform,g,!1),m[d]=1,m[d+1]=g.a,m[d+2]=g.b,m[d+3]=g.c,m[d+4]=g.d,m[d+5]=g.tx,m[d+6]=g.ty}return g}init(t,i){if(this._boneData!==null)return;if(super.init(t,i),this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");if(this._armature.armatureData.parent===null)throw new Error("this._armature.armatureData.parent is null.");if(this._armature.armatureData.parent.intArray===null)throw new Error("this._armature.armatureData.parent.intArray is null.");const e=t.segmentX,n=t.segmentY,a=this._armature.armatureData.parent.intArray[t.geometry.offset+P.GeometryVertexCount],s=1e3,o=200;this._dX=o*2/e,this._dY=o*2/n,this._k=-this._dY/this._dX,this._kX=-this._dY/(s-o),this._kY=-(s-o)/this._dX,this._vertices.length=a*2,this._deformVertices.length=a*2,this._matrixCahce.length=(e*n+e*2+n*2)*2*7,this._hullCache.length=10;for(let l=0;l<a*2;++l)this._deformVertices[l]=0;this._parent!==null&&(this._parent.boneData.type===mt.Bone?this._bone=this._parent:this._bone=this._parent._bone)}update(t){if(t>=0&&this._cachedFrameIndices!==null){const i=this._cachedFrameIndices[t];if(i>=0&&this._cachedFrameIndex===i)this._transformDirty=!1;else if(i>=0)this._transformDirty=!0,this._cachedFrameIndex=i;else{if(this._hasConstraint){if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");for(const e of this._armature._constraints)e._root===this&&e.update()}if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint){if(this._armature===null)throw new Error("this._armature is null.");for(const i of this._armature._constraints)i._root===this&&i.update()}(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(let o=0,l=this._matrixCahce.length;o<l;o+=7)this._matrixCahce[o]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){const o=t>=0;if(this._localDirty&&this._updateGlobalTransformMatrix(o),o&&this._cachedFrameIndices!==null){if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{if(this._armature===null)throw new Error("this._armature is null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}const i=1e3,e=200,n=2*this.global.x,a=2*this.global.y,s=Et._helpPoint;this.globalTransformMatrix.transformPoint(i,-e,s),this._hullCache[0]=s.x,this._hullCache[1]=s.y,this._hullCache[2]=n-s.x,this._hullCache[3]=a-s.y,this.globalTransformMatrix.transformPoint(0,this._dY,s,!0),this._hullCache[4]=s.x,this._hullCache[5]=s.y,this.globalTransformMatrix.transformPoint(e,i,s),this._hullCache[6]=s.x,this._hullCache[7]=s.y,this._hullCache[8]=n-s.x,this._hullCache[9]=a-s.y,this.globalTransformMatrix.transformPoint(this._dX,0,s,!0),this._hullCache[10]=s.x,this._hullCache[11]=s.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0}}class Nl extends R{constructor(){super(...arguments),c(this,"frameIntOffset",0),c(this,"frameFloatOffset",0),c(this,"frameOffset",0),c(this,"blendType",Ft.None),c(this,"frameCount",0),c(this,"playTimes",0),c(this,"duration",0),c(this,"scale",1),c(this,"fadeInTime",0),c(this,"cacheFrameRate",0),c(this,"name",""),c(this,"cachedFrames",[]),c(this,"boneTimelines",{}),c(this,"slotTimelines",{}),c(this,"constraintTimelines",{}),c(this,"animationTimelines",{}),c(this,"boneCachedFrameIndices",{}),c(this,"slotCachedFrameIndices",{}),c(this,"actionTimeline",null),c(this,"zOrderTimeline",null),c(this,"parent",null)}static toString(){return"[class dragonBones.AnimationData]"}_onClear(){for(let t in this.boneTimelines){for(const i of this.boneTimelines[t])i.returnToPool();delete this.boneTimelines[t]}for(let t in this.slotTimelines){for(const i of this.slotTimelines[t])i.returnToPool();delete this.slotTimelines[t]}for(let t in this.constraintTimelines){for(const i of this.constraintTimelines[t])i.returnToPool();delete this.constraintTimelines[t]}for(let t in this.animationTimelines){for(const i of this.animationTimelines[t])i.returnToPool();delete this.animationTimelines[t]}for(let t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(let t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];this.actionTimeline!==null&&this.actionTimeline.returnToPool(),this.zOrderTimeline!==null&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.blendType=Ft.None,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null}cacheFrames(t){if(this.cacheFrameRate>0)return;this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);const i=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=i;for(let e=0,n=this.cacheFrames.length;e<n;++e)this.cachedFrames[e]=!1;try{for(const e of this.parent.sortedBones){const n=new Array(i);for(let a=0,s=n.length;a<s;++a)n[a]=-1;this.boneCachedFrameIndices[e.name]=n}for(const e of this.parent.sortedSlots){const n=new Array(i);for(let a=0,s=n.length;a<s;++a)n[a]=-1;this.slotCachedFrameIndices[e.name]=n}}catch{}}addBoneTimeline(t,i){const e=t in this.boneTimelines?this.boneTimelines[t]:this.boneTimelines[t]=[];e.indexOf(i)<0&&e.push(i)}addSlotTimeline(t,i){const e=t in this.slotTimelines?this.slotTimelines[t]:this.slotTimelines[t]=[];e.indexOf(i)<0&&e.push(i)}addConstraintTimeline(t,i){const e=t in this.constraintTimelines?this.constraintTimelines[t]:this.constraintTimelines[t]=[];e.indexOf(i)<0&&e.push(i)}addAnimationTimeline(t,i){const e=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];e.indexOf(i)<0&&e.push(i)}getBoneTimelines(t){return t in this.boneTimelines?this.boneTimelines[t]:null}getSlotTimelines(t){return t in this.slotTimelines?this.slotTimelines[t]:null}getConstraintTimelines(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null}getAnimationTimelines(t){return t in this.animationTimelines?this.animationTimelines[t]:null}getBoneCachedFrameIndices(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null}getSlotCachedFrameIndices(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null}}class ba extends R{constructor(){super(...arguments),c(this,"type",C.BoneAll),c(this,"offset",0),c(this,"frameIndicesOffset",-1)}static toString(){return"[class dragonBones.TimelineData]"}_onClear(){this.type=C.BoneAll,this.offset=0,this.frameIndicesOffset=-1}}class kl extends ba{constructor(){super(...arguments),c(this,"x",0),c(this,"y",0)}static toString(){return"[class dragonBones.AnimationTimelineData]"}_onClear(){super._onClear(),this.x=0,this.y=0}}class Er extends R{constructor(){super(...arguments),c(this,"type"),c(this,"name",""),c(this,"path",""),c(this,"transform",new Y),c(this,"parent",null)}_onClear(){this.name="",this.path="",this.transform.identity(),this.parent=null}}class $u extends Er{constructor(){super(...arguments),c(this,"inheritAnimation",!1),c(this,"actions",[]),c(this,"armature",null)}static toString(){return"[class dragonBones.ArmatureDisplayData]"}_onClear(){super._onClear();for(const t of this.actions)t.returnToPool();this.type=Q.Armature,this.inheritAnimation=!1,this.actions.length=0,this.armature=null}addAction(t){this.actions.push(t)}}class Gu extends Er{constructor(){super(...arguments),c(this,"boundingBox",null)}static toString(){return"[class dragonBones.BoundingBoxDisplayData]"}_onClear(){super._onClear(),this.boundingBox!==null&&this.boundingBox.returnToPool(),this.type=Q.BoundingBox,this.boundingBox=null}}class Ea{constructor(){c(this,"isShared",!1),c(this,"inheritDeform",!1),c(this,"offset",0),c(this,"data",null),c(this,"weight",null)}clear(){!this.isShared&&this.weight!==null&&this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null}shareFrom(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight}get vertexCount(){if(this.data===null||this.offset===void 0||this.data.intArray===null)throw new Error;return this.data.intArray[this.offset+P.GeometryVertexCount]}get triangleCount(){if(this.data===null||this.offset===void 0||this.data.intArray===null)throw new Error;return this.data.intArray[this.offset+P.GeometryTriangleCount]}}class Xu extends Er{constructor(){super(...arguments),c(this,"pivot",new wi),c(this,"texture",null)}static toString(){return"[class dragonBones.ImageDisplayData]"}_onClear(){super._onClear(),this.type=Q.Image,this.pivot.clear(),this.texture=null}}class Vu extends Er{constructor(){super(...arguments),c(this,"geometry",new Ea),c(this,"texture",null)}static toString(){return"[class dragonBones.MeshDisplayData]"}_onClear(){super._onClear(),this.type=Q.Mesh,this.geometry.clear(),this.texture=null}}class fo extends Er{constructor(){super(...arguments),c(this,"closed",!1),c(this,"constantSpeed",!1),c(this,"geometry",new Ea),c(this,"curveLengths",[])}static toString(){return"[class dragonBones.PathDisplayData]"}_onClear(){super._onClear(),this.type=Q.Path,this.closed=!1,this.constantSpeed=!1,this.geometry.clear(),this.curveLengths.length=0}}class Ul extends R{constructor(){super(...arguments),c(this,"count",0),c(this,"offset",0),c(this,"bones",[])}static toString(){return"[class dragonBones.WeightData]"}_onClear(){this.count=0,this.offset=0,this.bones.length=0}addBone(t){this.bones.push(t)}}const ve=class{static _getArmatureType(r){switch(r.toLowerCase()){case"stage":return oe.Stage;case"armature":return oe.Armature;case"movieclip":return oe.MovieClip;default:return oe.Armature}}static _getBoneType(r){switch(r.toLowerCase()){case"bone":return mt.Bone;case"surface":return mt.Surface;default:return mt.Bone}}static _getPositionMode(r){switch(r.toLocaleLowerCase()){case"percent":return Ee.Percent;case"fixed":return Ee.Fixed;default:return Ee.Percent}}static _getSpacingMode(r){switch(r.toLocaleLowerCase()){case"length":return Zt.Length;case"percent":return Zt.Percent;case"fixed":return Zt.Fixed;default:return Zt.Length}}static _getRotateMode(r){switch(r.toLocaleLowerCase()){case"tangent":return Xt.Tangent;case"chain":return Xt.Chain;case"chainscale":return Xt.ChainScale;default:return Xt.Tangent}}static _getDisplayType(r){switch(r.toLowerCase()){case"image":return Q.Image;case"mesh":return Q.Mesh;case"armature":return Q.Armature;case"boundingbox":return Q.BoundingBox;case"path":return Q.Path;default:return Q.Image}}static _getBoundingBoxType(r){switch(r.toLowerCase()){case"rectangle":return yt.Rectangle;case"ellipse":return yt.Ellipse;case"polygon":return yt.Polygon;default:return yt.Rectangle}}static _getBlendMode(r){switch(r.toLowerCase()){case"normal":return st.Normal;case"add":return st.Add;case"alpha":return st.Alpha;case"darken":return st.Darken;case"difference":return st.Difference;case"erase":return st.Erase;case"hardlight":return st.HardLight;case"invert":return st.Invert;case"layer":return st.Layer;case"lighten":return st.Lighten;case"multiply":return st.Multiply;case"overlay":return st.Overlay;case"screen":return st.Screen;case"subtract":return st.Subtract;default:return st.Normal}}static _getAnimationBlendType(r){switch(r.toLowerCase()){case"none":return Ft.None;case"1d":return Ft.E1D;default:return Ft.None}}static _getActionType(r){switch(r.toLowerCase()){case"play":return lt.Play;case"frame":return lt.Frame;case"sound":return lt.Sound;default:return lt.Play}}};let v=ve;c(v,"DATA_VERSION_2_3","2.3"),c(v,"DATA_VERSION_3_0","3.0"),c(v,"DATA_VERSION_4_0","4.0"),c(v,"DATA_VERSION_4_5","4.5"),c(v,"DATA_VERSION_5_0","5.0"),c(v,"DATA_VERSION_5_5","5.5"),c(v,"DATA_VERSION_5_6","5.6"),c(v,"DATA_VERSION",ve.DATA_VERSION_5_6),c(v,"DATA_VERSIONS",[ve.DATA_VERSION_4_0,ve.DATA_VERSION_4_5,ve.DATA_VERSION_5_0,ve.DATA_VERSION_5_5,ve.DATA_VERSION_5_6]),c(v,"TEXTURE_ATLAS","textureAtlas"),c(v,"SUB_TEXTURE","SubTexture"),c(v,"FORMAT","format"),c(v,"IMAGE_PATH","imagePath"),c(v,"WIDTH","width"),c(v,"HEIGHT","height"),c(v,"ROTATED","rotated"),c(v,"FRAME_X","frameX"),c(v,"FRAME_Y","frameY"),c(v,"FRAME_WIDTH","frameWidth"),c(v,"FRAME_HEIGHT","frameHeight"),c(v,"DRADON_BONES","dragonBones"),c(v,"USER_DATA","userData"),c(v,"ARMATURE","armature"),c(v,"CANVAS","canvas"),c(v,"BONE","bone"),c(v,"SURFACE","surface"),c(v,"SLOT","slot"),c(v,"CONSTRAINT","constraint"),c(v,"SKIN","skin"),c(v,"DISPLAY","display"),c(v,"FRAME","frame"),c(v,"IK","ik"),c(v,"PATH_CONSTRAINT","path"),c(v,"ANIMATION","animation"),c(v,"TIMELINE","timeline"),c(v,"FFD","ffd"),c(v,"TRANSLATE_FRAME","translateFrame"),c(v,"ROTATE_FRAME","rotateFrame"),c(v,"SCALE_FRAME","scaleFrame"),c(v,"DISPLAY_FRAME","displayFrame"),c(v,"COLOR_FRAME","colorFrame"),c(v,"DEFAULT_ACTIONS","defaultActions"),c(v,"ACTIONS","actions"),c(v,"EVENTS","events"),c(v,"INTS","ints"),c(v,"FLOATS","floats"),c(v,"STRINGS","strings"),c(v,"TRANSFORM","transform"),c(v,"PIVOT","pivot"),c(v,"AABB","aabb"),c(v,"COLOR","color"),c(v,"VERSION","version"),c(v,"COMPATIBLE_VERSION","compatibleVersion"),c(v,"FRAME_RATE","frameRate"),c(v,"TYPE","type"),c(v,"SUB_TYPE","subType"),c(v,"NAME","name"),c(v,"PARENT","parent"),c(v,"TARGET","target"),c(v,"STAGE","stage"),c(v,"SHARE","share"),c(v,"PATH","path"),c(v,"LENGTH","length"),c(v,"DISPLAY_INDEX","displayIndex"),c(v,"Z_ORDER","zOrder"),c(v,"Z_INDEX","zIndex"),c(v,"BLEND_MODE","blendMode"),c(v,"INHERIT_TRANSLATION","inheritTranslation"),c(v,"INHERIT_ROTATION","inheritRotation"),c(v,"INHERIT_SCALE","inheritScale"),c(v,"INHERIT_REFLECTION","inheritReflection"),c(v,"INHERIT_ANIMATION","inheritAnimation"),c(v,"INHERIT_DEFORM","inheritDeform"),c(v,"SEGMENT_X","segmentX"),c(v,"SEGMENT_Y","segmentY"),c(v,"BEND_POSITIVE","bendPositive"),c(v,"CHAIN","chain"),c(v,"WEIGHT","weight"),c(v,"BLEND_TYPE","blendType"),c(v,"FADE_IN_TIME","fadeInTime"),c(v,"PLAY_TIMES","playTimes"),c(v,"SCALE","scale"),c(v,"OFFSET","offset"),c(v,"POSITION","position"),c(v,"DURATION","duration"),c(v,"TWEEN_EASING","tweenEasing"),c(v,"TWEEN_ROTATE","tweenRotate"),c(v,"TWEEN_SCALE","tweenScale"),c(v,"CLOCK_WISE","clockwise"),c(v,"CURVE","curve"),c(v,"SOUND","sound"),c(v,"EVENT","event"),c(v,"ACTION","action"),c(v,"X","x"),c(v,"Y","y"),c(v,"SKEW_X","skX"),c(v,"SKEW_Y","skY"),c(v,"SCALE_X","scX"),c(v,"SCALE_Y","scY"),c(v,"VALUE","value"),c(v,"ROTATE","rotate"),c(v,"SKEW","skew"),c(v,"ALPHA","alpha"),c(v,"ALPHA_OFFSET","aO"),c(v,"RED_OFFSET","rO"),c(v,"GREEN_OFFSET","gO"),c(v,"BLUE_OFFSET","bO"),c(v,"ALPHA_MULTIPLIER","aM"),c(v,"RED_MULTIPLIER","rM"),c(v,"GREEN_MULTIPLIER","gM"),c(v,"BLUE_MULTIPLIER","bM"),c(v,"UVS","uvs"),c(v,"VERTICES","vertices"),c(v,"TRIANGLES","triangles"),c(v,"WEIGHTS","weights"),c(v,"SLOT_POSE","slotPose"),c(v,"BONE_POSE","bonePose"),c(v,"BONES","bones"),c(v,"POSITION_MODE","positionMode"),c(v,"SPACING_MODE","spacingMode"),c(v,"ROTATE_MODE","rotateMode"),c(v,"SPACING","spacing"),c(v,"ROTATE_OFFSET","rotateOffset"),c(v,"ROTATE_MIX","rotateMix"),c(v,"TRANSLATE_MIX","translateMix"),c(v,"TARGET_DISPLAY","targetDisplay"),c(v,"CLOSED","closed"),c(v,"CONSTANT_SPEED","constantSpeed"),c(v,"VERTEX_COUNT","vertexCount"),c(v,"LENGTHS","lengths"),c(v,"GOTO_AND_PLAY","gotoAndPlay"),c(v,"DEFAULT_NAME","default");class ha{constructor(t=0,i=0,e=0,n=0){c(this,"x"),c(this,"y"),c(this,"width"),c(this,"height"),this.x=t,this.y=i,this.width=e,this.height=n}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}clear(){this.x=this.y=0,this.width=this.height=0}}class Wu extends R{constructor(){super(...arguments),c(this,"type",oe.Armature),c(this,"frameRate",0),c(this,"cacheFrameRate",0),c(this,"scale",1),c(this,"name",""),c(this,"aabb",new ha),c(this,"animationNames",[]),c(this,"sortedBones",[]),c(this,"sortedSlots",[]),c(this,"defaultActions",[]),c(this,"actions",[]),c(this,"bones",{}),c(this,"slots",{}),c(this,"constraints",{}),c(this,"skins",{}),c(this,"animations",{}),c(this,"defaultSkin",null),c(this,"defaultAnimation",null),c(this,"canvas",null),c(this,"userData",null),c(this,"parent",null)}static toString(){return"[class dragonBones.ArmatureData]"}_onClear(){for(const t of this.defaultActions)t.returnToPool();for(const t of this.actions)t.returnToPool();for(let t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(let t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(let t in this.constraints)this.constraints[t].returnToPool(),delete this.constraints[t];for(let t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(let t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];this.canvas!==null&&this.canvas.returnToPool(),this.userData!==null&&this.userData.returnToPool(),this.type=oe.Armature,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null}sortBones(){const t=this.sortedBones.length;if(t<=0)return;const i=this.sortedBones.concat();let e=0,n=0;for(this.sortedBones.length=0;n<t;){const a=i[e++];if(e>=t&&(e=0),this.sortedBones.indexOf(a)>=0)continue;let s=!1;for(let o in this.constraints){const l=this.constraints[o];if(l.root===a&&this.sortedBones.findIndex(h=>h===l.target)<0){s=!0;break}}s||a.parent!==null&&this.sortedBones.indexOf(a.parent)<0||(this.sortedBones.push(a),n++)}}cacheFrames(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=t;for(let i in this.animations)this.animations[i].cacheFrames(this.cacheFrameRate)}}setCacheFrame(t,i){if(this.parent===null)throw new Error("this.parent is null.");const e=this.parent.cachedFrames;let n=e.length;return e.length+=10,e[n]=t.a,e[n+1]=t.b,e[n+2]=t.c,e[n+3]=t.d,e[n+4]=t.tx,e[n+5]=t.ty,e[n+6]=i.rotation,e[n+7]=i.skew,e[n+8]=i.scaleX,e[n+9]=i.scaleY,n}getCacheFrame(t,i,e){if(this.parent===null)throw new Error("this.parent is nul.");const n=this.parent.cachedFrames;t.a=n[e],t.b=n[e+1],t.c=n[e+2],t.d=n[e+3],t.tx=n[e+4],t.ty=n[e+5],i.rotation=n[e+6],i.skew=n[e+7],i.scaleX=n[e+8],i.scaleY=n[e+9],i.x=t.tx,i.y=t.ty}addBone(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.bones){console.warn("Same bone: "+t.name);return}this.bones[t.name]=t,this.sortedBones.push(t)}addSlot(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.slots){console.warn("Same slot: "+t.name);return}this.slots[t.name]=t,this.sortedSlots.push(t)}addConstraint(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.constraints){console.warn("Same constraint: "+t.name);return}this.constraints[t.name]=t}addSkin(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.skins){console.warn("Same skin: "+t.name);return}t.parent=this,this.skins[t.name]=t,this.defaultSkin===null&&(this.defaultSkin=t),t.name==="default"&&(this.defaultSkin=t)}addAnimation(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.animations){console.warn("Same animation: "+t.name);return}t.parent=this,this.animations[t.name]=t,this.animationNames.push(t.name),this.defaultAnimation===null&&(this.defaultAnimation=t)}addAction(t,i){i?this.defaultActions.push(t):this.actions.push(t)}getBone(t){return t in this.bones?this.bones[t]:null}getSlot(t){return t in this.slots?this.slots[t]:null}getConstraint(t){return t in this.constraints?this.constraints[t]:null}getSkin(t){return t in this.skins?this.skins[t]:null}getMesh(t,i,e){const n=this.getSkin(t);return n===null?null:n.getDisplay(i,e)}getAnimation(t){return t in this.animations?this.animations[t]:null}}class $l extends R{constructor(){super(...arguments),c(this,"inheritTranslation",!1),c(this,"inheritRotation",!1),c(this,"inheritScale",!1),c(this,"inheritReflection",!1),c(this,"type",mt.Bone),c(this,"length",0),c(this,"alpha",1),c(this,"name",""),c(this,"transform",new Y),c(this,"userData",null),c(this,"parent",null)}static toString(){return"[class dragonBones.BoneData]"}_onClear(){this.userData!==null&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=mt.Bone,this.length=0,this.alpha=1,this.name="",this.transform.identity(),this.userData=null,this.parent=null}}class Hu extends $l{constructor(){super(...arguments),c(this,"segmentX",0),c(this,"segmentY",0),c(this,"geometry",new Ea)}static toString(){return"[class dragonBones.SurfaceData]"}_onClear(){super._onClear(),this.type=mt.Surface,this.segmentX=0,this.segmentY=0,this.geometry.clear()}}class pi extends R{constructor(){super(...arguments),c(this,"blendMode",st.Normal),c(this,"displayIndex",0),c(this,"zOrder",0),c(this,"zIndex",0),c(this,"alpha",1),c(this,"name",""),c(this,"color",null),c(this,"userData",null),c(this,"parent",null)}static createColor(){return new bi}static toString(){return"[class dragonBones.SlotData]"}_onClear(){this.userData!==null&&this.userData.returnToPool(),this.blendMode=st.Normal,this.displayIndex=0,this.zOrder=0,this.zIndex=0,this.alpha=1,this.name="",this.color=null,this.userData=null,this.parent=null}}c(pi,"DEFAULT_COLOR",new bi);class Sa extends R{constructor(){super(...arguments),c(this,"type"),c(this,"color",0),c(this,"width",0),c(this,"height",0)}_onClear(){this.color=0,this.width=0,this.height=0}}class se extends Sa{static toString(){return"[class dragonBones.RectangleBoundingBoxData]"}static _computeOutCode(t,i,e,n,a,s){let o=0;return t<e?o|=1:t>a&&(o|=2),i<n?o|=4:i>s&&(o|=8),o}static rectangleIntersectsSegment(t,i,e,n,a,s,o,l,h=null,u=null,f=null){const d=t>a&&t<o&&i>s&&i<l,p=e>a&&e<o&&n>s&&n<l;if(d&&p)return-1;let _=0,m=se._computeOutCode(t,i,a,s,o,l),g=se._computeOutCode(e,n,a,s,o,l);for(;;){if(m|g){if(m&g)break}else{_=2;break}let y=0,w=0,T=0;const x=m!==0?m:g;x&4?(y=t+(e-t)*(s-i)/(n-i),w=s,f!==null&&(T=-Math.PI*.5)):x&8?(y=t+(e-t)*(l-i)/(n-i),w=l,f!==null&&(T=Math.PI*.5)):x&2?(w=i+(n-i)*(o-t)/(e-t),y=o,f!==null&&(T=0)):x&1&&(w=i+(n-i)*(a-t)/(e-t),y=a,f!==null&&(T=Math.PI)),x===m?(t=y,i=w,m=se._computeOutCode(t,i,a,s,o,l),f!==null&&(f.x=T)):(e=y,n=w,g=se._computeOutCode(e,n,a,s,o,l),f!==null&&(f.y=T))}return _&&(d?(_=2,h!==null&&(h.x=e,h.y=n),u!==null&&(u.x=e,u.y=e),f!==null&&(f.x=f.y+Math.PI)):p?(_=1,h!==null&&(h.x=t,h.y=i),u!==null&&(u.x=t,u.y=i),f!==null&&(f.y=f.x+Math.PI)):(_=3,h!==null&&(h.x=t,h.y=i),u!==null&&(u.x=e,u.y=n))),_}_onClear(){super._onClear(),this.type=yt.Rectangle}containsPoint(t,i){if(this.width===void 0||this.height===void 0)throw new Error;const e=this.width*.5;if(t>=-e&&t<=e){const n=this.height*.5;if(i>=-n&&i<=n)return!0}return!1}intersectsSegment(t,i,e,n,a=null,s=null,o=null){if(this.width===void 0||this.height===void 0)throw new Error;const l=this.width*.5,h=this.height*.5;return se.rectangleIntersectsSegment(t,i,e,n,-l,-h,l,h,a,s,o)}}class Da extends Sa{static toString(){return"[class dragonBones.EllipseData]"}static ellipseIntersectsSegment(t,i,e,n,a,s,o,l,h=null,u=null,f=null){const d=o/l,p=d*d;i*=d,n*=d;const _=e-t,m=n-i,g=Math.sqrt(_*_+m*m),y=_/g,w=m/g,T=(a-t)*y+(s-i)*w,x=T*T,E=t*t+i*i,b=o*o,D=b-E+x;let S=0;if(D>=0){const M=Math.sqrt(D),O=T-M,F=T+M,L=O<0?-1:O<=g?0:1,B=F<0?-1:F<=g?0:1,I=L*B;if(I<0)return-1;I===0&&(L===-1?(S=2,e=t+F*y,n=(i+F*w)/d,h!==null&&(h.x=e,h.y=n),u!==null&&(u.x=e,u.y=n),f!==null&&(f.x=Math.atan2(n/b*p,e/b),f.y=f.x+Math.PI)):B===1?(S=1,t=t+O*y,i=(i+O*w)/d,h!==null&&(h.x=t,h.y=i),u!==null&&(u.x=t,u.y=i),f!==null&&(f.x=Math.atan2(i/b*p,t/b),f.y=f.x+Math.PI)):(S=3,h!==null&&(h.x=t+O*y,h.y=(i+O*w)/d,f!==null&&(f.x=Math.atan2(h.y/b*p,h.x/b))),u!==null&&(u.x=t+F*y,u.y=(i+F*w)/d,f!==null&&(f.y=Math.atan2(u.y/b*p,u.x/b)))))}return S}_onClear(){super._onClear(),this.type=yt.Ellipse}containsPoint(t,i){if(this.width===void 0||this.height===void 0)throw new Error;const e=this.width*.5;if(t>=-e&&t<=e){const n=this.height*.5;if(i>=-n&&i<=n)return i*=e/n,Math.sqrt(t*t+i*i)<=e}return!1}intersectsSegment(t,i,e,n,a=null,s=null,o=null){if(this.width===void 0||this.height===void 0)throw new Error;return Da.ellipseIntersectsSegment(t,i,e,n,0,0,this.width*.5,this.height*.5,a,s,o)}}class Aa extends Sa{constructor(){super(...arguments),c(this,"x",0),c(this,"y",0),c(this,"vertices",[])}static toString(){return"[class dragonBones.PolygonBoundingBoxData]"}static polygonIntersectsSegment(t,i,e,n,a,s=null,o=null,l=null){t===e&&(t=e+1e-6),i===n&&(i=n+1e-6);const h=a.length,u=t-e,f=i-n,d=t*n-i*e;let p=0,_=a[h-2],m=a[h-1],g=0,y=0,w=0,T=0,x=0,E=0;for(let b=0;b<h;b+=2){const D=a[b],S=a[b+1];_===D&&(_=D+1e-4),m===S&&(m=S+1e-4);const M=_-D,O=m-S,F=_*S-m*D,L=u*O-f*M,B=(d*M-u*F)/L;if((B>=_&&B<=D||B>=D&&B<=_)&&(u===0||B>=t&&B<=e||B>=e&&B<=t)){const I=(d*O-f*F)/L;if((I>=m&&I<=S||I>=S&&I<=m)&&(f===0||I>=i&&I<=n||I>=n&&I<=i))if(o!==null){let U=B-t;U<0&&(U=-U),p===0?(g=U,y=U,w=B,T=I,x=B,E=I,l!==null&&(l.x=Math.atan2(S-m,D-_)-Math.PI*.5,l.y=l.x)):(U<g&&(g=U,w=B,T=I,l!==null&&(l.x=Math.atan2(S-m,D-_)-Math.PI*.5)),U>y&&(y=U,x=B,E=I,l!==null&&(l.y=Math.atan2(S-m,D-_)-Math.PI*.5))),p++}else{w=B,T=I,x=B,E=I,p++,l!==null&&(l.x=Math.atan2(S-m,D-_)-Math.PI*.5,l.y=l.x);break}}_=D,m=S}return p===1?(s!==null&&(s.x=w,s.y=T),o!==null&&(o.x=w,o.y=T),l!==null&&(l.y=l.x+Math.PI)):p>1&&(p++,s!==null&&(s.x=w,s.y=T),o!==null&&(o.x=x,o.y=E)),p}_onClear(){super._onClear(),this.type=yt.Polygon,this.x=0,this.y=0,this.vertices.length=0}containsPoint(t,i){if(this.x===void 0||this.y===void 0)throw new Error("");if(this.width===void 0||this.height===void 0)throw new Error;let e=!1;if(t>=this.x&&t<=this.width&&i>=this.y&&i<=this.height)for(let n=0,a=this.vertices.length,s=a-2;n<a;n+=2){const o=this.vertices[s+1],l=this.vertices[n+1];if(l<i&&o>=i||o<i&&l>=i){const h=this.vertices[s],u=this.vertices[n];(i-l)*(h-u)/(o-l)+u<t&&(e=!e)}s=n}return e}intersectsSegment(t,i,e,n,a=null,s=null,o=null){if(this.x===void 0||this.y===void 0)throw new Error("");if(this.width===void 0||this.height===void 0)throw new Error;let l=0;return se.rectangleIntersectsSegment(t,i,e,n,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)!==0&&(l=Aa.polygonIntersectsSegment(t,i,e,n,this.vertices,a,s,o)),l}}class Yu extends R{constructor(){super(...arguments),c(this,"hasBackground",!1),c(this,"color",0),c(this,"x",0),c(this,"y",0),c(this,"width",0),c(this,"height",0)}static toString(){return"[class dragonBones.CanvasData]"}_onClear(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0}}class Gl extends R{constructor(){super(...arguments),c(this,"order",0),c(this,"name",""),c(this,"type",Se.IK),c(this,"target",null),c(this,"root",null),c(this,"bone",null)}_onClear(){this.order=0,this.name="",this.type=Se.IK,this.target=null,this.root=null,this.bone=null}}class zu extends Gl{constructor(){super(...arguments),c(this,"scaleEnabled",!1),c(this,"bendPositive",!1),c(this,"weight",1)}static toString(){return"[class dragonBones.IKConstraintData]"}_onClear(){super._onClear(),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1}}class qu extends Gl{constructor(){super(...arguments),c(this,"pathSlot",null),c(this,"pathDisplayData",null),c(this,"bones",[]),c(this,"positionMode",Ee.Fixed),c(this,"spacingMode",Zt.Fixed),c(this,"rotateMode",Xt.Chain),c(this,"position",0),c(this,"spacing",0),c(this,"rotateOffset",0),c(this,"rotateMix",0),c(this,"translateMix",0)}static toString(){return"[class dragonBones.PathConstraintData]"}_onClear(){super._onClear(),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=Ee.Fixed,this.spacingMode=Zt.Fixed,this.rotateMode=Xt.Chain,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0}AddBone(t){this.bones.push(t)}}class Ku extends R{constructor(){super(...arguments),c(this,"autoSearch",!1),c(this,"frameRate",0),c(this,"version",""),c(this,"name",""),c(this,"stage",null),c(this,"frameIndices",[]),c(this,"cachedFrames",[]),c(this,"armatureNames",[]),c(this,"armatures",{}),c(this,"binary",null),c(this,"intArray",null),c(this,"floatArray",null),c(this,"frameIntArray",null),c(this,"frameFloatArray",null),c(this,"frameArray",null),c(this,"timelineArray",null),c(this,"colorArray",null),c(this,"userData",null)}static toString(){return"[class dragonBones.DragonBonesData]"}_onClear(){for(let t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];this.userData!==null&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.colorArray=null,this.userData=null}addArmature(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.armatures){console.warn("Same armature: "+t.name);return}t.parent=this,this.armatures[t.name]=t,this.armatureNames.push(t.name)}getArmature(t){return t in this.armatures?this.armatures[t]:null}}class Zu extends R{constructor(){super(...arguments),c(this,"name",""),c(this,"displays",{}),c(this,"parent",null)}static toString(){return"[class dragonBones.SkinData]"}_onClear(){for(let t in this.displays){const i=this.displays[t];for(const e of i)e!==null&&e.returnToPool();delete this.displays[t]}this.name="",this.parent=null}addDisplay(t,i){t in this.displays||(this.displays[t]=[]),i!==null&&(i.parent=this),this.displays[t].push(i)}getDisplay(t,i){const e=this.getDisplays(t);if(e!==null){for(const n of e)if(n!==null&&n.name===i)return n}return null}getDisplays(t){return t in this.displays?this.displays[t]:null}}class Qu extends R{constructor(){super(...arguments),c(this,"autoSearch",!1),c(this,"width",0),c(this,"height",0),c(this,"scale",1),c(this,"name",""),c(this,"imagePath",""),c(this,"textures",{})}_onClear(){for(let t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""}copyFrom(t){this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath;for(let i in this.textures)this.textures[i].returnToPool(),delete this.textures[i];for(let i in t.textures){const e=this.createTexture();e.copyFrom(t.textures[i]),this.textures[i]=e}}addTexture(t){if(t.name===void 0)throw new Error("value.name is undefined.");if(t.name in this.textures){console.warn("Same texture: "+t.name);return}t.parent=this,this.textures[t.name]=t}getTexture(t){return t in this.textures?this.textures[t]:null}}class Ei extends R{constructor(){super(...arguments),c(this,"rotated",!1),c(this,"name",""),c(this,"region",new ha),c(this,"parent",null),c(this,"frame",null)}static createRectangle(){return new ha}_onClear(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null}copyFrom(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,this.frame===null&&t.frame!==null?this.frame=Ei.createRectangle():this.frame!==null&&t.frame===null&&(this.frame=null),this.frame!==null&&t.frame!==null&&this.frame.copyFrom(t.frame)}}class _n extends R{constructor(){super(...arguments),c(this,"ints",[]),c(this,"floats",[]),c(this,"strings",[])}static toString(){return"[class dragonBones.UserData]"}_onClear(){this.ints.length=0,this.floats.length=0,this.strings.length=0}addInt(t){this.ints.push(t)}addFloat(t){this.floats.push(t)}addString(t){this.strings.push(t)}getInt(t=0){return t>=0&&t<this.ints.length?this.ints[t]:0}getFloat(t=0){return t>=0&&t<this.floats.length?this.floats[t]:0}getString(t=0){return t>=0&&t<this.strings.length?this.strings[t]:""}}class co extends R{constructor(){super(...arguments),c(this,"type",lt.Play),c(this,"name",""),c(this,"bone",null),c(this,"slot",null),c(this,"data",null)}static toString(){return"[class dragonBones.ActionData]"}_onClear(){this.data!==null&&this.data.returnToPool(),this.type=lt.Play,this.name="",this.bone=null,this.slot=null,this.data=null}}const A=class extends v{constructor(){super(...arguments),c(this,"_rawTextureAtlasIndex",0),c(this,"_rawBones",[]),c(this,"_data",null),c(this,"_armature",null),c(this,"_bone",null),c(this,"_geometry",null),c(this,"_slot",null),c(this,"_skin",null),c(this,"_mesh",null),c(this,"_animation",null),c(this,"_timeline",null),c(this,"_rawTextureAtlases",null),c(this,"_frameValueType",0),c(this,"_defaultColorOffset",-1),c(this,"_prevClockwise",0),c(this,"_prevRotation",0),c(this,"_frameDefaultValue",0),c(this,"_frameValueScale",1),c(this,"_helpMatrixA",new Ne),c(this,"_helpMatrixB",new Ne),c(this,"_helpTransform",new Y),c(this,"_helpColorTransform",new bi),c(this,"_helpPoint",new wi),c(this,"_helpArray",[]),c(this,"_intArray",[]),c(this,"_floatArray",[]),c(this,"_frameIntArray",[]),c(this,"_frameFloatArray",[]),c(this,"_frameArray",[]),c(this,"_timelineArray",[]),c(this,"_colorArray",[]),c(this,"_cacheRawMeshes",[]),c(this,"_cacheMeshes",[]),c(this,"_actionFrames",[]),c(this,"_weightSlotPose",{}),c(this,"_weightBonePoses",{}),c(this,"_cacheBones",{}),c(this,"_slotChildActions",{})}static _getBoolean(r,t,i){if(t in r){const e=r[t],n=typeof e;if(n==="boolean")return e;if(n==="string")switch(e){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}else return!!e}return i}static _getNumber(r,t,i){if(t in r){const e=r[t];return e===null||e==="NaN"?i:+e||0}return i}static _getString(r,t,i){if(t in r){const e=r[t];return typeof e=="string"?e:String(e)}return i}_getCurvePoint(r,t,i,e,n,a,s,o,l,h){const u=1-l,f=u*u,d=l*l,p=u*f,_=3*l*f,m=3*u*d,g=l*d;h.x=p*r+_*i+m*n+g*s,h.y=p*t+_*e+m*a+g*o}_samplingEasingCurve(r,t){const i=r.length;if(i%3===1){let e=-2;for(let n=0,a=t.length;n<a;++n){let s=(n+1)/(a+1);for(;(e+6<i?r[e+6]:1)<s;)e+=6;const o=e>=0&&e+6<i,l=o?r[e]:0,h=o?r[e+1]:0,u=r[e+2],f=r[e+3],d=r[e+4],p=r[e+5],_=o?r[e+6]:1,m=o?r[e+7]:1;let g=0,y=1;for(;y-g>1e-4;){const w=(y+g)*.5;this._getCurvePoint(l,h,u,f,d,p,_,m,w,this._helpPoint),s-this._helpPoint.x>0?g=w:y=w}t[n]=this._helpPoint.y}return!0}else{let e=0;for(let n=0,a=t.length;n<a;++n){let s=(n+1)/(a+1);for(;r[e+6]<s;)e+=6;const o=r[e],l=r[e+1],h=r[e+2],u=r[e+3],f=r[e+4],d=r[e+5],p=r[e+6],_=r[e+7];let m=0,g=1;for(;g-m>1e-4;){const y=(g+m)*.5;this._getCurvePoint(o,l,h,u,f,d,p,_,y,this._helpPoint),s-this._helpPoint.x>0?m=y:g=y}t[n]=this._helpPoint.y}return!1}}_parseActionDataInFrame(r,t,i,e){v.EVENT in r&&this._mergeActionFrame(r[v.EVENT],t,lt.Frame,i,e),v.SOUND in r&&this._mergeActionFrame(r[v.SOUND],t,lt.Sound,i,e),v.ACTION in r&&this._mergeActionFrame(r[v.ACTION],t,lt.Play,i,e),v.EVENTS in r&&this._mergeActionFrame(r[v.EVENTS],t,lt.Frame,i,e),v.ACTIONS in r&&this._mergeActionFrame(r[v.ACTIONS],t,lt.Play,i,e)}_mergeActionFrame(r,t,i,e,n){const a=this._armature.actions.length,s=this._parseActionData(r,i,e,n);let o=0,l=null;for(const h of s)this._armature.addAction(h,!1);this._actionFrames.length===0&&(l=new pn,l.frameStart=0,this._actionFrames.push(l),l=null);for(const h of this._actionFrames){if(h.frameStart===t){l=h;break}else if(h.frameStart>t)break;o++}l===null&&(l=new pn,l.frameStart=t,this._actionFrames.splice(o,0,l));for(let h=0;h<s.length;++h)l.actions.push(a+h)}_parseArmature(r,t){const i=R.borrowObject(Wu);if(i.name=A._getString(r,v.NAME,""),i.frameRate=A._getNumber(r,v.FRAME_RATE,this._data.frameRate),i.scale=t,v.TYPE in r&&typeof r[v.TYPE]=="string"?i.type=v._getArmatureType(r[v.TYPE]):i.type=A._getNumber(r,v.TYPE,oe.Armature),i.frameRate===0&&(i.frameRate=24),this._armature=i,v.CANVAS in r){const e=r[v.CANVAS],n=R.borrowObject(Yu);v.COLOR in e?n.hasBackground=!0:n.hasBackground=!1,n.color=A._getNumber(e,v.COLOR,0),n.x=A._getNumber(e,v.X,0)*i.scale,n.y=A._getNumber(e,v.Y,0)*i.scale,n.width=A._getNumber(e,v.WIDTH,0)*i.scale,n.height=A._getNumber(e,v.HEIGHT,0)*i.scale,i.canvas=n}if(v.AABB in r){const e=r[v.AABB];i.aabb.x=A._getNumber(e,v.X,0)*i.scale,i.aabb.y=A._getNumber(e,v.Y,0)*i.scale,i.aabb.width=A._getNumber(e,v.WIDTH,0)*i.scale,i.aabb.height=A._getNumber(e,v.HEIGHT,0)*i.scale}if(v.BONE in r){const e=r[v.BONE];for(const n of e){const a=A._getString(n,v.PARENT,""),s=this._parseBone(n);if(a.length>0){const o=i.getBone(a);o!==null?s.parent=o:(a in this._cacheBones||(this._cacheBones[a]=[]),this._cacheBones[a].push(s))}if(s.name in this._cacheBones){for(const o of this._cacheBones[s.name])o.parent=s;delete this._cacheBones[s.name]}i.addBone(s),this._rawBones.push(s)}}if(v.IK in r){const e=r[v.IK];for(const n of e){const a=this._parseIKConstraint(n);a&&i.addConstraint(a)}}if(i.sortBones(),v.SLOT in r){let e=0;const n=r[v.SLOT];for(const a of n)i.addSlot(this._parseSlot(a,e++))}if(v.SKIN in r){const e=r[v.SKIN];for(const n of e)i.addSkin(this._parseSkin(n))}if(v.PATH_CONSTRAINT in r){const e=r[v.PATH_CONSTRAINT];for(const n of e){const a=this._parsePathConstraint(n);a&&i.addConstraint(a)}}for(let e=0,n=this._cacheRawMeshes.length;e<n;++e){const a=this._cacheRawMeshes[e],s=A._getString(a,v.SHARE,"");if(s.length===0)continue;let o=A._getString(a,v.SKIN,v.DEFAULT_NAME);o.length===0&&(o=v.DEFAULT_NAME);const l=i.getMesh(o,"",s);l!==null&&this._cacheMeshes[e].geometry.shareFrom(l.geometry)}if(v.ANIMATION in r){const e=r[v.ANIMATION];for(const n of e){const a=this._parseAnimation(n);i.addAnimation(a)}}if(v.DEFAULT_ACTIONS in r){const e=this._parseActionData(r[v.DEFAULT_ACTIONS],lt.Play,null,null);for(const n of e)if(i.addAction(n,!0),n.type===lt.Play){const a=i.getAnimation(n.name);a!==null&&(i.defaultAnimation=a)}}if(v.ACTIONS in r){const e=this._parseActionData(r[v.ACTIONS],lt.Play,null,null);for(const n of e)i.addAction(n,!1)}this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null;for(let e in this._weightSlotPose)delete this._weightSlotPose[e];for(let e in this._weightBonePoses)delete this._weightBonePoses[e];for(let e in this._cacheBones)delete this._cacheBones[e];for(let e in this._slotChildActions)delete this._slotChildActions[e];return i}_parseBone(r){let t=mt.Bone;if(v.TYPE in r&&typeof r[v.TYPE]=="string"?t=v._getBoneType(r[v.TYPE]):t=A._getNumber(r,v.TYPE,mt.Bone),t===mt.Bone){const e=this._armature.scale,n=R.borrowObject($l);return n.inheritTranslation=A._getBoolean(r,v.INHERIT_TRANSLATION,!0),n.inheritRotation=A._getBoolean(r,v.INHERIT_ROTATION,!0),n.inheritScale=A._getBoolean(r,v.INHERIT_SCALE,!0),n.inheritReflection=A._getBoolean(r,v.INHERIT_REFLECTION,!0),n.length=A._getNumber(r,v.LENGTH,0)*e,n.alpha=A._getNumber(r,v.ALPHA,1),n.name=A._getString(r,v.NAME,""),v.TRANSFORM in r&&this._parseTransform(r[v.TRANSFORM],n.transform,e),n}const i=R.borrowObject(Hu);return i.alpha=A._getNumber(r,v.ALPHA,1),i.name=A._getString(r,v.NAME,""),i.segmentX=A._getNumber(r,v.SEGMENT_X,0),i.segmentY=A._getNumber(r,v.SEGMENT_Y,0),this._parseGeometry(r,i.geometry),i}_parseIKConstraint(r){const t=this._armature.getBone(A._getString(r,v.BONE,""));if(t===null)return null;const i=this._armature.getBone(A._getString(r,v.TARGET,""));if(i===null)return null;const e=A._getNumber(r,v.CHAIN,0),n=R.borrowObject(zu);return n.scaleEnabled=A._getBoolean(r,v.SCALE,!1),n.bendPositive=A._getBoolean(r,v.BEND_POSITIVE,!0),n.weight=A._getNumber(r,v.WEIGHT,1),n.name=A._getString(r,v.NAME,""),n.type=Se.IK,n.target=i,e>0&&t.parent!==null?(n.root=t.parent,n.bone=t):(n.root=t,n.bone=null),n}_parsePathConstraint(r){const t=this._armature.getSlot(A._getString(r,v.TARGET,""));if(t===null)return null;const i=this._armature.defaultSkin;if(i===null)return null;const e=i.getDisplay(t.name,A._getString(r,v.TARGET_DISPLAY,t.name));if(e===null||!(e instanceof fo))return null;const n=r[v.BONES];if(n===null||n.length===0)return null;const a=R.borrowObject(qu);a.name=A._getString(r,v.NAME,""),a.type=Se.Path,a.pathSlot=t,a.pathDisplayData=e,a.target=t.parent,a.positionMode=v._getPositionMode(A._getString(r,v.POSITION_MODE,"")),a.spacingMode=v._getSpacingMode(A._getString(r,v.SPACING_MODE,"")),a.rotateMode=v._getRotateMode(A._getString(r,v.ROTATE_MODE,"")),a.position=A._getNumber(r,v.POSITION,0),a.spacing=A._getNumber(r,v.SPACING,0),a.rotateOffset=A._getNumber(r,v.ROTATE_OFFSET,0),a.rotateMix=A._getNumber(r,v.ROTATE_MIX,1),a.translateMix=A._getNumber(r,v.TRANSLATE_MIX,1);for(var s of n){const o=this._armature.getBone(s);o!==null&&(a.AddBone(o),a.root===null&&(a.root=o))}return a}_parseSlot(r,t){const i=R.borrowObject(pi);return i.displayIndex=A._getNumber(r,v.DISPLAY_INDEX,0),i.zOrder=t,i.zIndex=A._getNumber(r,v.Z_INDEX,0),i.alpha=A._getNumber(r,v.ALPHA,1),i.name=A._getString(r,v.NAME,""),i.parent=this._armature.getBone(A._getString(r,v.PARENT,"")),v.BLEND_MODE in r&&typeof r[v.BLEND_MODE]=="string"?i.blendMode=v._getBlendMode(r[v.BLEND_MODE]):i.blendMode=A._getNumber(r,v.BLEND_MODE,st.Normal),v.COLOR in r?(i.color=pi.createColor(),this._parseColorTransform(r[v.COLOR],i.color)):i.color=pi.DEFAULT_COLOR,v.ACTIONS in r&&(this._slotChildActions[i.name]=this._parseActionData(r[v.ACTIONS],lt.Play,null,null)),i}_parseSkin(r){const t=R.borrowObject(Zu);if(t.name=A._getString(r,v.NAME,v.DEFAULT_NAME),t.name.length===0&&(t.name=v.DEFAULT_NAME),v.SLOT in r){const i=r[v.SLOT];this._skin=t;for(const e of i){const n=A._getString(e,v.NAME,""),a=this._armature.getSlot(n);if(a!==null){if(this._slot=a,v.DISPLAY in e){const s=e[v.DISPLAY];for(const o of s)o?t.addDisplay(n,this._parseDisplay(o)):t.addDisplay(n,null)}this._slot=null}}this._skin=null}return t}_parseDisplay(r){const t=A._getString(r,v.NAME,""),i=A._getString(r,v.PATH,"");let e=Q.Image,n=null;switch(v.TYPE in r&&typeof r[v.TYPE]=="string"?e=v._getDisplayType(r[v.TYPE]):e=A._getNumber(r,v.TYPE,e),e){case Q.Image:{const a=n=R.borrowObject(Xu);a.name=t,a.path=i.length>0?i:t,this._parsePivot(r,a);break}case Q.Armature:{const a=n=R.borrowObject($u);if(a.name=t,a.path=i.length>0?i:t,a.inheritAnimation=!0,v.ACTIONS in r){const s=this._parseActionData(r[v.ACTIONS],lt.Play,null,null);for(const o of s)a.addAction(o)}else if(this._slot.name in this._slotChildActions){const s=this._skin.getDisplays(this._slot.name);if(s===null?this._slot.displayIndex===0:this._slot.displayIndex===s.length){for(const o of this._slotChildActions[this._slot.name])a.addAction(o);delete this._slotChildActions[this._slot.name]}}break}case Q.Mesh:{const a=n=R.borrowObject(Vu);a.geometry.inheritDeform=A._getBoolean(r,v.INHERIT_DEFORM,!0),a.name=t,a.path=i.length>0?i:t,v.SHARE in r?(a.geometry.data=this._data,this._cacheRawMeshes.push(r),this._cacheMeshes.push(a)):this._parseMesh(r,a);break}case Q.BoundingBox:{const a=this._parseBoundingBox(r);if(a!==null){const s=n=R.borrowObject(Gu);s.name=t,s.path=i.length>0?i:t,s.boundingBox=a}break}case Q.Path:{const a=r[v.LENGTHS],s=n=R.borrowObject(fo);s.closed=A._getBoolean(r,v.CLOSED,!1),s.constantSpeed=A._getBoolean(r,v.CONSTANT_SPEED,!1),s.name=t,s.path=i.length>0?i:t,s.curveLengths.length=a.length;for(let o=0,l=a.length;o<l;++o)s.curveLengths[o]=a[o];this._parsePath(r,s);break}}return n!==null&&v.TRANSFORM in r&&this._parseTransform(r[v.TRANSFORM],n.transform,this._armature.scale),n}_parsePath(r,t){this._parseGeometry(r,t.geometry)}_parsePivot(r,t){if(v.PIVOT in r){const i=r[v.PIVOT];t.pivot.x=A._getNumber(i,v.X,0),t.pivot.y=A._getNumber(i,v.Y,0)}else t.pivot.x=.5,t.pivot.y=.5}_parseMesh(r,t){if(this._parseGeometry(r,t.geometry),v.WEIGHTS in r){const i=r[v.SLOT_POSE],e=r[v.BONE_POSE],n=this._skin.name+"_"+this._slot.name+"_"+t.name;this._weightSlotPose[n]=i,this._weightBonePoses[n]=e}}_parseBoundingBox(r){let t=null,i=yt.Rectangle;switch(v.SUB_TYPE in r&&typeof r[v.SUB_TYPE]=="string"?i=v._getBoundingBoxType(r[v.SUB_TYPE]):i=A._getNumber(r,v.SUB_TYPE,i),i){case yt.Rectangle:t=R.borrowObject(se);break;case yt.Ellipse:t=R.borrowObject(Da);break;case yt.Polygon:t=this._parsePolygonBoundingBox(r);break}return t!==null&&(t.color=A._getNumber(r,v.COLOR,0),(t.type===yt.Rectangle||t.type===yt.Ellipse)&&(t.width=A._getNumber(r,v.WIDTH,0),t.height=A._getNumber(r,v.HEIGHT,0))),t}_parsePolygonBoundingBox(r){const t=R.borrowObject(Aa);if(v.VERTICES in r){const i=this._armature.scale,e=r[v.VERTICES],n=t.vertices;n.length=e.length;for(let a=0,s=e.length;a<s;a+=2){const o=e[a]*i,l=e[a+1]*i;n[a]=o,n[a+1]=l,a===0?(t.x=o,t.y=l,t.width=o,t.height=l):(o<t.x?t.x=o:o>t.width&&(t.width=o),l<t.y?t.y=l:l>t.height&&(t.height=l))}t.width-=t.x,t.height-=t.y}else console.warn(`Data error.
 Please reexport DragonBones Data to fixed the bug.`);return t}_parseAnimation(r){const t=R.borrowObject(Nl);if(t.blendType=v._getAnimationBlendType(A._getString(r,v.BLEND_TYPE,"")),t.frameCount=A._getNumber(r,v.DURATION,0),t.playTimes=A._getNumber(r,v.PLAY_TIMES,1),t.duration=t.frameCount/this._armature.frameRate,t.fadeInTime=A._getNumber(r,v.FADE_IN_TIME,0),t.scale=A._getNumber(r,v.SCALE,1),t.name=A._getString(r,v.NAME,v.DEFAULT_NAME),t.name.length===0&&(t.name=v.DEFAULT_NAME),t.frameIntOffset=this._frameIntArray.length,t.frameFloatOffset=this._frameFloatArray.length,t.frameOffset=this._frameArray.length,this._animation=t,v.FRAME in r){const i=r[v.FRAME],e=i.length;if(e>0)for(let n=0,a=0;n<e;++n){const s=i[n];this._parseActionDataInFrame(s,a,null,null),a+=A._getNumber(s,v.DURATION,1)}}if(v.Z_ORDER in r&&(this._animation.zOrderTimeline=this._parseTimeline(r[v.Z_ORDER],null,v.FRAME,C.ZOrder,0,0,this._parseZOrderFrame)),v.BONE in r){const i=r[v.BONE];for(const e of i)this._parseBoneTimeline(e)}if(v.SLOT in r){const i=r[v.SLOT];for(const e of i)this._parseSlotTimeline(e)}if(v.FFD in r){const i=r[v.FFD];for(const e of i){let n=A._getString(e,v.SKIN,v.DEFAULT_NAME);const a=A._getString(e,v.SLOT,""),s=A._getString(e,v.NAME,"");if(n.length===0&&(n=v.DEFAULT_NAME),this._slot=this._armature.getSlot(a),this._mesh=this._armature.getMesh(n,a,s),this._slot===null||this._mesh===null)continue;const o=this._parseTimeline(e,null,v.FRAME,C.SlotDeform,2,0,this._parseSlotDeformFrame);o!==null&&this._animation.addSlotTimeline(a,o),this._slot=null,this._mesh=null}}if(v.IK in r){const i=r[v.IK];for(const e of i){const n=A._getString(e,v.NAME,"");if(this._armature.getConstraint(n)===null)continue;const a=this._parseTimeline(e,null,v.FRAME,C.IKConstraint,1,2,this._parseIKConstraintFrame);a!==null&&this._animation.addConstraintTimeline(n,a)}}if(this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",C.Action,0,0,this._parseActionFrame),this._actionFrames.length=0),v.TIMELINE in r){const i=r[v.TIMELINE];for(const e of i){const n=A._getNumber(e,v.TYPE,C.Action),a=A._getString(e,v.NAME,"");let s=null;switch(n){case C.Action:break;case C.SlotDisplay:case C.SlotZIndex:case C.BoneAlpha:case C.SlotAlpha:case C.AnimationProgress:case C.AnimationWeight:if(n===C.SlotDisplay?(this._frameValueType=0,this._frameValueScale=1):(this._frameValueType=1,n===C.SlotZIndex?this._frameValueScale=1:n===C.AnimationProgress||n===C.AnimationWeight?this._frameValueScale=1e4:this._frameValueScale=100),n===C.BoneAlpha||n===C.SlotAlpha||n===C.AnimationWeight?this._frameDefaultValue=1:this._frameDefaultValue=0,n===C.AnimationProgress&&t.blendType!==Ft.None){s=R.borrowObject(kl);const o=s;o.x=A._getNumber(e,v.X,0),o.y=A._getNumber(e,v.Y,0)}s=this._parseTimeline(e,null,v.FRAME,n,this._frameValueType,1,this._parseSingleValueFrame,s);break;case C.BoneTranslate:case C.BoneRotate:case C.BoneScale:case C.IKConstraint:case C.AnimationParameter:n===C.IKConstraint||n===C.AnimationParameter?(this._frameValueType=1,n===C.AnimationParameter?this._frameValueScale=1e4:this._frameValueScale=100):(n===C.BoneRotate?this._frameValueScale=Y.DEG_RAD:this._frameValueScale=1,this._frameValueType=2),n===C.BoneScale||n===C.IKConstraint?this._frameDefaultValue=1:this._frameDefaultValue=0,s=this._parseTimeline(e,null,v.FRAME,n,this._frameValueType,2,this._parseDoubleValueFrame);break;case C.ZOrder:break;case C.Surface:{const o=this._armature.getBone(a);if(o===null)continue;this._geometry=o.geometry,s=this._parseTimeline(e,null,v.FRAME,n,2,0,this._parseDeformFrame),this._geometry=null;break}case C.SlotDeform:{this._geometry=null;for(const o in this._armature.skins){const l=this._armature.skins[o];for(const h in l.displays){const u=l.displays[h];for(const f of u)if(f!==null&&f.name===a){this._geometry=f.geometry;break}}}if(this._geometry===null)continue;s=this._parseTimeline(e,null,v.FRAME,n,2,0,this._parseDeformFrame),this._geometry=null;break}case C.SlotColor:s=this._parseTimeline(e,null,v.FRAME,n,1,1,this._parseSlotColorFrame);break}if(s!==null)switch(n){case C.Action:break;case C.ZOrder:break;case C.BoneTranslate:case C.BoneRotate:case C.BoneScale:case C.Surface:case C.BoneAlpha:this._animation.addBoneTimeline(a,s);break;case C.SlotDisplay:case C.SlotColor:case C.SlotDeform:case C.SlotZIndex:case C.SlotAlpha:this._animation.addSlotTimeline(a,s);break;case C.IKConstraint:this._animation.addConstraintTimeline(a,s);break;case C.AnimationProgress:case C.AnimationWeight:case C.AnimationParameter:this._animation.addAnimationTimeline(a,s);break}}}return this._animation=null,t}_parseTimeline(r,t,i,e,n,a,s,o=null){if(r!==null&&i.length>0&&i in r&&(t=r[i]),t===null)return null;const l=t.length;if(l===0)return null;const h=this._frameIntArray.length,u=this._frameFloatArray.length,f=this._timelineArray.length;switch(o===null&&(o=R.borrowObject(ba)),o.type=e,o.offset=f,this._frameValueType=n,this._timeline=o,this._timelineArray.length+=1+1+1+1+1+l,r!==null?(this._timelineArray[f+P.TimelineScale]=Math.round(A._getNumber(r,v.SCALE,1)*100),this._timelineArray[f+P.TimelineOffset]=Math.round(A._getNumber(r,v.OFFSET,0)*100)):(this._timelineArray[f+P.TimelineScale]=100,this._timelineArray[f+P.TimelineOffset]=0),this._timelineArray[f+P.TimelineKeyFrameCount]=l,this._timelineArray[f+P.TimelineFrameValueCount]=a,this._frameValueType){case 0:this._timelineArray[f+P.TimelineFrameValueOffset]=0;break;case 1:this._timelineArray[f+P.TimelineFrameValueOffset]=h-this._animation.frameIntOffset;break;case 2:this._timelineArray[f+P.TimelineFrameValueOffset]=u-this._animation.frameFloatOffset;break}if(l===1)o.frameIndicesOffset=-1,this._timelineArray[f+P.TimelineFrameOffset+0]=s.call(this,t[0],0,0)-this._animation.frameOffset;else{const d=this._animation.frameCount+1,p=this._data.frameIndices,_=p.length;p.length+=d,o.frameIndicesOffset=_;for(let m=0,g=0,y=0,w=0;m<d;++m){if(y+w<=m&&g<l){const T=t[g];y=m,g===l-1?w=this._animation.frameCount-y:T instanceof pn?w=this._actionFrames[g+1].frameStart-y:w=A._getNumber(T,v.DURATION,1),this._timelineArray[f+P.TimelineFrameOffset+g]=s.call(this,T,y,w)-this._animation.frameOffset,g++}p[_+m]=g-1}}return this._timeline=null,o}_parseBoneTimeline(r){const t=this._armature.getBone(A._getString(r,v.NAME,""));if(t!==null){if(this._bone=t,this._slot=this._armature.getSlot(this._bone.name),v.TRANSLATE_FRAME in r){this._frameDefaultValue=0,this._frameValueScale=1;const i=this._parseTimeline(r,null,v.TRANSLATE_FRAME,C.BoneTranslate,2,2,this._parseDoubleValueFrame);i!==null&&this._animation.addBoneTimeline(t.name,i)}if(v.ROTATE_FRAME in r){this._frameDefaultValue=0,this._frameValueScale=1;const i=this._parseTimeline(r,null,v.ROTATE_FRAME,C.BoneRotate,2,2,this._parseBoneRotateFrame);i!==null&&this._animation.addBoneTimeline(t.name,i)}if(v.SCALE_FRAME in r){this._frameDefaultValue=1,this._frameValueScale=1;const i=this._parseTimeline(r,null,v.SCALE_FRAME,C.BoneScale,2,2,this._parseBoneScaleFrame);i!==null&&this._animation.addBoneTimeline(t.name,i)}if(v.FRAME in r){const i=this._parseTimeline(r,null,v.FRAME,C.BoneAll,2,6,this._parseBoneAllFrame);i!==null&&this._animation.addBoneTimeline(t.name,i)}this._bone=null,this._slot=null}}_parseSlotTimeline(r){const t=this._armature.getSlot(A._getString(r,v.NAME,""));if(t===null)return;let i=null,e=null;this._slot=t,v.DISPLAY_FRAME in r?i=this._parseTimeline(r,null,v.DISPLAY_FRAME,C.SlotDisplay,0,0,this._parseSlotDisplayFrame):i=this._parseTimeline(r,null,v.FRAME,C.SlotDisplay,0,0,this._parseSlotDisplayFrame),v.COLOR_FRAME in r?e=this._parseTimeline(r,null,v.COLOR_FRAME,C.SlotColor,1,1,this._parseSlotColorFrame):e=this._parseTimeline(r,null,v.FRAME,C.SlotColor,1,1,this._parseSlotColorFrame),i!==null&&this._animation.addSlotTimeline(t.name,i),e!==null&&this._animation.addSlotTimeline(t.name,e),this._slot=null}_parseFrame(r,t,i){const e=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[e+P.FramePosition]=t,e}_parseTweenFrame(r,t,i){const e=this._parseFrame(r,t,i);if(i>0)if(v.CURVE in r){const n=i+1;this._helpArray.length=n;const a=this._samplingEasingCurve(r[v.CURVE],this._helpArray);this._frameArray.length+=1+1+this._helpArray.length,this._frameArray[e+P.FrameTweenType]=ut.Curve,this._frameArray[e+P.FrameTweenEasingOrCurveSampleCount]=a?n:-n;for(let s=0;s<n;++s)this._frameArray[e+P.FrameCurveSamples+s]=Math.round(this._helpArray[s]*1e4)}else{let n=-2;v.TWEEN_EASING in r&&(n=A._getNumber(r,v.TWEEN_EASING,-2)),n===-2?(this._frameArray.length+=1,this._frameArray[e+P.FrameTweenType]=ut.None):n===0?(this._frameArray.length+=1,this._frameArray[e+P.FrameTweenType]=ut.Line):n<0?(this._frameArray.length+=1+1,this._frameArray[e+P.FrameTweenType]=ut.QuadIn,this._frameArray[e+P.FrameTweenEasingOrCurveSampleCount]=Math.round(-n*100)):n<=1?(this._frameArray.length+=1+1,this._frameArray[e+P.FrameTweenType]=ut.QuadOut,this._frameArray[e+P.FrameTweenEasingOrCurveSampleCount]=Math.round(n*100)):(this._frameArray.length+=1+1,this._frameArray[e+P.FrameTweenType]=ut.QuadInOut,this._frameArray[e+P.FrameTweenEasingOrCurveSampleCount]=Math.round(n*100-100))}else this._frameArray.length+=1,this._frameArray[e+P.FrameTweenType]=ut.None;return e}_parseSingleValueFrame(r,t,i){let e=0;switch(this._frameValueType){case 0:{e=this._parseFrame(r,t,i),this._frameArray.length+=1,this._frameArray[e+1]=A._getNumber(r,v.VALUE,this._frameDefaultValue);break}case 1:{e=this._parseTweenFrame(r,t,i);const n=this._frameIntArray.length;this._frameIntArray.length+=1,this._frameIntArray[n]=Math.round(A._getNumber(r,v.VALUE,this._frameDefaultValue)*this._frameValueScale);break}case 2:{e=this._parseTweenFrame(r,t,i);const n=this._frameFloatArray.length;this._frameFloatArray.length+=1,this._frameFloatArray[n]=A._getNumber(r,v.VALUE,this._frameDefaultValue)*this._frameValueScale;break}}return e}_parseDoubleValueFrame(r,t,i){let e=0;switch(this._frameValueType){case 0:{e=this._parseFrame(r,t,i),this._frameArray.length+=2,this._frameArray[e+1]=A._getNumber(r,v.X,this._frameDefaultValue),this._frameArray[e+2]=A._getNumber(r,v.Y,this._frameDefaultValue);break}case 1:{e=this._parseTweenFrame(r,t,i);const n=this._frameIntArray.length;this._frameIntArray.length+=2,this._frameIntArray[n]=Math.round(A._getNumber(r,v.X,this._frameDefaultValue)*this._frameValueScale),this._frameIntArray[n+1]=Math.round(A._getNumber(r,v.Y,this._frameDefaultValue)*this._frameValueScale);break}case 2:{e=this._parseTweenFrame(r,t,i);const n=this._frameFloatArray.length;this._frameFloatArray.length+=2,this._frameFloatArray[n]=A._getNumber(r,v.X,this._frameDefaultValue)*this._frameValueScale,this._frameFloatArray[n+1]=A._getNumber(r,v.Y,this._frameDefaultValue)*this._frameValueScale;break}}return e}_parseActionFrame(r,t,i){const e=this._frameArray.length,n=r.actions.length;this._frameArray.length+=1+1+n,this._frameArray[e+P.FramePosition]=t,this._frameArray[e+P.FramePosition+1]=n;for(let a=0;a<n;++a)this._frameArray[e+P.FramePosition+2+a]=r.actions[a];return e}_parseZOrderFrame(r,t,i){const e=this._parseFrame(r,t,i);if(v.Z_ORDER in r){const n=r[v.Z_ORDER];if(n.length>0){const a=this._armature.sortedSlots.length,s=new Array(a-n.length/2),o=new Array(a);for(let f=0;f<s.length;++f)s[f]=0;for(let f=0;f<a;++f)o[f]=-1;let l=0,h=0;for(let f=0,d=n.length;f<d;f+=2){const p=n[f],_=n[f+1];for(;l!==p;)s[h++]=l++;const m=l+_;o[m]=l++}for(;l<a;)s[h++]=l++;this._frameArray.length+=1+a,this._frameArray[e+1]=a;let u=a;for(;u--;)o[u]===-1?this._frameArray[e+2+u]=s[--h]||0:this._frameArray[e+2+u]=o[u]||0;return e}}return this._frameArray.length+=1,this._frameArray[e+1]=0,e}_parseBoneAllFrame(r,t,i){this._helpTransform.identity(),v.TRANSFORM in r&&this._parseTransform(r[v.TRANSFORM],this._helpTransform,1);let e=this._helpTransform.rotation;t!==0&&(this._prevClockwise===0?e=this._prevRotation+Y.normalizeRadian(e-this._prevRotation):((this._prevClockwise>0?e>=this._prevRotation:e<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),e=this._prevRotation+e-this._prevRotation+Y.PI_D*this._prevClockwise)),this._prevClockwise=A._getNumber(r,v.TWEEN_ROTATE,0),this._prevRotation=e;const n=this._parseTweenFrame(r,t,i);let a=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[a++]=this._helpTransform.x,this._frameFloatArray[a++]=this._helpTransform.y,this._frameFloatArray[a++]=e,this._frameFloatArray[a++]=this._helpTransform.skew,this._frameFloatArray[a++]=this._helpTransform.scaleX,this._frameFloatArray[a++]=this._helpTransform.scaleY,this._parseActionDataInFrame(r,t,this._bone,this._slot),n}_parseBoneTranslateFrame(r,t,i){const e=this._parseTweenFrame(r,t,i);let n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=A._getNumber(r,v.X,0),this._frameFloatArray[n++]=A._getNumber(r,v.Y,0),e}_parseBoneRotateFrame(r,t,i){let e=A._getNumber(r,v.ROTATE,0)*Y.DEG_RAD;t!==0&&(this._prevClockwise===0?e=this._prevRotation+Y.normalizeRadian(e-this._prevRotation):((this._prevClockwise>0?e>=this._prevRotation:e<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),e=this._prevRotation+e-this._prevRotation+Y.PI_D*this._prevClockwise)),this._prevClockwise=A._getNumber(r,v.CLOCK_WISE,0),this._prevRotation=e;const n=this._parseTweenFrame(r,t,i);let a=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[a++]=e,this._frameFloatArray[a++]=A._getNumber(r,v.SKEW,0)*Y.DEG_RAD,n}_parseBoneScaleFrame(r,t,i){const e=this._parseTweenFrame(r,t,i);let n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=A._getNumber(r,v.X,1),this._frameFloatArray[n++]=A._getNumber(r,v.Y,1),e}_parseSlotDisplayFrame(r,t,i){const e=this._parseFrame(r,t,i);return this._frameArray.length+=1,v.VALUE in r?this._frameArray[e+1]=A._getNumber(r,v.VALUE,0):this._frameArray[e+1]=A._getNumber(r,v.DISPLAY_INDEX,0),this._parseActionDataInFrame(r,t,this._slot.parent,this._slot),e}_parseSlotColorFrame(r,t,i){const e=this._parseTweenFrame(r,t,i);let n=-1;if(v.VALUE in r||v.COLOR in r){const s=v.VALUE in r?r[v.VALUE]:r[v.COLOR];for(let o in s){this._parseColorTransform(s,this._helpColorTransform),n=this._colorArray.length,this._colorArray.length+=8,this._colorArray[n++]=Math.round(this._helpColorTransform.alphaMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.redMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.greenMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.blueMultiplier*100),this._colorArray[n++]=Math.round(this._helpColorTransform.alphaOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.redOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.greenOffset),this._colorArray[n++]=Math.round(this._helpColorTransform.blueOffset),n-=8;break}}n<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=n=this._colorArray.length,this._colorArray.length+=8,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=100,this._colorArray[n++]=0,this._colorArray[n++]=0,this._colorArray[n++]=0,this._colorArray[n++]=0),n=this._defaultColorOffset);const a=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[a]=n,e}_parseSlotDeformFrame(r,t,i){const e=this._frameFloatArray.length,n=this._parseTweenFrame(r,t,i),a=v.VERTICES in r?r[v.VERTICES]:null,s=A._getNumber(r,v.OFFSET,0),o=this._intArray[this._mesh.geometry.offset+P.GeometryVertexCount];if(this._mesh.parent===null)throw new Error("this._mesh.parent is null.");const l=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,h=this._mesh.geometry.weight;let u=0,f=0,d=0,p=0;if(h!==null){const _=this._weightSlotPose[l];this._helpMatrixA.copyFromArray(_,0),this._frameFloatArray.length+=h.count*2,d=h.offset+P.WeigthBoneIndices+h.bones.length}else this._frameFloatArray.length+=o*2;for(let _=0;_<o*2;_+=2)if(a===null?(u=0,f=0):(_<s||_-s>=a.length?u=0:u=a[_-s],_+1<s||_+1-s>=a.length?f=0:f=a[_+1-s]),h!==null){const m=this._weightBonePoses[l],g=this._intArray[d++];this._helpMatrixA.transformPoint(u,f,this._helpPoint,!0),u=this._helpPoint.x,f=this._helpPoint.y;for(let y=0;y<g;++y){const w=this._intArray[d++];this._helpMatrixB.copyFromArray(m,w*7+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(u,f,this._helpPoint,!0),this._frameFloatArray[e+p++]=this._helpPoint.x,this._frameFloatArray[e+p++]=this._helpPoint.y}}else this._frameFloatArray[e+_]=u,this._frameFloatArray[e+_+1]=f;if(t===0){const _=this._frameIntArray.length;this._frameIntArray.length+=1+1+1+1+1,this._frameIntArray[_+P.DeformVertexOffset]=this._mesh.geometry.offset,this._frameIntArray[_+P.DeformCount]=this._frameFloatArray.length-e,this._frameIntArray[_+P.DeformValueCount]=this._frameFloatArray.length-e,this._frameIntArray[_+P.DeformValueOffset]=0,this._frameIntArray[_+P.DeformFloatOffset]=e-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+P.TimelineFrameValueCount]=_-this._animation.frameIntOffset}return n}_parseIKConstraintFrame(r,t,i){const e=this._parseTweenFrame(r,t,i);let n=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[n++]=A._getBoolean(r,v.BEND_POSITIVE,!0)?1:0,this._frameIntArray[n++]=Math.round(A._getNumber(r,v.WEIGHT,1)*100),e}_parseActionData(r,t,i,e){const n=new Array;if(typeof r=="string"){const a=R.borrowObject(co);a.type=t,a.name=r,a.bone=i,a.slot=e,n.push(a)}else if(r instanceof Array)for(const a of r){const s=R.borrowObject(co);if(v.GOTO_AND_PLAY in a?(s.type=lt.Play,s.name=A._getString(a,v.GOTO_AND_PLAY,"")):(v.TYPE in a&&typeof a[v.TYPE]=="string"?s.type=v._getActionType(a[v.TYPE]):s.type=A._getNumber(a,v.TYPE,t),s.name=A._getString(a,v.NAME,"")),v.BONE in a){const l=A._getString(a,v.BONE,"");s.bone=this._armature.getBone(l)}else s.bone=i;if(v.SLOT in a){const l=A._getString(a,v.SLOT,"");s.slot=this._armature.getSlot(l)}else s.slot=e;let o=null;if(v.INTS in a){o===null&&(o=R.borrowObject(_n));const l=a[v.INTS];for(const h of l)o.addInt(h)}if(v.FLOATS in a){o===null&&(o=R.borrowObject(_n));const l=a[v.FLOATS];for(const h of l)o.addFloat(h)}if(v.STRINGS in a){o===null&&(o=R.borrowObject(_n));const l=a[v.STRINGS];for(const h of l)o.addString(h)}s.data=o,n.push(s)}return n}_parseDeformFrame(r,t,i){const e=this._frameFloatArray.length,n=this._parseTweenFrame(r,t,i),a=v.VERTICES in r?r[v.VERTICES]:v.VALUE in r?r[v.VALUE]:null,s=A._getNumber(r,v.OFFSET,0),o=this._intArray[this._geometry.offset+P.GeometryVertexCount],l=this._geometry.weight;let h=0,u=0;if(l===null){this._frameFloatArray.length+=o*2;for(let f=0;f<o*2;f+=2)a!==null?(f<s||f-s>=a.length?h=0:h=a[f-s],f+1<s||f+1-s>=a.length?u=0:u=a[f+1-s]):(h=0,u=0),this._frameFloatArray[e+f]=h,this._frameFloatArray[e+f+1]=u}if(t===0){const f=this._frameIntArray.length;this._frameIntArray.length+=1+1+1+1+1,this._frameIntArray[f+P.DeformVertexOffset]=this._geometry.offset,this._frameIntArray[f+P.DeformCount]=this._frameFloatArray.length-e,this._frameIntArray[f+P.DeformValueCount]=this._frameFloatArray.length-e,this._frameIntArray[f+P.DeformValueOffset]=0,this._frameIntArray[f+P.DeformFloatOffset]=e-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+P.TimelineFrameValueCount]=f-this._animation.frameIntOffset}return n}_parseTransform(r,t,i){t.x=A._getNumber(r,v.X,0)*i,t.y=A._getNumber(r,v.Y,0)*i,v.ROTATE in r||v.SKEW in r?(t.rotation=Y.normalizeRadian(A._getNumber(r,v.ROTATE,0)*Y.DEG_RAD),t.skew=Y.normalizeRadian(A._getNumber(r,v.SKEW,0)*Y.DEG_RAD)):(v.SKEW_X in r||v.SKEW_Y in r)&&(t.rotation=Y.normalizeRadian(A._getNumber(r,v.SKEW_Y,0)*Y.DEG_RAD),t.skew=Y.normalizeRadian(A._getNumber(r,v.SKEW_X,0)*Y.DEG_RAD)-t.rotation),t.scaleX=A._getNumber(r,v.SCALE_X,1),t.scaleY=A._getNumber(r,v.SCALE_Y,1)}_parseColorTransform(r,t){t.alphaMultiplier=A._getNumber(r,v.ALPHA_MULTIPLIER,100)*.01,t.redMultiplier=A._getNumber(r,v.RED_MULTIPLIER,100)*.01,t.greenMultiplier=A._getNumber(r,v.GREEN_MULTIPLIER,100)*.01,t.blueMultiplier=A._getNumber(r,v.BLUE_MULTIPLIER,100)*.01,t.alphaOffset=A._getNumber(r,v.ALPHA_OFFSET,0),t.redOffset=A._getNumber(r,v.RED_OFFSET,0),t.greenOffset=A._getNumber(r,v.GREEN_OFFSET,0),t.blueOffset=A._getNumber(r,v.BLUE_OFFSET,0)}_parseGeometry(r,t){const i=r[v.VERTICES],e=Math.floor(i.length/2);let n=0;const a=this._intArray.length,s=this._floatArray.length;t.offset=a,t.data=this._data,this._intArray.length+=1+1+1+1,this._intArray[a+P.GeometryVertexCount]=e,this._intArray[a+P.GeometryFloatOffset]=s,this._intArray[a+P.GeometryWeightOffset]=-1,this._floatArray.length+=e*2;for(let o=0,l=e*2;o<l;++o)this._floatArray[s+o]=i[o];if(v.TRIANGLES in r){const o=r[v.TRIANGLES];n=Math.floor(o.length/3),this._intArray.length+=n*3;for(let l=0,h=n*3;l<h;++l)this._intArray[a+P.GeometryVertexIndices+l]=o[l]}if(this._intArray[a+P.GeometryTriangleCount]=n,v.UVS in r){const o=r[v.UVS],l=s+e*2;this._floatArray.length+=e*2;for(let h=0,u=e*2;h<u;++h)this._floatArray[l+h]=o[h]}if(v.WEIGHTS in r){const o=r[v.WEIGHTS],l=Math.floor(o.length-e)/2,h=this._intArray.length,u=this._floatArray.length;let f=0;const d=this._armature.sortedBones,p=R.borrowObject(Ul);if(p.count=l,p.offset=h,this._intArray.length+=1+1+f+e+l,this._intArray[h+P.WeigthFloatOffset]=u,v.BONE_POSE in r){const _=r[v.SLOT_POSE],m=r[v.BONE_POSE],g=new Array;f=Math.floor(m.length/7),g.length=f;for(let y=0;y<f;++y){const w=m[y*7],T=this._rawBones[w];p.addBone(T),g[y]=w,this._intArray[h+P.WeigthBoneIndices+y]=d.indexOf(T)}this._floatArray.length+=l*3,this._helpMatrixA.copyFromArray(_,0);for(let y=0,w=0,T=h+P.WeigthBoneIndices+f,x=u;y<e;++y){const E=y*2,b=this._intArray[T++]=o[w++];let D=this._floatArray[s+E],S=this._floatArray[s+E+1];this._helpMatrixA.transformPoint(D,S,this._helpPoint),D=this._helpPoint.x,S=this._helpPoint.y;for(let M=0;M<b;++M){const O=o[w++],F=g.indexOf(O);this._helpMatrixB.copyFromArray(m,F*7+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(D,S,this._helpPoint),this._intArray[T++]=F,this._floatArray[x++]=o[w++],this._floatArray[x++]=this._helpPoint.x,this._floatArray[x++]=this._helpPoint.y}}}else{const _=r[v.BONES];f=_.length;for(let m=0;m<f;m++){const g=_[m],y=this._rawBones[g];p.addBone(y),this._intArray[h+P.WeigthBoneIndices+m]=d.indexOf(y)}this._floatArray.length+=l*3;for(let m=0,g=0,y=0,w=h+P.WeigthBoneIndices+f,T=u;m<l;m++){const x=o[g++];this._intArray[w++]=x;for(let E=0;E<x;E++){const b=o[g++],D=o[g++],S=i[y++],M=i[y++];this._intArray[w++]=_.indexOf(b),this._floatArray[T++]=D,this._floatArray[T++]=S,this._floatArray[T++]=M}}}t.weight=p}}_parseArray(r){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0,this._colorArray.length=0}_modifyArray(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!==0&&this._timelineArray.push(0),this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._colorArray.push(0);const r=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,t=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,i=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,e=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,n=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,a=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,s=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT,o=r+t+i+e+n+a+s,l=new ArrayBuffer(o),h=new Int16Array(l,0,this._intArray.length),u=new Float32Array(l,r,this._floatArray.length),f=new Int16Array(l,r+t,this._frameIntArray.length),d=new Float32Array(l,r+t+i,this._frameFloatArray.length),p=new Int16Array(l,r+t+i+e,this._frameArray.length),_=new Uint16Array(l,r+t+i+e+n,this._timelineArray.length),m=new Int16Array(l,r+t+i+e+n+a,this._colorArray.length);for(let g=0,y=this._intArray.length;g<y;++g)h[g]=this._intArray[g];for(let g=0,y=this._floatArray.length;g<y;++g)u[g]=this._floatArray[g];for(let g=0,y=this._frameIntArray.length;g<y;++g)f[g]=this._frameIntArray[g];for(let g=0,y=this._frameFloatArray.length;g<y;++g)d[g]=this._frameFloatArray[g];for(let g=0,y=this._frameArray.length;g<y;++g)p[g]=this._frameArray[g];for(let g=0,y=this._timelineArray.length;g<y;++g)_[g]=this._timelineArray[g];for(let g=0,y=this._colorArray.length;g<y;++g)m[g]=this._colorArray[g];this._data.binary=l,this._data.intArray=h,this._data.floatArray=u,this._data.frameIntArray=f,this._data.frameFloatArray=d,this._data.frameArray=p,this._data.timelineArray=_,this._data.colorArray=m,this._defaultColorOffset=-1}parseDragonBonesData(r,t=1){console.assert(r!=null,"Data error.");const i=A._getString(r,v.VERSION,""),e=A._getString(r,v.COMPATIBLE_VERSION,"");if(v.DATA_VERSIONS.indexOf(i)>=0||v.DATA_VERSIONS.indexOf(e)>=0){const n=R.borrowObject(Ku);if(n.version=i,n.name=A._getString(r,v.NAME,""),n.frameRate=A._getNumber(r,v.FRAME_RATE,24),n.frameRate===0&&(n.frameRate=24),v.ARMATURE in r){this._data=n,this._parseArray(r);const a=r[v.ARMATURE];for(const s of a)n.addArmature(this._parseArmature(s,t));this._data.binary||this._modifyArray(),v.STAGE in r?n.stage=n.getArmature(A._getString(r,v.STAGE,"")):n.armatureNames.length>0&&(n.stage=n.getArmature(n.armatureNames[0])),this._data=null}return v.TEXTURE_ATLAS in r&&(this._rawTextureAtlases=r[v.TEXTURE_ATLAS]),n}else console.assert(!1,"Nonsupport data version: "+i+`
Please convert DragonBones data to support version.
Read more: https://github.com/DragonBones/Tools/`);return null}parseTextureAtlasData(r,t,i=1){if(console.assert(r!==void 0),r===null){if(this._rawTextureAtlases===null||this._rawTextureAtlases.length===0)return!1;const e=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(e,t,i),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(t.width=A._getNumber(r,v.WIDTH,0),t.height=A._getNumber(r,v.HEIGHT,0),t.scale=i===1?1/A._getNumber(r,v.SCALE,1):i,t.name=A._getString(r,v.NAME,""),t.imagePath=A._getString(r,v.IMAGE_PATH,""),v.SUB_TEXTURE in r){const e=r[v.SUB_TEXTURE];for(let n=0,a=e.length;n<a;++n){const s=e[n],o=A._getNumber(s,v.FRAME_WIDTH,-1),l=A._getNumber(s,v.FRAME_HEIGHT,-1),h=t.createTexture();h.rotated=A._getBoolean(s,v.ROTATED,!1),h.name=A._getString(s,v.NAME,""),h.region.x=A._getNumber(s,v.X,0),h.region.y=A._getNumber(s,v.Y,0),h.region.width=A._getNumber(s,v.WIDTH,0),h.region.height=A._getNumber(s,v.HEIGHT,0),o>0&&l>0&&(h.frame=Ei.createRectangle(),h.frame.x=A._getNumber(s,v.FRAME_X,0),h.frame.y=A._getNumber(s,v.FRAME_Y,0),h.frame.width=o,h.frame.height=l),t.addTexture(h)}}return!0}static getInstance(){return A._objectDataParserInstance===null&&(A._objectDataParserInstance=new A),A._objectDataParserInstance}};let St=A;c(St,"_objectDataParserInstance",null);class pn{constructor(){c(this,"frameStart",0),c(this,"actions",[])}}const sr=class extends St{constructor(){super(...arguments),c(this,"_binaryOffset"),c(this,"_binary"),c(this,"_intArrayBuffer"),c(this,"_frameArrayBuffer"),c(this,"_timelineArrayBuffer")}_inRange(r,t,i){return t<=r&&r<=i}_decodeUTF8(r){let t=0,i="",e,n=0,a=0,s=0,o=0;for(;r.length>t;){let l=r[t++];if(l===-1)a!==0?e=65533:e=-1;else if(a===0)this._inRange(l,0,127)?e=l:(this._inRange(l,194,223)?(a=1,o=128,n=l-192):this._inRange(l,224,239)?(a=2,o=2048,n=l-224):this._inRange(l,240,244)&&(a=3,o=65536,n=l-240),n=n*Math.pow(64,a),e=null);else if(!this._inRange(l,128,191))n=0,a=0,s=0,o=0,t--,e=l;else if(s+=1,n=n+(l-128)*Math.pow(64,a-s),s!==a)e=null;else{let h=n,u=o;n=0,a=0,s=0,o=0,this._inRange(h,u,1114111)&&!this._inRange(h,55296,57343)?e=h:e=l}e!==null&&e!==-1&&(e<=65535?e>0&&(i+=String.fromCharCode(e)):(e-=65536,i+=String.fromCharCode(55296+(e>>10&1023)),i+=String.fromCharCode(56320+(e&1023))))}return i}_parseBinaryTimeline(r,t,i=null){const e=i!==null?i:R.borrowObject(ba);if(e.type=r,e.offset=t,this._timeline=e,this._timelineArrayBuffer===void 0)throw new Error("this._timelineArrayBuffer is undefined.");if(this._frameArrayBuffer===void 0)throw new Error("this._frameArrayBuffer is undefined.");const n=this._timelineArrayBuffer[e.offset+P.TimelineKeyFrameCount];if(n===1)e.frameIndicesOffset=-1;else{let a=0;const s=this._animation.frameCount+1,o=this._data.frameIndices;a=o.length,o.length+=s,e.frameIndicesOffset=a;for(let l=0,h=0,u=0,f=0;l<s;++l)u+f<=l&&h<n&&(u=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[e.offset+P.TimelineFrameOffset+h]],h===n-1?f=this._animation.frameCount-u:f=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[e.offset+P.TimelineFrameOffset+h+1]]-u,h++),o[a+l]=h-1}return this._timeline=null,e}_parseAnimation(r){const t=R.borrowObject(Nl);t.blendType=v._getAnimationBlendType(St._getString(r,v.BLEND_TYPE,"")),t.frameCount=St._getNumber(r,v.DURATION,0),t.playTimes=St._getNumber(r,v.PLAY_TIMES,1),t.duration=t.frameCount/this._armature.frameRate,t.fadeInTime=St._getNumber(r,v.FADE_IN_TIME,0),t.scale=St._getNumber(r,v.SCALE,1),t.name=St._getString(r,v.NAME,v.DEFAULT_NAME),t.name.length===0&&(t.name=v.DEFAULT_NAME);const i=r[v.OFFSET];if(t.frameIntOffset=i[0],t.frameFloatOffset=i[1],t.frameOffset=i[2],this._animation=t,v.ACTION in r&&(t.actionTimeline=this._parseBinaryTimeline(C.Action,r[v.ACTION])),v.Z_ORDER in r&&(t.zOrderTimeline=this._parseBinaryTimeline(C.ZOrder,r[v.Z_ORDER])),v.BONE in r){const e=r[v.BONE];for(let n in e){const a=e[n],s=this._armature.getBone(n);if(s!==null)for(let o=0,l=a.length;o<l;o+=2){const h=a[o],u=a[o+1],f=this._parseBinaryTimeline(h,u);this._animation.addBoneTimeline(s.name,f)}}}if(v.SLOT in r){const e=r[v.SLOT];for(let n in e){const a=e[n],s=this._armature.getSlot(n);if(s!==null)for(let o=0,l=a.length;o<l;o+=2){const h=a[o],u=a[o+1],f=this._parseBinaryTimeline(h,u);this._animation.addSlotTimeline(s.name,f)}}}if(v.CONSTRAINT in r){const e=r[v.CONSTRAINT];for(let n in e){const a=e[n],s=this._armature.getConstraint(n);if(s!==null)for(let o=0,l=a.length;o<l;o+=2){const h=a[o],u=a[o+1],f=this._parseBinaryTimeline(h,u);this._animation.addConstraintTimeline(s.name,f)}}}if(v.TIMELINE in r){const e=r[v.TIMELINE];for(const n of e){const a=St._getNumber(n,v.OFFSET,0);if(a>=0){const s=St._getNumber(n,v.TYPE,C.Action),o=St._getString(n,v.NAME,"");let l=null;if(s===C.AnimationProgress&&t.blendType!==Ft.None){l=R.borrowObject(kl);const h=l;h.x=St._getNumber(n,v.X,0),h.y=St._getNumber(n,v.Y,0)}switch(l=this._parseBinaryTimeline(s,a,l),s){case C.Action:break;case C.ZOrder:break;case C.BoneTranslate:case C.BoneRotate:case C.BoneScale:case C.Surface:case C.BoneAlpha:this._animation.addBoneTimeline(o,l);break;case C.SlotDisplay:case C.SlotColor:case C.SlotDeform:case C.SlotZIndex:case C.SlotAlpha:this._animation.addSlotTimeline(o,l);break;case C.IKConstraint:this._animation.addConstraintTimeline(o,l);break;case C.AnimationProgress:case C.AnimationWeight:case C.AnimationParameter:this._animation.addAnimationTimeline(o,l);break}}}}return this._animation=null,t}_parseGeometry(r,t){if(t.offset=r[v.OFFSET],t.data=this._data,this._intArrayBuffer===void 0)throw new Error("this._intArrayBuffer is undefined.");let i=this._intArrayBuffer[t.offset+P.GeometryWeightOffset];if(i<-1&&(i+=65536),i>=0){const e=R.borrowObject(Ul),n=this._intArrayBuffer[t.offset+P.GeometryVertexCount],a=this._intArrayBuffer[i+P.WeigthBoneCount];e.offset=i;for(let l=0;l<a;++l){const h=this._intArrayBuffer[i+P.WeigthBoneIndices+l];e.addBone(this._rawBones[h])}let s=i+P.WeigthBoneIndices+a,o=0;for(let l=0,h=n;l<h;++l){const u=this._intArrayBuffer[s++];o+=u,s+=u}e.count=o,t.weight=e}}_parseArray(r){if(this._binary===void 0)throw new Error("this._binary is undefined.");if(this._binaryOffset===void 0)throw new Error("this._binaryOffset is undefined.");const t=r[v.OFFSET],i=t[1],e=t[3],n=t[5],a=t[7],s=t[9],o=t[11],l=t.length>12?t[13]:0,h=new Int16Array(this._binary,this._binaryOffset+t[0],i/Int16Array.BYTES_PER_ELEMENT),u=new Float32Array(this._binary,this._binaryOffset+t[2],e/Float32Array.BYTES_PER_ELEMENT),f=new Int16Array(this._binary,this._binaryOffset+t[4],n/Int16Array.BYTES_PER_ELEMENT),d=new Float32Array(this._binary,this._binaryOffset+t[6],a/Float32Array.BYTES_PER_ELEMENT),p=new Int16Array(this._binary,this._binaryOffset+t[8],s/Int16Array.BYTES_PER_ELEMENT),_=new Uint16Array(this._binary,this._binaryOffset+t[10],o/Uint16Array.BYTES_PER_ELEMENT),m=l>0?new Int16Array(this._binary,this._binaryOffset+t[12],l/Uint16Array.BYTES_PER_ELEMENT):h;this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=h,this._data.floatArray=u,this._data.frameIntArray=f,this._data.frameFloatArray=d,this._data.frameArray=this._frameArrayBuffer=p,this._data.timelineArray=this._timelineArrayBuffer=_,this._data.colorArray=m}parseDragonBonesData(r,t=1){console.assert(r!=null&&r instanceof ArrayBuffer,"Data error.");const i=new Uint8Array(r,0,8);if(i[0]!=="D".charCodeAt(0)||i[1]!=="B".charCodeAt(0)||i[2]!=="D".charCodeAt(0)||i[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;const e=new Uint32Array(r,8,1)[0],n=new Uint8Array(r,8+4,e),a=this._decodeUTF8(n),s=JSON.parse(a);return this._binaryOffset=8+4+e,this._binary=r,super.parseDragonBonesData(s,t)}static getInstance(){return sr._binaryDataParserInstance===null&&(sr._binaryDataParserInstance=new sr),sr._binaryDataParserInstance}};let Xl=sr;c(Xl,"_binaryDataParserInstance",null);const ye=class{constructor(r=null){c(this,"autoSearch",!1),c(this,"_dragonBonesDataMap",{}),c(this,"_textureAtlasDataMap",{}),c(this,"_dragonBones",null),c(this,"_dataParser",null),ye._objectParser===null&&(ye._objectParser=new St),ye._binaryParser===null&&(ye._binaryParser=new Xl),this._dataParser=r!==null?r:ye._objectParser}_isSupportMesh(){return!0}_getTextureData(r,t){if(r in this._textureAtlasDataMap)for(const i of this._textureAtlasDataMap[r]){const e=i.getTexture(t);if(e!==null)return e}if(this.autoSearch){for(let i in this._textureAtlasDataMap)for(const e of this._textureAtlasDataMap[i])if(e.autoSearch){const n=e.getTexture(t);if(n!==null)return n}}return null}_fillBuildArmaturePackage(r,t,i,e,n){let a=null,s=null;if(t.length>0&&t in this._dragonBonesDataMap&&(a=this._dragonBonesDataMap[t],s=a.getArmature(i)),s===null&&(t.length===0||this.autoSearch)){for(let o in this._dragonBonesDataMap)if(a=this._dragonBonesDataMap[o],(t.length===0||a.autoSearch)&&(s=a.getArmature(i),s!==null)){t=o;break}}if(s!==null){if(r.dataName=t,r.textureAtlasName=n,r.data=a,r.armature=s,r.skin=null,e.length>0&&(r.skin=s.getSkin(e),r.skin===null&&this.autoSearch))for(let o in this._dragonBonesDataMap){const l=this._dragonBonesDataMap[o].getArmature(e);if(l!==null){r.skin=l.defaultSkin;break}}return r.skin===null&&(r.skin=s.defaultSkin),!0}return!1}_buildBones(r,t){if(r.armature===null)throw new Error("dataPackage.armature is null.");for(const i of r.armature.sortedBones)R.borrowObject(i.type===mt.Bone?Ll:Et).init(i,t)}_buildSlots(r,t){if(r.armature===null)throw new Error("dataPackage.armature is null.");const i=r.skin,e=r.armature.defaultSkin;if(i===null||e===null)return;const n={};for(let a in e.displays){const s=e.getDisplays(a);n[a]=s}if(i!==e)for(let a in i.displays){const s=i.getDisplays(a);n[a]=s}for(const a of r.armature.sortedSlots){const s=a.name in n?n[a.name]:null,o=this._buildSlot(r,a,t);if(s!==null){o.displayFrameCount=s.length;for(let l=0,h=o.displayFrameCount;l<h;++l){const u=s[l];if(o.replaceRawDisplayData(u,l),u!==null){if(r.textureAtlasName.length>0){const d=this._getTextureData(r.textureAtlasName,u.path);o.replaceTextureData(d,l)}const f=this._getSlotDisplay(r,u,o);o.replaceDisplay(f,l)}else o.replaceDisplay(null)}}o._setDisplayIndex(a.displayIndex,!0)}}_buildConstraints(r,t){if(r.armature===null)throw new Error("dataPackage.armature is null.");const i=r.armature.constraints;for(let e in i){const n=i[e];switch(n.type){case Se.IK:const a=R.borrowObject(uo);a.init(n,t),t._addConstraint(a);break;case Se.Path:const s=R.borrowObject(ku);s.init(n,t),t._addConstraint(s);break;default:const o=R.borrowObject(uo);o.init(n,t),t._addConstraint(o);break}}}_buildChildArmature(r,t,i){return this.buildArmature(i.path,r!==null?r.dataName:"","",r!==null?r.textureAtlasName:"")}_getSlotDisplay(r,t,i){if(t.parent===null)throw new Error("displayData.parent is null.");if(t.parent.parent===null)throw new Error("displayData.parent.parent is null.");if(t.parent.parent.parent===null)throw new Error("displayData.parent.parent.parent is null.");const e=r!==null?r.dataName:t.parent.parent.parent.name;let n=null;switch(t.type){case Q.Image:{const a=t;a.texture===null&&(a.texture=this._getTextureData(e,t.path)),n=i.rawDisplay;break}case Q.Mesh:{const a=t;a.texture===null&&(a.texture=this._getTextureData(e,a.path)),this._isSupportMesh()?n=i.meshDisplay:n=i.rawDisplay;break}case Q.Armature:{const a=t,s=this._buildChildArmature(r,i,a);if(s!==null){if(s.inheritAnimation=a.inheritAnimation,!s.inheritAnimation){const o=a.actions.length>0?a.actions:s.armatureData.defaultActions;if(o.length>0)for(const l of o){const h=R.borrowObject(rt);rt.actionDataToInstance(l,h,i.armature),h.slot=i,i.armature._bufferAction(h,!1)}else s.animation.play()}a.armature=s.armatureData}n=s;break}case Q.BoundingBox:break}return n}parseDragonBonesData(r,t=null,i=1){const e=r instanceof ArrayBuffer?ye._binaryParser:this._dataParser;if(e===null)throw new Error("dataParser is null.");const n=e.parseDragonBonesData(r,i);for(;;){const a=this._buildTextureAtlasData(null,null);if(e.parseTextureAtlasData(null,a,i))this.addTextureAtlasData(a,t);else{a.returnToPool();break}}return n!==null&&this.addDragonBonesData(n,t),n}parseTextureAtlasData(r,t,i=null,e=1){const n=this._buildTextureAtlasData(null,null);if(this._dataParser===null)throw new Error(" this._dataParser is null.");return this._dataParser.parseTextureAtlasData(r,n,e),this._buildTextureAtlasData(n,t||null),this.addTextureAtlasData(n,i),n}updateTextureAtlases(r,t){const i=this.getTextureAtlasData(t);if(i!==null)for(let e=0,n=i.length;e<n;++e)e<r.length&&this._buildTextureAtlasData(i[e],r[e])}getDragonBonesData(r){return r in this._dragonBonesDataMap?this._dragonBonesDataMap[r]:null}addDragonBonesData(r,t=null){if(t=t!==null?t:r.name,t in this._dragonBonesDataMap){if(this._dragonBonesDataMap[t]===r)return;console.warn("Can not add same name data: "+t);return}this._dragonBonesDataMap[t]=r}removeDragonBonesData(r,t=!0){if(r in this._dragonBonesDataMap){if(t){if(this._dragonBones===null)throw new Error(" this._dragonBones is null.");this._dragonBones.bufferObject(this._dragonBonesDataMap[r])}delete this._dragonBonesDataMap[r]}}getTextureAtlasData(r){return r in this._textureAtlasDataMap?this._textureAtlasDataMap[r]:null}addTextureAtlasData(r,t=null){t=t!==null?t:r.name;const i=t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:this._textureAtlasDataMap[t]=[];i.indexOf(r)<0&&i.push(r)}removeTextureAtlasData(r,t=!0){if(r in this._textureAtlasDataMap){const i=this._textureAtlasDataMap[r];if(t)for(const e of i){if(this._dragonBones===null)throw new Error(" this._dragonBones is null.");this._dragonBones.bufferObject(e)}delete this._textureAtlasDataMap[r]}}getArmatureData(r,t=""){const i=new _o;return this._fillBuildArmaturePackage(i,t,r,"","")?i.armature:null}clear(r=!0){for(let t in this._dragonBonesDataMap){if(r){if(this._dragonBones===null)throw new Error(" this._dragonBones is null.");this._dragonBones.bufferObject(this._dragonBonesDataMap[t])}delete this._dragonBonesDataMap[t]}for(let t in this._textureAtlasDataMap){if(r){const i=this._textureAtlasDataMap[t];for(const e of i){if(this._dragonBones===null)throw new Error(" this._dragonBones is null.");this._dragonBones.bufferObject(e)}}delete this._textureAtlasDataMap[t]}}buildArmature(r,t="",i="",e=""){const n=new _o;if(!this._fillBuildArmaturePackage(n,t||"",r,i||"",e||""))return console.warn("No armature data: "+r+", "+(t!==null?t:"")),null;const a=this._buildArmature(n);return this._buildBones(n,a),this._buildSlots(n,a),this._buildConstraints(n,a),a.invalidUpdate(null,!0),a.advanceTime(0),a}replaceDisplay(r,t,i=-1){if(i<0&&(i=r.displayIndex),i<0&&(i=0),r.replaceDisplayData(t,i),t!==null){let e=this._getSlotDisplay(null,t,r);if(t.type===Q.Image){const n=r.getDisplayFrameAt(i).rawDisplayData;n!==null&&n.type===Q.Mesh&&(e=r.meshDisplay)}r.replaceDisplay(e,i)}else r.replaceDisplay(null,i)}replaceSlotDisplay(r,t,i,e,n,a=-1){const s=this.getArmatureData(t,r||"");if(s===null||s.defaultSkin===null)return!1;const o=s.defaultSkin.getDisplay(i,e);return this.replaceDisplay(n,o,a),!0}replaceSlotDisplayList(r,t,i,e){const n=this.getArmatureData(t,r||"");if(!n||!n.defaultSkin)return!1;const a=n.defaultSkin.getDisplays(i);if(!a)return!1;e.displayFrameCount=a.length;for(let s=0,o=e.displayFrameCount;s<o;++s){const l=a[s];this.replaceDisplay(e,l,s)}return!0}replaceSkin(r,t,i=!1,e=null){if(t.parent===null)throw new Error(" skin.parent is null.");let n=!1;const a=t.parent.defaultSkin;for(const s of r.getSlots()){if(e!==null&&e.indexOf(s.name)>=0)continue;let o=t.getDisplays(s.name);if(o===null&&(a!==null&&t!==a&&(o=a.getDisplays(s.name)),o===null)){i&&(s.displayFrameCount=0);continue}s.displayFrameCount=o.length;for(let l=0,h=s.displayFrameCount;l<h;++l){const u=o[l];s.replaceRawDisplayData(u,l),u!==null?s.replaceDisplay(this._getSlotDisplay(null,u,s),l):s.replaceDisplay(null,l)}n=!0}return n}replaceAnimation(r,t,i=!0){const e=t.defaultSkin;if(e===null)return!1;if(i)r.animation.animations=t.animations;else{const n=r.animation.animations,a={};for(let s in n)a[s]=n[s];for(let s in t.animations)a[s]=t.animations[s];r.animation.animations=a}for(const n of r.getSlots()){let a=0;for(const s of n.displayList){if(s instanceof le){const o=e.getDisplays(n.name);if(o!==null&&a<o.length){const l=o[a];if(l!==null&&l.type===Q.Armature){if(l.parent===null)throw new Error("displayData.parent is null.");if(l.parent.parent===null)throw new Error("displayData.parent.parent is null.");if(l.parent.parent.parent===null)throw new Error("displayData.parent.parent.parent is null.");const h=this.getArmatureData(l.path,l.parent.parent.parent.name);h&&this.replaceAnimation(s,h,i)}}}a++}}return!0}getAllDragonBonesData(){return this._dragonBonesDataMap}getAllTextureAtlasData(){return this._textureAtlasDataMap}get clock(){if(this._dragonBones===null)throw new Error("this._dragonBones is null.");return this._dragonBones.clock}get dragonBones(){if(this._dragonBones===null)throw new Error("this._dragonBones is null.");return this._dragonBones}};let ua=ye;c(ua,"_objectParser",null),c(ua,"_binaryParser",null);class _o{constructor(){c(this,"dataName",""),c(this,"textureAtlasName",""),c(this,"data",null),c(this,"armature",null),c(this,"skin",null)}}var Tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vl(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var i=function e(){if(this instanceof e){var n=[null];n.push.apply(n,arguments);var a=Function.bind.apply(t,n);return new a}return t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(r).forEach(function(e){var n=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(i,e,n.get?n:{enumerable:!0,get:function(){return r[e]}})}),i}var Z={},Ju={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var po=Object.getOwnPropertySymbols,ju=Object.prototype.hasOwnProperty,tf=Object.prototype.propertyIsEnumerable;function ef(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function rf(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var e=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(e.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(a){n[a]=a}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var nf=rf()?Object.assign:function(r,t){for(var i,e=ef(r),n,a=1;a<arguments.length;a++){i=Object(arguments[a]);for(var s in i)ju.call(i,s)&&(e[s]=i[s]);if(po){n=po(i);for(var o=0;o<n.length;o++)tf.call(i,n[o])&&(e[n[o]]=i[n[o]])}}return e},af=nf,sf=of(af);function of(r){return r&&r.__esModule?r:{default:r}}Object.assign||(Object.assign=sf.default);var lf=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(Tt.performance&&Tt.performance.now)){var hf=Date.now();Tt.performance||(Tt.performance={}),Tt.performance.now=function(){return Date.now()-hf}}var mn=Date.now(),mo=["ms","moz","webkit","o"];for(var gn=0;gn<mo.length&&!Tt.requestAnimationFrame;++gn){var vn=mo[gn];Tt.requestAnimationFrame=Tt[vn+"RequestAnimationFrame"],Tt.cancelAnimationFrame=Tt[vn+"CancelAnimationFrame"]||Tt[vn+"CancelRequestAnimationFrame"]}Tt.requestAnimationFrame||(Tt.requestAnimationFrame=function(r){if(typeof r!="function")throw new TypeError(r+"is not a function");var t=Date.now(),i=lf+mn-t;return i<0&&(i=0),mn=t,setTimeout(function(){mn=Date.now(),r(performance.now())},i)});Tt.cancelAnimationFrame||(Tt.cancelAnimationFrame=function(r){return clearTimeout(r)});Math.sign||(Math.sign=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1});Number.isInteger||(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t});window.ArrayBuffer||(window.ArrayBuffer=Array);window.Float32Array||(window.Float32Array=Array);window.Uint32Array||(window.Uint32Array=Array);window.Uint16Array||(window.Uint16Array=Array);var yn={},W={};W.__esModule=!0;W.VERSION="4.8.9";W.PI_2=Math.PI*2;W.RAD_TO_DEG=180/Math.PI;W.DEG_TO_RAD=Math.PI/180;W.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2};W.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19};W.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};W.SCALE_MODES={LINEAR:0,NEAREST:1};W.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2};W.GC_MODES={AUTO:0,MANUAL:1};W.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i;W.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;W.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;W.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};W.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};W.TRANSFORM_MODE={STATIC:0,DYNAMIC:1};W.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1};W.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50};var vt={},Sr={};Sr.__esModule=!0;function uf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ff=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;uf(this,r),this.x=t,this.y=i}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copy=function(i){this.set(i.x,i.y)},r.prototype.equals=function(i){return i.x===this.x&&i.y===this.y},r.prototype.set=function(i,e){this.x=i||0,this.y=e||(e!==0?this.x:0)},r}();Sr.default=ff;var Si={};Si.__esModule=!0;var cf=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}();function df(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var _f=function(){function r(t,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;df(this,r),this._x=e,this._y=n,this.cb=t,this.scope=i}return r.prototype.clone=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=i||this.cb,a=e||this.scope;return new r(n,a,this._x,this._y)},r.prototype.set=function(i,e){var n=i||0,a=e||(e!==0?n:0);(this._x!==n||this._y!==a)&&(this._x=n,this._y=a,this.cb.call(this.scope))},r.prototype.copy=function(i){(this._x!==i.x||this._y!==i.y)&&(this._x=i.x,this._y=i.y,this.cb.call(this.scope))},r.prototype.equals=function(i){return i.x===this._x&&i.y===this._y},cf(r,[{key:"x",get:function(){return this._x},set:function(i){this._x!==i&&(this._x=i,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(i){this._y!==i&&(this._y=i,this.cb.call(this.scope))}}]),r}();Si.default=_f;var Dr={};Dr.__esModule=!0;var pf=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),mf=Sr,go=vf(mf),gf=W;function vf(r){return r&&r.__esModule?r:{default:r}}function yf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Tf=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;yf(this,r),this.a=t,this.b=i,this.c=e,this.d=n,this.tx=a,this.ty=s,this.array=null}return r.prototype.fromArray=function(i){this.a=i[0],this.b=i[1],this.c=i[3],this.d=i[4],this.tx=i[2],this.ty=i[5]},r.prototype.set=function(i,e,n,a,s,o){return this.a=i,this.b=e,this.c=n,this.d=a,this.tx=s,this.ty=o,this},r.prototype.toArray=function(i,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return i?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},r.prototype.apply=function(i,e){e=e||new go.default;var n=i.x,a=i.y;return e.x=this.a*n+this.c*a+this.tx,e.y=this.b*n+this.d*a+this.ty,e},r.prototype.applyInverse=function(i,e){e=e||new go.default;var n=1/(this.a*this.d+this.c*-this.b),a=i.x,s=i.y;return e.x=this.d*n*a+-this.c*n*s+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*s+-this.b*n*a+(-this.ty*this.a+this.tx*this.b)*n,e},r.prototype.translate=function(i,e){return this.tx+=i,this.ty+=e,this},r.prototype.scale=function(i,e){return this.a*=i,this.d*=e,this.c*=i,this.b*=e,this.tx*=i,this.ty*=e,this},r.prototype.rotate=function(i){var e=Math.cos(i),n=Math.sin(i),a=this.a,s=this.c,o=this.tx;return this.a=a*e-this.b*n,this.b=a*n+this.b*e,this.c=s*e-this.d*n,this.d=s*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},r.prototype.append=function(i){var e=this.a,n=this.b,a=this.c,s=this.d;return this.a=i.a*e+i.b*a,this.b=i.a*n+i.b*s,this.c=i.c*e+i.d*a,this.d=i.c*n+i.d*s,this.tx=i.tx*e+i.ty*a+this.tx,this.ty=i.tx*n+i.ty*s+this.ty,this},r.prototype.setTransform=function(i,e,n,a,s,o,l,h,u){return this.a=Math.cos(l+u)*s,this.b=Math.sin(l+u)*s,this.c=-Math.sin(l-h)*o,this.d=Math.cos(l-h)*o,this.tx=i-(n*this.a+a*this.c),this.ty=e-(n*this.b+a*this.d),this},r.prototype.prepend=function(i){var e=this.tx;if(i.a!==1||i.b!==0||i.c!==0||i.d!==1){var n=this.a,a=this.c;this.a=n*i.a+this.b*i.c,this.b=n*i.b+this.b*i.d,this.c=a*i.a+this.d*i.c,this.d=a*i.b+this.d*i.d}return this.tx=e*i.a+this.ty*i.c+i.tx,this.ty=e*i.b+this.ty*i.d+i.ty,this},r.prototype.decompose=function(i){var e=this.a,n=this.b,a=this.c,s=this.d,o=-Math.atan2(-a,s),l=Math.atan2(n,e),h=Math.abs(o+l);return h<1e-5||Math.abs(gf.PI_2-h)<1e-5?(i.rotation=l,i.skew.x=i.skew.y=0):(i.rotation=0,i.skew.x=o,i.skew.y=l),i.scale.x=Math.sqrt(e*e+n*n),i.scale.y=Math.sqrt(a*a+s*s),i.position.x=this.tx,i.position.y=this.ty,i},r.prototype.invert=function(){var i=this.a,e=this.b,n=this.c,a=this.d,s=this.tx,o=i*a-e*n;return this.a=a/o,this.b=-e/o,this.c=-n/o,this.d=i/o,this.tx=(n*this.ty-a*s)/o,this.ty=-(i*this.ty-e*s)/o,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var i=new r;return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i},r.prototype.copy=function(i){return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i},pf(r,null,[{key:"IDENTITY",get:function(){return new r}},{key:"TEMP_MATRIX",get:function(){return new r}}]),r}();Dr.default=Tf;var Di={};Di.__esModule=!0;var xf=Dr,wf=bf(xf);function bf(r){return r&&r.__esModule?r:{default:r}}var Te=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],xe=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],we=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],be=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Wl=[],fa=[];function Yr(r){return r<0?-1:r>0?1:0}function Ef(){for(var r=0;r<16;r++){var t=[];fa.push(t);for(var i=0;i<16;i++)for(var e=Yr(Te[r]*Te[i]+we[r]*xe[i]),n=Yr(xe[r]*Te[i]+be[r]*xe[i]),a=Yr(Te[r]*we[i]+we[r]*be[i]),s=Yr(xe[r]*we[i]+be[r]*be[i]),o=0;o<16;o++)if(Te[o]===e&&xe[o]===n&&we[o]===a&&be[o]===s){t.push(o);break}}for(var l=0;l<16;l++){var h=new wf.default;h.set(Te[l],xe[l],we[l],be[l],0,0),Wl.push(h)}}Ef();var kt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return Te[t]},uY:function(t){return xe[t]},vX:function(t){return we[t]},vY:function(t){return be[t]},inv:function(t){return t&8?t&15:-t&7},add:function(t,i){return fa[t][i]},sub:function(t,i){return fa[t][kt.inv(i)]},rotate180:function(t){return t^4},isVertical:function(t){return(t&3)===2},byDirection:function(t,i){return Math.abs(t)*2<=Math.abs(i)?i>=0?kt.S:kt.N:Math.abs(i)*2<=Math.abs(t)?t>0?kt.E:kt.W:i>0?t>0?kt.SE:kt.SW:t>0?kt.NE:kt.NW},matrixAppendRotationInv:function(t,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=Wl[kt.inv(i)];a.tx=e,a.ty=n,t.append(a)}};Di.default=kt;var Ma={},Ar={};Ar.__esModule=!0;var Sf=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Df=W;function Af(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Mf=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;Af(this,r),this.x=Number(t),this.y=Number(i),this.width=Number(e),this.height=Number(n),this.type=Df.SHAPES.RECT}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copy=function(i){return this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height,this},r.prototype.contains=function(i,e){return this.width<=0||this.height<=0?!1:i>=this.x&&i<this.x+this.width&&e>=this.y&&e<this.y+this.height},r.prototype.pad=function(i,e){i=i||0,e=e||(e!==0?i:0),this.x-=i,this.y-=e,this.width+=i*2,this.height+=e*2},r.prototype.fit=function(i){var e=Math.max(this.x,i.x),n=Math.min(this.x+this.width,i.x+i.width),a=Math.max(this.y,i.y),s=Math.min(this.y+this.height,i.y+i.height);this.x=e,this.width=Math.max(n-e,0),this.y=a,this.height=Math.max(s-a,0)},r.prototype.enlarge=function(i){var e=Math.min(this.x,i.x),n=Math.max(this.x+this.width,i.x+i.width),a=Math.min(this.y,i.y),s=Math.max(this.y+this.height,i.y+i.height);this.x=e,this.width=n-e,this.y=a,this.height=s-a},r.prototype.ceil=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.001,n=Math.ceil((this.x+this.width-e)*i)/i,a=Math.ceil((this.y+this.height-e)*i)/i;this.x=Math.floor((this.x+e)*i)/i,this.y=Math.floor((this.y+e)*i)/i,this.width=n-this.x,this.height=a-this.y},Sf(r,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new r(0,0,0,0)}}]),r}();Ar.default=Mf;Ma.__esModule=!0;var Of=Ar,Pf=If(Of),Rf=W;function If(r){return r&&r.__esModule?r:{default:r}}function Cf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Ff=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Cf(this,r),this.x=t,this.y=i,this.radius=e,this.type=Rf.SHAPES.CIRC}return r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(i,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,a=this.x-i,s=this.y-e;return a*=a,s*=s,a+s<=n},r.prototype.getBounds=function(){return new Pf.default(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},r}();Ma.default=Ff;var Oa={};Oa.__esModule=!0;var Bf=Ar,Lf=kf(Bf),Nf=W;function kf(r){return r&&r.__esModule?r:{default:r}}function Uf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var $f=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;Uf(this,r),this.x=t,this.y=i,this.width=e,this.height=n,this.type=Nf.SHAPES.ELIP}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(i,e){if(this.width<=0||this.height<=0)return!1;var n=(i-this.x)/this.width,a=(e-this.y)/this.height;return n*=n,a*=a,n+a<=1},r.prototype.getBounds=function(){return new Lf.default(this.x-this.width,this.y-this.height,this.width,this.height)},r}();Oa.default=$f;var Pa={};Pa.__esModule=!0;var Gf=Sr,Xf=Wf(Gf),Vf=W;function Wf(r){return r&&r.__esModule?r:{default:r}}function Hf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Yf=function(){function r(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e];if(Hf(this,r),Array.isArray(i[0])&&(i=i[0]),i[0]instanceof Xf.default){for(var n=[],a=0,s=i.length;a<s;a++)n.push(i[a].x,i[a].y);i=n}this.closed=!0,this.points=i,this.type=Vf.SHAPES.POLY}return r.prototype.clone=function(){return new r(this.points.slice())},r.prototype.close=function(){var i=this.points;(i[0]!==i[i.length-2]||i[1]!==i[i.length-1])&&i.push(i[0],i[1])},r.prototype.contains=function(i,e){for(var n=!1,a=this.points.length/2,s=0,o=a-1;s<a;o=s++){var l=this.points[s*2],h=this.points[s*2+1],u=this.points[o*2],f=this.points[o*2+1],d=h>e!=f>e&&i<(u-l)*((e-h)/(f-h))+l;d&&(n=!n)}return n},r}();Pa.default=Yf;var Ra={};Ra.__esModule=!0;var zf=W;function qf(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Kf=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:20;qf(this,r),this.x=t,this.y=i,this.width=e,this.height=n,this.radius=a,this.type=zf.SHAPES.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(i,e){if(this.width<=0||this.height<=0)return!1;if(i>=this.x&&i<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||i>=this.x+this.radius&&i<=this.x+this.width-this.radius)return!0;var n=i-(this.x+this.radius),a=e-(this.y+this.radius),s=this.radius*this.radius;if(n*n+a*a<=s||(n=i-(this.x+this.width-this.radius),n*n+a*a<=s)||(a=e-(this.y+this.height-this.radius),n*n+a*a<=s)||(n=i-(this.x+this.radius),n*n+a*a<=s))return!0}return!1},r}();Ra.default=Kf;(function(r){r.__esModule=!0;var t=Sr;Object.defineProperty(r,"Point",{enumerable:!0,get:function(){return u(t).default}});var i=Si;Object.defineProperty(r,"ObservablePoint",{enumerable:!0,get:function(){return u(i).default}});var e=Dr;Object.defineProperty(r,"Matrix",{enumerable:!0,get:function(){return u(e).default}});var n=Di;Object.defineProperty(r,"GroupD8",{enumerable:!0,get:function(){return u(n).default}});var a=Ma;Object.defineProperty(r,"Circle",{enumerable:!0,get:function(){return u(a).default}});var s=Oa;Object.defineProperty(r,"Ellipse",{enumerable:!0,get:function(){return u(s).default}});var o=Pa;Object.defineProperty(r,"Polygon",{enumerable:!0,get:function(){return u(o).default}});var l=Ar;Object.defineProperty(r,"Rectangle",{enumerable:!0,get:function(){return u(l).default}});var h=Ra;Object.defineProperty(r,"RoundedRectangle",{enumerable:!0,get:function(){return u(h).default}});function u(f){return f&&f.__esModule?f:{default:f}}})(vt);var At={},Zf={get exports(){return At},set exports(r){At=r}},Qf=function(r,t){var i=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i},Jf=Qf,jf=function(r,t,i){var e;if(i){var n=i.tempAttribState,a=i.attribState;for(e=0;e<n.length;e++)n[e]=!1;for(e=0;e<t.length;e++)n[t[e].attribute.location]=!0;for(e=0;e<a.length;e++)a[e]!==n[e]&&(a[e]=n[e],i.attribState[e]?r.enableVertexAttribArray(e):r.disableVertexAttribArray(e))}else for(e=0;e<t.length;e++){var s=t[e];r.enableVertexAttribArray(s.attribute.location)}},Hl=jf,tc=new ArrayBuffer(0),Ht=function(r,t,i,e){this.gl=r,this.buffer=r.createBuffer(),this.type=t||r.ARRAY_BUFFER,this.drawType=e||r.STATIC_DRAW,this.data=tc,i&&this.upload(i),this._updateID=0};Ht.prototype.upload=function(r,t,i){i||this.bind();var e=this.gl;r=r||this.data,t=t||0,this.data.byteLength>=r.byteLength?e.bufferSubData(this.type,t,r):e.bufferData(this.type,r,this.drawType),this.data=r};Ht.prototype.bind=function(){var r=this.gl;r.bindBuffer(this.type,this.buffer)};Ht.createVertexBuffer=function(r,t,i){return new Ht(r,r.ARRAY_BUFFER,t,i)};Ht.createIndexBuffer=function(r,t,i){return new Ht(r,r.ELEMENT_ARRAY_BUFFER,t,i)};Ht.create=function(r,t,i,e){return new Ht(r,t,i,e)};Ht.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var ec=Ht,gt=function(r,t,i,e,n){this.gl=r,this.texture=r.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=t||-1,this.height=i||-1,this.format=e||r.RGBA,this.type=n||r.UNSIGNED_BYTE};gt.prototype.upload=function(r){this.bind();var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var i=r.videoWidth||r.width,e=r.videoHeight||r.height;e!==this.height||i!==this.width?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,this.type,r):t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.format,this.type,r),this.width=i,this.height=e};var vo=!1;gt.prototype.uploadData=function(r,t,i){this.bind();var e=this.gl;if(r instanceof Float32Array){if(!vo){var n=e.getExtension("OES_texture_float");if(n)vo=!0;else throw new Error("floating point textures not available")}this.type=e.FLOAT}else this.type=this.type||e.UNSIGNED_BYTE;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t!==this.width||i!==this.height?e.texImage2D(e.TEXTURE_2D,0,this.format,t,i,0,this.format,this.type,r||null):e.texSubImage2D(e.TEXTURE_2D,0,0,0,t,i,this.format,this.type,r||null),this.width=t,this.height=i};gt.prototype.bind=function(r){var t=this.gl;r!==void 0&&t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.texture)};gt.prototype.unbind=function(){var r=this.gl;r.bindTexture(r.TEXTURE_2D,null)};gt.prototype.minFilter=function(r){var t=this.gl;this.bind(),this.mipmap?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r?t.LINEAR_MIPMAP_LINEAR:t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r?t.LINEAR:t.NEAREST)};gt.prototype.magFilter=function(r){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r?t.LINEAR:t.NEAREST)};gt.prototype.enableMipmap=function(){var r=this.gl;this.bind(),this.mipmap=!0,r.generateMipmap(r.TEXTURE_2D)};gt.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)};gt.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)};gt.prototype.enableWrapClamp=function(){var r=this.gl;this.bind(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)};gt.prototype.enableWrapRepeat=function(){var r=this.gl;this.bind(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT)};gt.prototype.enableWrapMirrorRepeat=function(){var r=this.gl;this.bind(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.MIRRORED_REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.MIRRORED_REPEAT)};gt.prototype.destroy=function(){var r=this.gl;r.deleteTexture(this.texture)};gt.fromSource=function(r,t,i){var e=new gt(r);return e.premultiplyAlpha=i||!1,e.upload(t),e};gt.fromData=function(r,t,i,e){var n=new gt(r);return n.uploadData(t,i,e),n};var Yl=gt,Ia=Yl,Bt=function(r,t,i){this.gl=r,this.framebuffer=r.createFramebuffer(),this.stencil=null,this.texture=null,this.width=t||100,this.height=i||100};Bt.prototype.enableTexture=function(r){var t=this.gl;this.texture=r||new Ia(t),this.texture.bind(),this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture.texture,0)};Bt.prototype.enableStencil=function(){if(!this.stencil){var r=this.gl;this.stencil=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this.stencil),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this.stencil),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,this.width,this.height)}};Bt.prototype.clear=function(r,t,i,e){this.bind();var n=this.gl;n.clearColor(r,t,i,e),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)};Bt.prototype.bind=function(){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer)};Bt.prototype.unbind=function(){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,null)};Bt.prototype.resize=function(r,t){var i=this.gl;this.width=r,this.height=t,this.texture&&this.texture.uploadData(null,r,t),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,r,t))};Bt.prototype.destroy=function(){var r=this.gl;this.texture&&this.texture.destroy(),r.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null};Bt.createRGBA=function(r,t,i,e){var n=Ia.fromData(r,null,t,i);n.enableNearestScaling(),n.enableWrapClamp();var a=new Bt(r,t,i);return a.enableTexture(n),a.unbind(),a};Bt.createFloat32=function(r,t,i,e){var n=new Ia.fromData(r,e,t,i);n.enableNearestScaling(),n.enableWrapClamp();var a=new Bt(r,t,i);return a.enableTexture(n),a.unbind(),a};var rc=Bt,ic=function(r,t,i,e){var n=yo(r,r.VERTEX_SHADER,t),a=yo(r,r.FRAGMENT_SHADER,i),s=r.createProgram();if(r.attachShader(s,n),r.attachShader(s,a),e)for(var o in e)r.bindAttribLocation(s,e[o],o);return r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",r.getProgramParameter(s,r.VALIDATE_STATUS)),console.error("gl.getError()",r.getError()),r.getProgramInfoLog(s)!==""&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(s)),r.deleteProgram(s),s=null),r.deleteShader(n),r.deleteShader(a),s},yo=function(r,t,i){var e=r.createShader(t);return r.shaderSource(e,i),r.compileShader(e),r.getShaderParameter(e,r.COMPILE_STATUS)?e:(console.log(r.getShaderInfoLog(e)),null)},zl=ic,nc=function(r,t){if(!zr){var i=Object.keys(To);zr={};for(var e=0;e<i.length;++e){var n=i[e];zr[r[n]]=To[n]}}return zr[t]},zr=null,To={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Ca=nc,ac=function(r){return sc[r]},sc={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ql=ac,oc=Ca,lc=ql,hc=function(r,t){for(var i={},e=r.getProgramParameter(t,r.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var a=r.getActiveAttrib(t,n),s=oc(r,a.type);i[a.name]={type:s,size:lc(s),location:r.getAttribLocation(t,a.name),pointer:uc}}return i},uc=function(r,t,i,e){gl.vertexAttribPointer(this.location,this.size,r||gl.FLOAT,t||!1,i||0,e||0)},Kl=hc,fc=function(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return Tn(2*t);case"bvec3":return Tn(3*t);case"bvec4":return Tn(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Tn=function(r){for(var t=new Array(r),i=0;i<t.length;i++)t[i]=!1;return t},Zl=fc,cc=Ca,dc=Zl,_c=function(r,t){for(var i={},e=r.getProgramParameter(t,r.ACTIVE_UNIFORMS),n=0;n<e;n++){var a=r.getActiveUniform(t,n),s=a.name.replace(/\[.*?\]/,""),o=cc(r,a.type);i[s]={type:o,size:a.size,location:r.getUniformLocation(t,s),value:dc(o,a.size)}}return i},Ql=_c,pc=function(r,t){return r.substring(0,9)!=="precision"?"precision "+t+` float;
`+r:r},Jl=pc,mc=function(r,t){var i={data:{}};i.gl=r;for(var e=Object.keys(t),n=0;n<e.length;n++){var a=e[n],s=a.split("."),o=s[s.length-1],l=xc(s,i),h=t[a];l.data[o]=h,l.gl=r,Object.defineProperty(l,o,{get:gc(o),set:Tc(o,h)})}return i},gc=function(r){return function(){return this.data[r].value}},vc={float:function(t,i,e){t.uniform1f(i,e)},vec2:function(t,i,e){t.uniform2f(i,e[0],e[1])},vec3:function(t,i,e){t.uniform3f(i,e[0],e[1],e[2])},vec4:function(t,i,e){t.uniform4f(i,e[0],e[1],e[2],e[3])},int:function(t,i,e){t.uniform1i(i,e)},ivec2:function(t,i,e){t.uniform2i(i,e[0],e[1])},ivec3:function(t,i,e){t.uniform3i(i,e[0],e[1],e[2])},ivec4:function(t,i,e){t.uniform4i(i,e[0],e[1],e[2],e[3])},bool:function(t,i,e){t.uniform1i(i,e)},bvec2:function(t,i,e){t.uniform2i(i,e[0],e[1])},bvec3:function(t,i,e){t.uniform3i(i,e[0],e[1],e[2])},bvec4:function(t,i,e){t.uniform4i(i,e[0],e[1],e[2],e[3])},mat2:function(t,i,e){t.uniformMatrix2fv(i,!1,e)},mat3:function(t,i,e){t.uniformMatrix3fv(i,!1,e)},mat4:function(t,i,e){t.uniformMatrix4fv(i,!1,e)},sampler2D:function(t,i,e){t.uniform1i(i,e)}},yc={float:function(t,i,e){t.uniform1fv(i,e)},vec2:function(t,i,e){t.uniform2fv(i,e)},vec3:function(t,i,e){t.uniform3fv(i,e)},vec4:function(t,i,e){t.uniform4fv(i,e)},int:function(t,i,e){t.uniform1iv(i,e)},ivec2:function(t,i,e){t.uniform2iv(i,e)},ivec3:function(t,i,e){t.uniform3iv(i,e)},ivec4:function(t,i,e){t.uniform4iv(i,e)},bool:function(t,i,e){t.uniform1iv(i,e)},bvec2:function(t,i,e){t.uniform2iv(i,e)},bvec3:function(t,i,e){t.uniform3iv(i,e)},bvec4:function(t,i,e){t.uniform4iv(i,e)},sampler2D:function(t,i,e){t.uniform1iv(i,e)}};function Tc(r,t){return function(i){this.data[r].value=i;var e=this.data[r].location;t.size===1?vc[t.type](this.gl,e,i):yc[t.type](this.gl,e,i)}}function xc(r,t){for(var i=t,e=0;e<r.length-1;e++){var n=i[r[e]]||{data:{}};i[r[e]]=n,i=n}return i}var jl=mc,wc=zl,bc=Kl,Ec=Ql,xo=Jl,Sc=jl,Fa=function(r,t,i,e,n){this.gl=r,e&&(t=xo(t,e),i=xo(i,e)),this.program=wc(r,t,i,n),this.attributes=bc(r,this.program),this.uniformData=Ec(r,this.program),this.uniforms=Sc(r,this.uniformData)};Fa.prototype.bind=function(){return this.gl.useProgram(this.program),this};Fa.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null;var r=this.gl;r.deleteProgram(this.program)};var Dc=Fa,Ac=Hl;function Mt(r,t){if(this.nativeVaoExtension=null,Mt.FORCE_NATIVE||(this.nativeVaoExtension=r.getExtension("OES_vertex_array_object")||r.getExtension("MOZ_OES_vertex_array_object")||r.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=t,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=r.getParameter(r.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=r,this.attributes=[],this.indexBuffer=null,this.dirty=!1}Mt.prototype.constructor=Mt;var Mc=Mt;Mt.FORCE_NATIVE=!1;Mt.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this};Mt.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this};Mt.prototype.activate=function(){for(var r=this.gl,t=null,i=0;i<this.attributes.length;i++){var e=this.attributes[i];t!==e.buffer&&(e.buffer.bind(),t=e.buffer),r.vertexAttribPointer(e.attribute.location,e.attribute.size,e.type||r.FLOAT,e.normalized||!1,e.stride||0,e.start||0)}return Ac(r,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this};Mt.prototype.addAttribute=function(r,t,i,e,n,a){return this.attributes.push({buffer:r,attribute:t,location:t.location,type:i||this.gl.FLOAT,normalized:e||!1,stride:n||0,start:a||0}),this.dirty=!0,this};Mt.prototype.addIndex=function(r){return this.indexBuffer=r,this.dirty=!0,this};Mt.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this};Mt.prototype.draw=function(r,t,i){var e=this.gl;return this.indexBuffer?e.drawElements(r,t||this.indexBuffer.data.length,e.UNSIGNED_SHORT,(i||0)*2):e.drawArrays(r,i,t||this.getSize()),this};Mt.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null};Mt.prototype.getSize=function(){var r=this.attributes[0];return r.buffer.data.length/(r.stride/4||r.attribute.size)};var Oc={compileProgram:zl,defaultValue:Zl,extractAttributes:Kl,extractUniforms:Ql,generateUniformAccessObject:jl,setPrecision:Jl,mapSize:ql,mapType:Ca};(function(r){var t={createContext:Jf,setVertexAttribArrays:Hl,GLBuffer:ec,GLFramebuffer:rc,GLShader:Dc,GLTexture:Yl,VertexArrayObject:Mc,shader:Oc};r.exports&&(r.exports=t),typeof window<"u"&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=t)})(Zf);var Mr={};Mr.__esModule=!0;var wo=vt;function Pc(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Rc=function(){function r(){Pc(this,r),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return r.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},r.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},r.prototype.getRectangle=function(i){return this.minX>this.maxX||this.minY>this.maxY?wo.Rectangle.EMPTY:(i=i||new wo.Rectangle(0,0,1,1),i.x=this.minX,i.y=this.minY,i.width=this.maxX-this.minX,i.height=this.maxY-this.minY,i)},r.prototype.addPoint=function(i){this.minX=Math.min(this.minX,i.x),this.maxX=Math.max(this.maxX,i.x),this.minY=Math.min(this.minY,i.y),this.maxY=Math.max(this.maxY,i.y)},r.prototype.addQuad=function(i){var e=this.minX,n=this.minY,a=this.maxX,s=this.maxY,o=i[0],l=i[1];e=o<e?o:e,n=l<n?l:n,a=o>a?o:a,s=l>s?l:s,o=i[2],l=i[3],e=o<e?o:e,n=l<n?l:n,a=o>a?o:a,s=l>s?l:s,o=i[4],l=i[5],e=o<e?o:e,n=l<n?l:n,a=o>a?o:a,s=l>s?l:s,o=i[6],l=i[7],e=o<e?o:e,n=l<n?l:n,a=o>a?o:a,s=l>s?l:s,this.minX=e,this.minY=n,this.maxX=a,this.maxY=s},r.prototype.addFrame=function(i,e,n,a,s){var o=i.worldTransform,l=o.a,h=o.b,u=o.c,f=o.d,d=o.tx,p=o.ty,_=this.minX,m=this.minY,g=this.maxX,y=this.maxY,w=l*e+u*n+d,T=h*e+f*n+p;_=w<_?w:_,m=T<m?T:m,g=w>g?w:g,y=T>y?T:y,w=l*a+u*n+d,T=h*a+f*n+p,_=w<_?w:_,m=T<m?T:m,g=w>g?w:g,y=T>y?T:y,w=l*e+u*s+d,T=h*e+f*s+p,_=w<_?w:_,m=T<m?T:m,g=w>g?w:g,y=T>y?T:y,w=l*a+u*s+d,T=h*a+f*s+p,_=w<_?w:_,m=T<m?T:m,g=w>g?w:g,y=T>y?T:y,this.minX=_,this.minY=m,this.maxX=g,this.maxY=y},r.prototype.addVertices=function(i,e,n,a){for(var s=i.worldTransform,o=s.a,l=s.b,h=s.c,u=s.d,f=s.tx,d=s.ty,p=this.minX,_=this.minY,m=this.maxX,g=this.maxY,y=n;y<a;y+=2){var w=e[y],T=e[y+1],x=o*w+h*T+f,E=u*T+l*w+d;p=x<p?x:p,_=E<_?E:_,m=x>m?x:m,g=E>g?E:g}this.minX=p,this.minY=_,this.maxX=m,this.maxY=g},r.prototype.addBounds=function(i){var e=this.minX,n=this.minY,a=this.maxX,s=this.maxY;this.minX=i.minX<e?i.minX:e,this.minY=i.minY<n?i.minY:n,this.maxX=i.maxX>a?i.maxX:a,this.maxY=i.maxY>s?i.maxY:s},r.prototype.addBoundsMask=function(i,e){var n=i.minX>e.minX?i.minX:e.minX,a=i.minY>e.minY?i.minY:e.minY,s=i.maxX<e.maxX?i.maxX:e.maxX,o=i.maxY<e.maxY?i.maxY:e.maxY;if(n<=s&&a<=o){var l=this.minX,h=this.minY,u=this.maxX,f=this.maxY;this.minX=n<l?n:l,this.minY=a<h?a:h,this.maxX=s>u?s:u,this.maxY=o>f?o:f}},r.prototype.addBoundsArea=function(i,e){var n=i.minX>e.x?i.minX:e.x,a=i.minY>e.y?i.minY:e.y,s=i.maxX<e.x+e.width?i.maxX:e.x+e.width,o=i.maxY<e.y+e.height?i.maxY:e.y+e.height;if(n<=s&&a<=o){var l=this.minX,h=this.minY,u=this.maxX,f=this.maxY;this.minX=n<l?n:l,this.minY=a<h?a:h,this.maxX=s>u?s:u,this.maxY=o>f?o:f}},r}();Mr.default=Rc;var Ai={},Qt={},Ic={get exports(){return Qt},set exports(r){Qt=r}};(function(r){var t=Object.prototype.hasOwnProperty,i="~";function e(){}Object.create&&(e.prototype=Object.create(null),new e().__proto__||(i=!1));function n(s,o,l){this.fn=s,this.context=o,this.once=l||!1}function a(){this._events=new e,this._eventsCount=0}a.prototype.eventNames=function(){var o=[],l,h;if(this._eventsCount===0)return o;for(h in l=this._events)t.call(l,h)&&o.push(i?h.slice(1):h);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},a.prototype.listeners=function(o,l){var h=i?i+o:o,u=this._events[h];if(l)return!!u;if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,p=new Array(d);f<d;f++)p[f]=u[f].fn;return p},a.prototype.emit=function(o,l,h,u,f,d){var p=i?i+o:o;if(!this._events[p])return!1;var _=this._events[p],m=arguments.length,g,y;if(_.fn){switch(_.once&&this.removeListener(o,_.fn,void 0,!0),m){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,l),!0;case 3:return _.fn.call(_.context,l,h),!0;case 4:return _.fn.call(_.context,l,h,u),!0;case 5:return _.fn.call(_.context,l,h,u,f),!0;case 6:return _.fn.call(_.context,l,h,u,f,d),!0}for(y=1,g=new Array(m-1);y<m;y++)g[y-1]=arguments[y];_.fn.apply(_.context,g)}else{var w=_.length,T;for(y=0;y<w;y++)switch(_[y].once&&this.removeListener(o,_[y].fn,void 0,!0),m){case 1:_[y].fn.call(_[y].context);break;case 2:_[y].fn.call(_[y].context,l);break;case 3:_[y].fn.call(_[y].context,l,h);break;case 4:_[y].fn.call(_[y].context,l,h,u);break;default:if(!g)for(T=1,g=new Array(m-1);T<m;T++)g[T-1]=arguments[T];_[y].fn.apply(_[y].context,g)}}return!0},a.prototype.on=function(o,l,h){var u=new n(l,h||this),f=i?i+o:o;return this._events[f]?this._events[f].fn?this._events[f]=[this._events[f],u]:this._events[f].push(u):(this._events[f]=u,this._eventsCount++),this},a.prototype.once=function(o,l,h){var u=new n(l,h||this,!0),f=i?i+o:o;return this._events[f]?this._events[f].fn?this._events[f]=[this._events[f],u]:this._events[f].push(u):(this._events[f]=u,this._eventsCount++),this},a.prototype.removeListener=function(o,l,h,u){var f=i?i+o:o;if(!this._events[f])return this;if(!l)return--this._eventsCount===0?this._events=new e:delete this._events[f],this;var d=this._events[f];if(d.fn)d.fn===l&&(!u||d.once)&&(!h||d.context===h)&&(--this._eventsCount===0?this._events=new e:delete this._events[f]);else{for(var p=0,_=[],m=d.length;p<m;p++)(d[p].fn!==l||u&&!d[p].once||h&&d[p].context!==h)&&_.push(d[p]);_.length?this._events[f]=_.length===1?_[0]:_:--this._eventsCount===0?this._events=new e:delete this._events[f]}return this},a.prototype.removeAllListeners=function(o){var l;return o?(l=i?i+o:o,this._events[l]&&(--this._eventsCount===0?this._events=new e:delete this._events[l])):(this._events=new e,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=i,a.EventEmitter=a,r.exports=a})(Ic);var _t={},Ba={},pr={},Cc={get exports(){return pr},set exports(r){pr=r}};(function(r){(function(t){var i=/iPhone/i,e=/iPod/i,n=/iPad/i,a=/\bAndroid(?:.+)Mobile\b/i,s=/Android/i,o=/\bAndroid(?:.+)SD4930UR\b/i,l=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,h=/Windows Phone/i,u=/\bWindows(?:.+)ARM\b/i,f=/BlackBerry/i,d=/BB10/i,p=/Opera Mini/i,_=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/Mobile(?:.+)Firefox\b/i;function g(w,T){return w.test(T)}function y(w){var T=w||(typeof navigator<"u"?navigator.userAgent:""),x=T.split("[FBAN");x[1]!==void 0&&(T=x[0]),(x=T.split("Twitter"))[1]!==void 0&&(T=x[0]);var E={apple:{phone:g(i,T)&&!g(h,T),ipod:g(e,T),tablet:!g(i,T)&&g(n,T)&&!g(h,T),device:(g(i,T)||g(e,T)||g(n,T))&&!g(h,T)},amazon:{phone:g(o,T),tablet:!g(o,T)&&g(l,T),device:g(o,T)||g(l,T)},android:{phone:!g(h,T)&&g(o,T)||!g(h,T)&&g(a,T),tablet:!g(h,T)&&!g(o,T)&&!g(a,T)&&(g(l,T)||g(s,T)),device:!g(h,T)&&(g(o,T)||g(l,T)||g(a,T)||g(s,T))||g(/\bokhttp\b/i,T)},windows:{phone:g(h,T),tablet:g(u,T),device:g(h,T)||g(u,T)},other:{blackberry:g(f,T),blackberry10:g(d,T),opera:g(p,T),firefox:g(m,T),chrome:g(_,T),device:g(f,T)||g(d,T)||g(p,T)||g(m,T)||g(_,T)}};return E.any=E.apple.device||E.android.device||E.windows.device||E.other.device,E.phone=E.apple.phone||E.android.phone||E.windows.phone,E.tablet=E.apple.tablet||E.android.tablet||E.windows.tablet,E}r.exports&&typeof window>"u"?r.exports=y:r.exports&&typeof window<"u"?(r.exports=y(),r.exports.isMobile=y):t.isMobile=y()})(Tt)})(Cc);Ba.__esModule=!0;Ba.default=Lc;var Fc=pr,bo=Bc(Fc);function Bc(r){return r&&r.__esModule?r:{default:r}}function Lc(r){return bo.default.tablet||bo.default.phone?4:r}var La={};La.__esModule=!0;La.default=Nc;function Nc(){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);return!r}_t.__esModule=!0;var kc=Ba,Uc=th(kc),$c=La,Gc=th($c);function th(r){return r&&r.__esModule?r:{default:r}}_t.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,Uc.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,Gc.default)(),MESH_CANVAS_PADDING:0};var Mi={},Or={};Or.__esModule=!0;var Eo=vt;function Xc(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var mr=function(){function r(){Xc(this,r),this.worldTransform=new Eo.Matrix,this.localTransform=new Eo.Matrix,this._worldID=0,this._parentID=0}return r.prototype.updateLocalTransform=function(){},r.prototype.updateTransform=function(i){var e=i.worldTransform,n=this.worldTransform,a=this.localTransform;n.a=a.a*e.a+a.b*e.c,n.b=a.a*e.b+a.b*e.d,n.c=a.c*e.a+a.d*e.c,n.d=a.c*e.b+a.d*e.d,n.tx=a.tx*e.a+a.ty*e.c+e.tx,n.ty=a.tx*e.b+a.ty*e.d+e.ty,this._worldID++},r}();Or.default=mr;mr.prototype.updateWorldTransform=mr.prototype.updateTransform;mr.IDENTITY=new mr;Mi.__esModule=!0;var Vc=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),qr=vt,Wc=Or,Hc=Yc(Wc);function Yc(r){return r&&r.__esModule?r:{default:r}}function zc(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function qc(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Kc(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Zc=function(r){Kc(t,r);function t(){zc(this,t);var i=qc(this,r.call(this));return i.position=new qr.ObservablePoint(i.onChange,i,0,0),i.scale=new qr.ObservablePoint(i.onChange,i,1,1),i.pivot=new qr.ObservablePoint(i.onChange,i,0,0),i.skew=new qr.ObservablePoint(i.updateSkew,i,0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i._localID=0,i._currentLocalID=0,i}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},t.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(e){var n=this.localTransform;if(this._localID!==this._currentLocalID&&(n.a=this._cx*this.scale._x,n.b=this._sx*this.scale._x,n.c=this._cy*this.scale._y,n.d=this._sy*this.scale._y,n.tx=this.position._x-(this.pivot._x*n.a+this.pivot._y*n.c),n.ty=this.position._y-(this.pivot._x*n.b+this.pivot._y*n.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var a=e.worldTransform,s=this.worldTransform;s.a=n.a*a.a+n.b*a.c,s.b=n.a*a.b+n.b*a.d,s.c=n.c*a.a+n.d*a.c,s.d=n.c*a.b+n.d*a.d,s.tx=n.tx*a.a+n.ty*a.c+a.tx,s.ty=n.tx*a.b+n.ty*a.d+a.ty,this._parentID=e._worldID,this._worldID++}},t.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Vc(t,[{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}}]),t}(Hc.default);Mi.default=Zc;var Oi={};Oi.__esModule=!0;var Qc=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Kr=vt,Jc=Or,jc=td(Jc);function td(r){return r&&r.__esModule?r:{default:r}}function ed(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function rd(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function id(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var nd=function(r){id(t,r);function t(){ed(this,t);var i=rd(this,r.call(this));return i.position=new Kr.Point(0,0),i.scale=new Kr.Point(1,1),i.skew=new Kr.ObservablePoint(i.updateSkew,i,0,0),i.pivot=new Kr.Point(0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i}return t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},t.prototype.updateLocalTransform=function(){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d)},t.prototype.updateTransform=function(e){var n=this.localTransform;n.a=this._cx*this.scale.x,n.b=this._sx*this.scale.x,n.c=this._cy*this.scale.y,n.d=this._sy*this.scale.y,n.tx=this.position.x-(this.pivot.x*n.a+this.pivot.y*n.c),n.ty=this.position.y-(this.pivot.x*n.b+this.pivot.y*n.d);var a=e.worldTransform,s=this.worldTransform;s.a=n.a*a.a+n.b*a.c,s.b=n.a*a.b+n.b*a.d,s.c=n.c*a.a+n.d*a.c,s.d=n.c*a.b+n.d*a.d,s.tx=n.tx*a.a+n.ty*a.c+a.tx,s.ty=n.tx*a.b+n.ty*a.d+a.ty,this._worldID++},t.prototype.setFromMatrix=function(e){e.decompose(this)},Qc(t,[{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation=e,this.updateSkew()}}]),t}(jc.default);Oi.default=nd;Ai.__esModule=!0;var ad=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),sd=Qt,od=Pr(sd),ld=W,hd=_t,ud=Pr(hd),fd=Mi,cd=Pr(fd),dd=Oi,_d=Pr(dd),pd=Mr,md=Pr(pd),So=vt;function Pr(r){return r&&r.__esModule?r:{default:r}}function gd(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function vd(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function yd(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var ca=function(r){yd(t,r);function t(){gd(this,t);var i=vd(this,r.call(this)),e=ud.default.TRANSFORM_MODE===ld.TRANSFORM_MODE.STATIC?cd.default:_d.default;return i.tempDisplayObjectParent=null,i.transform=new e,i.alpha=1,i.visible=!0,i.renderable=!0,i.parent=null,i.worldAlpha=1,i.filterArea=null,i._filters=null,i._enabledFilters=null,i._bounds=new md.default,i._boundsID=0,i._lastBoundsID=-1,i._boundsRect=null,i._localBoundsRect=null,i._mask=null,i._destroyed=!1,i}return t.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.getBounds=function(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),n||(this._boundsRect||(this._boundsRect=new So.Rectangle),n=this._boundsRect),this._bounds.getRectangle(n)},t.prototype.getLocalBounds=function(e){var n=this.transform,a=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e||(this._localBoundsRect||(this._localBoundsRect=new So.Rectangle),e=this._localBoundsRect);var s=this.getBounds(!1,e);return this.parent=a,this.transform=n,s},t.prototype.toGlobal=function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)},t.prototype.toLocal=function(e,n,a,s){return n&&(e=n.toGlobal(e,a,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,a)},t.prototype.renderWebGL=function(e){},t.prototype.renderCanvas=function(e){},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,h=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:0,f=arguments.length>8&&arguments[8]!==void 0?arguments[8]:0;return this.position.x=e,this.position.y=n,this.scale.x=a||1,this.scale.y=s||1,this.rotation=o,this.skew.x=l,this.skew.y=h,this.pivot.x=u,this.pivot.y=f,this},t.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},ad(t,[{key:"_tempDisplayObjectParent",get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new t),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(e){this.transform.position.x=e}},{key:"y",get:function(){return this.position.y},set:function(e){this.transform.position.y=e}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(e){this.transform.position.copy(e)}},{key:"scale",get:function(){return this.transform.scale},set:function(e){this.transform.scale.copy(e)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copy(e)}},{key:"skew",get:function(){return this.transform.skew},set:function(e){this.transform.skew.copy(e)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e}},{key:"worldVisible",get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}},{key:"mask",get:function(){return this._mask},set:function(e){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=e,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(e){this._filters=e&&e.slice()}}]),t}(od.default);Ai.default=ca;ca.prototype.displayObjectUpdateTransform=ca.prototype.updateTransform;var Me={},X={},Na={};Na.__esModule=!0;function Td(r){r.__plugins={},r.registerPlugin=function(i,e){r.__plugins[i]=e},r.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var i in r.__plugins)this.plugins[i]=new r.__plugins[i](this)},r.prototype.destroyPlugins=function(){for(var i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null;this.plugins=null}}Na.default={mixin:function(t){Td(t)}};var Rr={};Rr.__esModule=!0;Rr.mixin=eh;Rr.delayMixin=xd;Rr.performMixins=wd;function eh(r,t){if(!(!r||!t))for(var i=Object.keys(t),e=0;e<i.length;++e){var n=i[e];Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}}var or=[];function xd(r,t){or.push(r,t)}function wd(){for(var r=0;r<or.length;r+=2)eh(or[r],or[r+1]);or.length=0}var bd=function(t,i,e){var n,a=t.length;if(!(i>=a||e===0)){e=i+e>a?a-i:e;var s=a-e;for(n=i;n<s;++n)t[n]=t[n+e];t.length=s}},ka={};ka.__esModule=!0;ka.default=Ed;var It=W;function Ed(){for(var r=[],t=[],i=0;i<32;i++)r[i]=i,t[i]=i;r[It.BLEND_MODES.NORMAL_NPM]=It.BLEND_MODES.NORMAL,r[It.BLEND_MODES.ADD_NPM]=It.BLEND_MODES.ADD,r[It.BLEND_MODES.SCREEN_NPM]=It.BLEND_MODES.SCREEN,t[It.BLEND_MODES.NORMAL]=It.BLEND_MODES.NORMAL_NPM,t[It.BLEND_MODES.ADD]=It.BLEND_MODES.ADD_NPM,t[It.BLEND_MODES.SCREEN]=It.BLEND_MODES.SCREEN_NPM;var e=[];return e.push(t),e.push(r),e}var ke={},Sd={get exports(){return ke},set exports(r){ke=r}};Sd.exports=Pi;ke.default=Pi;function Pi(r,t,i){i=i||2;var e=t&&t.length,n=e?t[0]*i:r.length,a=rh(r,0,n,i,!0),s=[];if(!a||a.next===a.prev)return s;var o,l,h,u,f,d,p;if(e&&(a=Pd(r,t,a,i)),r.length>80*i){o=h=r[0],l=u=r[1];for(var _=i;_<n;_+=i)f=r[_],d=r[_+1],f<o&&(o=f),d<l&&(l=d),f>h&&(h=f),d>u&&(u=d);p=Math.max(h-o,u-l),p=p!==0?32767/p:0}return gr(a,s,i,o,l,p,0),s}function rh(r,t,i,e,n){var a,s;if(n===pa(r,t,i,e)>0)for(a=t;a<i;a+=e)s=Do(a,r[a],r[a+1],s);else for(a=i-e;a>=t;a-=e)s=Do(a,r[a],r[a+1],s);return s&&Ri(s,s.next)&&(yr(s),s=s.next),s}function Ae(r,t){if(!r)return r;t||(t=r);var i=r,e;do if(e=!1,!i.steiner&&(Ri(i,i.next)||ft(i.prev,i,i.next)===0)){if(yr(i),i=t=i.prev,i===i.next)break;e=!0}else i=i.next;while(e||i!==t);return t}function gr(r,t,i,e,n,a,s){if(r){!s&&a&&Bd(r,e,n,a);for(var o=r,l,h;r.prev!==r.next;){if(l=r.prev,h=r.next,a?Ad(r,e,n,a):Dd(r)){t.push(l.i/i|0),t.push(r.i/i|0),t.push(h.i/i|0),yr(r),r=h.next,o=h.next;continue}if(r=h,r===o){s?s===1?(r=Md(Ae(r),t,i),gr(r,t,i,e,n,a,2)):s===2&&Od(r,t,i,e,n,a):gr(Ae(r),t,i,e,n,a,1);break}}}}function Dd(r){var t=r.prev,i=r,e=r.next;if(ft(t,i,e)>=0)return!1;for(var n=t.x,a=i.x,s=e.x,o=t.y,l=i.y,h=e.y,u=n<a?n<s?n:s:a<s?a:s,f=o<l?o<h?o:h:l<h?l:h,d=n>a?n>s?n:s:a>s?a:s,p=o>l?o>h?o:h:l>h?l:h,_=e.next;_!==t;){if(_.x>=u&&_.x<=d&&_.y>=f&&_.y<=p&&Be(n,o,a,l,s,h,_.x,_.y)&&ft(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Ad(r,t,i,e){var n=r.prev,a=r,s=r.next;if(ft(n,a,s)>=0)return!1;for(var o=n.x,l=a.x,h=s.x,u=n.y,f=a.y,d=s.y,p=o<l?o<h?o:h:l<h?l:h,_=u<f?u<d?u:d:f<d?f:d,m=o>l?o>h?o:h:l>h?l:h,g=u>f?u>d?u:d:f>d?f:d,y=da(p,_,t,i,e),w=da(m,g,t,i,e),T=r.prevZ,x=r.nextZ;T&&T.z>=y&&x&&x.z<=w;){if(T.x>=p&&T.x<=m&&T.y>=_&&T.y<=g&&T!==n&&T!==s&&Be(o,u,l,f,h,d,T.x,T.y)&&ft(T.prev,T,T.next)>=0||(T=T.prevZ,x.x>=p&&x.x<=m&&x.y>=_&&x.y<=g&&x!==n&&x!==s&&Be(o,u,l,f,h,d,x.x,x.y)&&ft(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;T&&T.z>=y;){if(T.x>=p&&T.x<=m&&T.y>=_&&T.y<=g&&T!==n&&T!==s&&Be(o,u,l,f,h,d,T.x,T.y)&&ft(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;x&&x.z<=w;){if(x.x>=p&&x.x<=m&&x.y>=_&&x.y<=g&&x!==n&&x!==s&&Be(o,u,l,f,h,d,x.x,x.y)&&ft(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Md(r,t,i){var e=r;do{var n=e.prev,a=e.next.next;!Ri(n,a)&&ih(n,e,e.next,a)&&vr(n,a)&&vr(a,n)&&(t.push(n.i/i|0),t.push(e.i/i|0),t.push(a.i/i|0),yr(e),yr(e.next),e=r=a),e=e.next}while(e!==r);return Ae(e)}function Od(r,t,i,e,n,a){var s=r;do{for(var o=s.next.next;o!==s.prev;){if(s.i!==o.i&&kd(s,o)){var l=nh(s,o);s=Ae(s,s.next),l=Ae(l,l.next),gr(s,t,i,e,n,a,0),gr(l,t,i,e,n,a,0);return}o=o.next}s=s.next}while(s!==r)}function Pd(r,t,i,e){var n=[],a,s,o,l,h;for(a=0,s=t.length;a<s;a++)o=t[a]*e,l=a<s-1?t[a+1]*e:r.length,h=rh(r,o,l,e,!1),h===h.next&&(h.steiner=!0),n.push(Nd(h));for(n.sort(Rd),a=0;a<n.length;a++)i=Id(n[a],i);return i}function Rd(r,t){return r.x-t.x}function Id(r,t){var i=Cd(r,t);if(!i)return t;var e=nh(i,r);return Ae(e,e.next),Ae(i,i.next)}function Cd(r,t){var i=t,e=r.x,n=r.y,a=-1/0,s;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var o=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=e&&o>a&&(a=o,s=i.x<i.next.x?i:i.next,o===e))return s}i=i.next}while(i!==t);if(!s)return null;var l=s,h=s.x,u=s.y,f=1/0,d;i=s;do e>=i.x&&i.x>=h&&e!==i.x&&Be(n<u?e:a,n,h,u,n<u?a:e,n,i.x,i.y)&&(d=Math.abs(n-i.y)/(e-i.x),vr(i,r)&&(d<f||d===f&&(i.x>s.x||i.x===s.x&&Fd(s,i)))&&(s=i,f=d)),i=i.next;while(i!==l);return s}function Fd(r,t){return ft(r.prev,r,t.prev)<0&&ft(t.next,r,r.next)<0}function Bd(r,t,i,e){var n=r;do n.z===0&&(n.z=da(n.x,n.y,t,i,e)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==r);n.prevZ.nextZ=null,n.prevZ=null,Ld(n)}function Ld(r){var t,i,e,n,a,s,o,l,h=1;do{for(i=r,r=null,a=null,s=0;i;){for(s++,e=i,o=0,t=0;t<h&&(o++,e=e.nextZ,!!e);t++);for(l=h;o>0||l>0&&e;)o!==0&&(l===0||!e||i.z<=e.z)?(n=i,i=i.nextZ,o--):(n=e,e=e.nextZ,l--),a?a.nextZ=n:r=n,n.prevZ=a,a=n;i=e}a.nextZ=null,h*=2}while(s>1);return r}function da(r,t,i,e,n){return r=(r-i)*n|0,t=(t-e)*n|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function Nd(r){var t=r,i=r;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==r);return i}function Be(r,t,i,e,n,a,s,o){return(n-s)*(t-o)>=(r-s)*(a-o)&&(r-s)*(e-o)>=(i-s)*(t-o)&&(i-s)*(a-o)>=(n-s)*(e-o)}function kd(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!Ud(r,t)&&(vr(r,t)&&vr(t,r)&&$d(r,t)&&(ft(r.prev,r,t.prev)||ft(r,t.prev,t))||Ri(r,t)&&ft(r.prev,r,r.next)>0&&ft(t.prev,t,t.next)>0)}function ft(r,t,i){return(t.y-r.y)*(i.x-t.x)-(t.x-r.x)*(i.y-t.y)}function Ri(r,t){return r.x===t.x&&r.y===t.y}function ih(r,t,i,e){var n=Qr(ft(r,t,i)),a=Qr(ft(r,t,e)),s=Qr(ft(i,e,r)),o=Qr(ft(i,e,t));return!!(n!==a&&s!==o||n===0&&Zr(r,i,t)||a===0&&Zr(r,e,t)||s===0&&Zr(i,r,e)||o===0&&Zr(i,t,e))}function Zr(r,t,i){return t.x<=Math.max(r.x,i.x)&&t.x>=Math.min(r.x,i.x)&&t.y<=Math.max(r.y,i.y)&&t.y>=Math.min(r.y,i.y)}function Qr(r){return r>0?1:r<0?-1:0}function Ud(r,t){var i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==t.i&&i.next.i!==t.i&&ih(i,i.next,r,t))return!0;i=i.next}while(i!==r);return!1}function vr(r,t){return ft(r.prev,r,r.next)<0?ft(r,t,r.next)>=0&&ft(r,r.prev,t)>=0:ft(r,t,r.prev)<0||ft(r,r.next,t)<0}function $d(r,t){var i=r,e=!1,n=(r.x+t.x)/2,a=(r.y+t.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(e=!e),i=i.next;while(i!==r);return e}function nh(r,t){var i=new _a(r.i,r.x,r.y),e=new _a(t.i,t.x,t.y),n=r.next,a=t.prev;return r.next=t,t.prev=r,i.next=n,n.prev=i,e.next=i,i.prev=e,a.next=e,e.prev=a,e}function Do(r,t,i,e){var n=new _a(r,t,i);return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function yr(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function _a(r,t,i){this.i=r,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Pi.deviation=function(r,t,i,e){var n=t&&t.length,a=n?t[0]*i:r.length,s=Math.abs(pa(r,0,a,i));if(n)for(var o=0,l=t.length;o<l;o++){var h=t[o]*i,u=o<l-1?t[o+1]*i:r.length;s-=Math.abs(pa(r,h,u,i))}var f=0;for(o=0;o<e.length;o+=3){var d=e[o]*i,p=e[o+1]*i,_=e[o+2]*i;f+=Math.abs((r[d]-r[_])*(r[p+1]-r[d+1])-(r[d]-r[p])*(r[_+1]-r[d+1]))}return s===0&&f===0?0:Math.abs((f-s)/s)};function pa(r,t,i,e){for(var n=0,a=t,s=i-e;a<i;a+=e)n+=(r[s]-r[a])*(r[a+1]+r[s+1]),s=a;return n}Pi.flatten=function(r){for(var t=r[0][0].length,i={vertices:[],holes:[],dimensions:t},e=0,n=0;n<r.length;n++){for(var a=0;a<r[n].length;a++)for(var s=0;s<t;s++)i.vertices.push(r[n][a][s]);n>0&&(e+=r[n-1].length,i.holes.push(e))}return i};X.__esModule=!0;X.premultiplyBlendMode=X.BaseTextureCache=X.TextureCache=X.earcut=X.mixins=X.pluginTarget=X.EventEmitter=X.removeItems=X.isMobile=void 0;X.uid=n_;X.hex2rgb=a_;X.hex2string=s_;X.rgb2hex=o_;X.getResolutionOfUrl=l_;X.decomposeDataUri=h_;X.getUrlFileExtension=u_;X.getSvgSize=f_;X.skipHello=c_;X.sayHello=d_;X.isWebGLSupported=__;X.sign=p_;X.destroyTextureCache=m_;X.clearTextureCache=g_;X.correctBlendMode=y_;X.premultiplyTint=T_;X.premultiplyRgba=x_;X.premultiplyTintToRgba=w_;var Tr=W,Gd=_t,Xd=$e(Gd),Vd=Qt,Wd=$e(Vd),Hd=Na,Yd=$e(Hd),zd=Rr,qd=ah(zd),Kd=pr,Zd=ah(Kd),Qd=bd,Jd=$e(Qd),jd=ka,t_=$e(jd),e_=ke,r_=$e(e_);function ah(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function $e(r){return r&&r.__esModule?r:{default:r}}var i_=0,ma=!1;X.isMobile=Zd;X.removeItems=Jd.default;X.EventEmitter=Wd.default;X.pluginTarget=Yd.default;X.mixins=qd;X.earcut=r_.default;function n_(){return++i_}function a_(r,t){return t=t||[],t[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(r&255)/255,t}function s_(r){return r=r.toString(16),r="000000".substr(0,6-r.length)+r,"#"+r}function o_(r){return(r[0]*255<<16)+(r[1]*255<<8)+(r[2]*255|0)}function l_(r,t){var i=Xd.default.RETINA_PREFIX.exec(r);return i?parseFloat(i[1]):t!==void 0?t:1}function h_(r){var t=Tr.DATA_URI.exec(r);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function u_(r){var t=Tr.URL_FILE_EXTENSION.exec(r);if(t)return t[1].toLowerCase()}function f_(r){var t=Tr.SVG_SIZE.exec(r),i={};return t&&(i[t[1]]=Math.round(parseFloat(t[3])),i[t[5]]=Math.round(parseFloat(t[7]))),i}function c_(){ma=!0}function d_(r){if(!ma){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=[`
 %c %c %c PixiJS `+Tr.VERSION+" -  "+r+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,t)}else window.console&&window.console.log("PixiJS "+Tr.VERSION+" - "+r+" - http://www.pixijs.com/");ma=!0}}function __(){var r={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),i=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),e=!!(i&&i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,e}catch{return!1}}function p_(r){return r===0?0:r<0?-1:1}var mi=X.TextureCache=Object.create(null),gi=X.BaseTextureCache=Object.create(null);function m_(){var r=void 0;for(r in mi)mi[r].destroy();for(r in gi)gi[r].destroy()}function g_(){var r=void 0;for(r in mi)delete mi[r];for(r in gi)delete gi[r]}var v_=X.premultiplyBlendMode=(0,t_.default)();function y_(r,t){return v_[t?1:0][r]}function T_(r,t){if(t===1)return(t*255<<24)+r;if(t===0)return 0;var i=r>>16&255,e=r>>8&255,n=r&255;return i=i*t+.5|0,e=e*t+.5|0,n=n*t+.5|0,(t*255<<24)+(i<<16)+(e<<8)+n}function x_(r,t,i,e){return i=i||new Float32Array(4),e||e===void 0?(i[0]=r[0]*t,i[1]=r[1]*t,i[2]=r[2]*t):(i[0]=r[0],i[1]=r[1],i[2]=r[2]),i[3]=t,i}function w_(r,t,i,e){return i=i||new Float32Array(4),i[0]=(r>>16&255)/255,i[1]=(r>>8&255)/255,i[2]=(r&255)/255,(e||e===void 0)&&(i[0]*=t,i[1]*=t,i[2]*=t),i[3]=t,i}Me.__esModule=!0;var b_=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),xn=X,E_=Ai,S_=D_(E_);function D_(r){return r&&r.__esModule?r:{default:r}}function A_(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function M_(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function O_(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var ga=function(r){O_(t,r);function t(){A_(this,t);var i=M_(this,r.call(this));return i.children=[],i}return t.prototype.onChildrenChange=function(){},t.prototype.addChild=function(e){var n=arguments.length;if(n>1)for(var a=0;a<n;a++)this.addChild(arguments[a]);else e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),e.emit("added",this);return e},t.prototype.addChildAt=function(e,n){if(n<0||n>this.children.length)throw new Error(e+"addChildAt: The index "+n+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,e.transform._parentID=-1,this.children.splice(n,0,e),this._boundsID++,this.onChildrenChange(n),e.emit("added",this),e},t.prototype.swapChildren=function(e,n){if(e!==n){var a=this.getChildIndex(e),s=this.getChildIndex(n);this.children[a]=n,this.children[s]=e,this.onChildrenChange(a<s?a:s)}},t.prototype.getChildIndex=function(e){var n=this.children.indexOf(e);if(n===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return n},t.prototype.setChildIndex=function(e,n){if(n<0||n>=this.children.length)throw new Error("The index "+n+" supplied is out of bounds "+this.children.length);var a=this.getChildIndex(e);(0,xn.removeItems)(this.children,a,1),this.children.splice(n,0,e),this.onChildrenChange(n)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(e){var n=arguments.length;if(n>1)for(var a=0;a<n;a++)this.removeChild(arguments[a]);else{var s=this.children.indexOf(e);if(s===-1)return null;e.parent=null,e.transform._parentID=-1,(0,xn.removeItems)(this.children,s,1),this._boundsID++,this.onChildrenChange(s),e.emit("removed",this)}return e},t.prototype.removeChildAt=function(e){var n=this.getChildAt(e);return n.parent=null,n.transform._parentID=-1,(0,xn.removeItems)(this.children,e,1),this._boundsID++,this.onChildrenChange(e),n.emit("removed",this),n},t.prototype.removeChildren=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments[1],a=e,s=typeof n=="number"?n:this.children.length,o=s-a,l=void 0;if(o>0&&o<=s){l=this.children.splice(a,o);for(var h=0;h<l.length;++h)l[h].parent=null,l[h].transform&&(l[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var u=0;u<l.length;++u)l[u].emit("removed",this);return l}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,n=this.children.length;e<n;++e){var a=this.children[e];a.visible&&a.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var n=this.children[e];!n.visible||!n.renderable||(n.calculateBounds(),n._mask?(n._mask.calculateBounds(),this._bounds.addBoundsMask(n._bounds,n._mask._bounds)):n.filterArea?this._bounds.addBoundsArea(n._bounds,n.filterArea):this._bounds.addBounds(n._bounds))}this._lastBoundsID=this._boundsID},t.prototype._calculateBounds=function(){},t.prototype.renderWebGL=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvancedWebGL(e);else{this._renderWebGL(e);for(var n=0,a=this.children.length;n<a;++n)this.children[n].renderWebGL(e)}},t.prototype.renderAdvancedWebGL=function(e){e.flush();var n=this._filters,a=this._mask;if(n){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var s=0;s<n.length;s++)n[s].enabled&&this._enabledFilters.push(n[s]);this._enabledFilters.length&&e.filterManager.pushFilter(this,this._enabledFilters)}a&&e.maskManager.pushMask(this,this._mask),this._renderWebGL(e);for(var o=0,l=this.children.length;o<l;o++)this.children[o].renderWebGL(e);e.flush(),a&&e.maskManager.popMask(this,this._mask),n&&this._enabledFilters&&this._enabledFilters.length&&e.filterManager.popFilter()},t.prototype._renderWebGL=function(e){},t.prototype._renderCanvas=function(e){},t.prototype.renderCanvas=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);for(var n=0,a=this.children.length;n<a;++n)this.children[n].renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.prototype.destroy=function(e){r.prototype.destroy.call(this);var n=typeof e=="boolean"?e:e&&e.children,a=this.removeChildren(0,this.children.length);if(n)for(var s=0;s<a.length;++s)a[s].destroy(e)},b_(t,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var n=this.getLocalBounds().width;n!==0?this.scale.x=e/n:this.scale.x=1,this._width=e}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var n=this.getLocalBounds().height;n!==0?this.scale.y=e/n:this.scale.y=1,this._height=e}}]),t}(S_.default);Me.default=ga;ga.prototype.containerUpdateTransform=ga.prototype.updateTransform;var Ir={},Yt={},de={},Ii={};const P_={},R_=Object.freeze(Object.defineProperty({__proto__:null,default:P_},Symbol.toStringTag,{value:"Module"})),Ua=Vl(R_);Ii.__esModule=!0;Ii.default=B_;var I_=Ua,C_=F_(I_);function F_(r){return r&&r.__esModule?r:{default:r}}var Jr=void 0;function B_(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window.location;if(r.indexOf("data:")===0)return"";t=t||window.location,Jr||(Jr=document.createElement("a")),Jr.href=r,r=C_.default.parse(Jr.href);var i=!r.port&&t.port===""||r.port===t.port;return r.hostname!==t.hostname||!i||r.protocol!==t.protocol?"anonymous":""}var ht={},$a=32;ht.INT_BITS=$a;ht.INT_MAX=2147483647;ht.INT_MIN=-1<<$a-1;ht.sign=function(r){return(r>0)-(r<0)};ht.abs=function(r){var t=r>>$a-1;return(r^t)-t};ht.min=function(r,t){return t^(r^t)&-(r<t)};ht.max=function(r,t){return r^(r^t)&-(r<t)};ht.isPow2=function(r){return!(r&r-1)&&!!r};ht.log2=function(r){var t,i;return t=(r>65535)<<4,r>>>=t,i=(r>255)<<3,r>>>=i,t|=i,i=(r>15)<<2,r>>>=i,t|=i,i=(r>3)<<1,r>>>=i,t|=i,t|r>>1};ht.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0};ht.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function sh(r){var t=32;return r&=-r,r&&t--,r&65535&&(t-=16),r&16711935&&(t-=8),r&252645135&&(t-=4),r&858993459&&(t-=2),r&1431655765&&(t-=1),t}ht.countTrailingZeros=sh;ht.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1};ht.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)};ht.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var lr=new Array(256);(function(r){for(var t=0;t<256;++t){var i=t,e=t,n=7;for(i>>>=1;i;i>>>=1)e<<=1,e|=i&1,--n;r[t]=e<<n&255}})(lr);ht.reverse=function(r){return lr[r&255]<<24|lr[r>>>8&255]<<16|lr[r>>>16&255]<<8|lr[r>>>24&255]};ht.interleave2=function(r,t){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1};ht.deinterleave2=function(r,t){return r=r>>>t&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16};ht.interleave3=function(r,t,i){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|=t<<1,i&=1023,i=(i|i<<16)&4278190335,i=(i|i<<8)&251719695,i=(i|i<<4)&3272356035,i=(i|i<<2)&1227133513,r|i<<2};ht.deinterleave3=function(r,t){return r=r>>>t&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22};ht.nextCombination=function(r){var t=r|r-1;return t+1|(~t&-~t)-1>>>sh(r)+1};de.__esModule=!0;var pt=X,L_=_t,jr=Ci(L_),N_=Qt,k_=Ci(N_),U_=Ii,$_=Ci(U_),G_=ht,Ao=Ci(G_);function Ci(r){return r&&r.__esModule?r:{default:r}}function X_(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function V_(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function W_(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var H_=function(r){W_(t,r);function t(i,e,n){X_(this,t);var a=V_(this,r.call(this));return a.uid=(0,pt.uid)(),a.touched=0,a.resolution=n||jr.default.RESOLUTION,a.width=100,a.height=100,a.realWidth=100,a.realHeight=100,a.scaleMode=e!==void 0?e:jr.default.SCALE_MODE,a.hasLoaded=!1,a.isLoading=!1,a.source=null,a.origSource=null,a.imageType=null,a.sourceScale=1,a.premultipliedAlpha=!0,a.imageUrl=null,a.isPowerOfTwo=!1,a.mipmap=jr.default.MIPMAP_TEXTURES,a.wrapMode=jr.default.WRAP_MODE,a._glTextures={},a._enabled=0,a._virtalBoundId=-1,a._destroyed=!1,a.textureCacheIds=[],i&&a.loadSource(i),a}return t.prototype.update=function(){this.imageType!=="svg"&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},t.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=Ao.default.isPow2(this.realWidth)&&Ao.default.isPow2(this.realHeight)},t.prototype.loadSource=function(e){var n=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,n&&this.source&&(this.source.onload=null,this.source.onerror=null);var a=!this.source;if(this.source=e,(e.src&&e.complete||e.getContext)&&e.width&&e.height)this._updateImageType(),this.imageType==="svg"?this._loadSvgSource():this._sourceLoaded(),a&&this.emit("loaded",this);else if(!e.getContext){this.isLoading=!0;var s=this;if(e.onload=function(){if(s._updateImageType(),e.onload=null,e.onerror=null,!!s.isLoading){if(s.isLoading=!1,s._sourceLoaded(),s.imageType==="svg"){s._loadSvgSource();return}s.emit("loaded",s)}},e.onerror=function(){e.onload=null,e.onerror=null,s.isLoading&&(s.isLoading=!1,s.emit("error",s))},e.complete&&e.src){if(e.onload=null,e.onerror=null,s.imageType==="svg"){s._loadSvgSource();return}this.isLoading=!1,e.width&&e.height?(this._sourceLoaded(),n&&this.emit("loaded",this)):n&&this.emit("error",this)}}},t.prototype._updateImageType=function(){if(this.imageUrl){var e=(0,pt.decomposeDataUri)(this.imageUrl),n=void 0;if(e&&e.mediaType==="image"){var a=e.subType.split("+")[0];if(n=(0,pt.getUrlFileExtension)("."+a),!n)throw new Error("Invalid image type in data URI.")}else n=(0,pt.getUrlFileExtension)(this.imageUrl),n||(n="png");this.imageType=n}},t.prototype._loadSvgSource=function(){if(this.imageType==="svg"){var e=(0,pt.decomposeDataUri)(this.imageUrl);e?this._loadSvgSourceUsingDataUri(e):this._loadSvgSourceUsingXhr()}},t.prototype._loadSvgSourceUsingDataUri=function(e){var n=void 0;if(e.encoding==="base64"){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");n=atob(e.data)}else n=e.data;this._loadSvgSourceUsingString(n)},t.prototype._loadSvgSourceUsingXhr=function(){var e=this,n=new XMLHttpRequest;n.onload=function(){if(n.readyState!==n.DONE||n.status!==200)throw new Error("Failed to load SVG using XHR.");e._loadSvgSourceUsingString(n.response)},n.onerror=function(){return e.emit("error",e)},n.open("GET",this.imageUrl,!0),n.send()},t.prototype._loadSvgSourceUsingString=function(e){var n=(0,pt.getSvgSize)(e),a=n.width,s=n.height;if(!a||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(a*this.sourceScale),this.realHeight=Math.round(s*this.sourceScale),this._updateDimensions();var o=document.createElement("canvas");o.width=this.realWidth,o.height=this.realHeight,o._pixiId="canvas_"+(0,pt.uid)(),o.getContext("2d").drawImage(this.source,0,0,a,s,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,t.addToCache(this,o._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},t.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},t.prototype.destroy=function(){this.imageUrl&&(delete pt.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},t.fromImage=function(e,n,a,s){var o=pt.BaseTextureCache[e];if(!o){var l=new Image;n===void 0&&e.indexOf("data:")!==0?l.crossOrigin=(0,$_.default)(e):n&&(l.crossOrigin=typeof n=="string"?n:"anonymous"),o=new t(l,a),o.imageUrl=e,s&&(o.sourceScale=s),o.resolution=(0,pt.getResolutionOfUrl)(e),l.src=e,t.addToCache(o,e)}return o},t.fromCanvas=function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"canvas";e._pixiId||(e._pixiId=a+"_"+(0,pt.uid)());var s=pt.BaseTextureCache[e._pixiId];return s||(s=new t(e,n),t.addToCache(s,e._pixiId)),s},t.from=function(e,n,a){if(typeof e=="string")return t.fromImage(e,void 0,n,a);if(e instanceof HTMLImageElement){var s=e.src,o=pt.BaseTextureCache[s];return o||(o=new t(e,n),o.imageUrl=s,a&&(o.sourceScale=a),o.resolution=(0,pt.getResolutionOfUrl)(s),t.addToCache(o,s)),o}else if(e instanceof HTMLCanvasElement)return t.fromCanvas(e,n);return e},t.addToCache=function(e,n){n&&(e.textureCacheIds.indexOf(n)===-1&&e.textureCacheIds.push(n),pt.BaseTextureCache[n]&&console.warn("BaseTexture added to the cache with an id ["+n+"] that already had an entry"),pt.BaseTextureCache[n]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var n=pt.BaseTextureCache[e];if(n){var a=n.textureCacheIds.indexOf(e);return a>-1&&n.textureCacheIds.splice(a,1),delete pt.BaseTextureCache[e],n}}else if(e&&e.textureCacheIds){for(var s=0;s<e.textureCacheIds.length;++s)delete pt.BaseTextureCache[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null},t}(k_.default);de.default=H_;var Fi={},ce={},Ga={},Xa={};Xa.__esModule=!0;function Y_(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var z_=function(){function r(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Y_(this,r),this.fn=t,this.context=i,this.priority=e,this.once=n,this.next=null,this.previous=null,this._destroyed=!1}return r.prototype.match=function(i,e){return e=e||null,this.fn===i&&this.context===e},r.prototype.emit=function(i){this.fn&&(this.context?this.fn.call(this.context,i):this.fn(i));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},r.prototype.connect=function(i){this.previous=i,i.next&&(i.next.previous=this),this.next=i.next,i.next=this},r.prototype.destroy=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=i?null:e,this.previous=null,e},r}();Xa.default=z_;Ga.__esModule=!0;var q_=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),K_=_t,wn=oh(K_),Mo=W,Z_=Xa,bn=oh(Z_);function oh(r){return r&&r.__esModule?r:{default:r}}function Q_(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var J_=function(){function r(){var t=this;Q_(this,r),this._head=new bn.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/wn.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(i){t._requestId=null,t.started&&(t.update(i),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return r.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(i,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mo.UPDATE_PRIORITY.NORMAL;return this._addListener(new bn.default(i,e,n))},r.prototype.addOnce=function(i,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mo.UPDATE_PRIORITY.NORMAL;return this._addListener(new bn.default(i,e,n,!0))},r.prototype._addListener=function(i){var e=this._head.next,n=this._head;if(!e)i.connect(n);else{for(;e;){if(i.priority>e.priority){i.connect(n);break}n=e,e=e.next}i.previous||i.connect(n)}return this._startIfPossible(),this},r.prototype.remove=function(i,e){for(var n=this._head.next;n;)n.match(i,e)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this},r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.destroy=function(){this.stop();for(var i=this._head.next;i;)i=i.destroy(!0);this._head.destroy(),this._head=null},r.prototype.update=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:performance.now(),e=void 0;if(i>this.lastTime){e=this.elapsedMS=i-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*wn.default.TARGET_FPMS*this.speed;for(var n=this._head,a=n.next;a;)a=a.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=i},q_(r,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(i){var e=Math.min(Math.max(0,i)/1e3,wn.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),r}();Ga.default=J_;ce.__esModule=!0;ce.Ticker=ce.shared=void 0;var j_=Ga,lh=tp(j_);function tp(r){return r&&r.__esModule?r:{default:r}}var Va=new lh.default;Va.autoStart=!0;Va.destroy=function(){};ce.shared=Va;ce.Ticker=lh.default;Fi.__esModule=!0;var ep=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),rp=de,En=hh(rp),Oo=X,qe=ce,Po=W,ip=Ii,np=hh(ip);function hh(r){return r&&r.__esModule?r:{default:r}}function ap(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function sp(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function op(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var va=function(r){op(t,r);function t(i,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(ap(this,t),!i)throw new Error("No video source element specified.");(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0);var a=sp(this,r.call(this,i,e));return a.width=i.videoWidth,a.height=i.videoHeight,a._autoUpdate=!0,a._isAutoUpdating=!1,a.autoPlay=n,a.update=a.update.bind(a),a._onCanPlay=a._onCanPlay.bind(a),i.addEventListener("play",a._onPlayStart.bind(a)),i.addEventListener("pause",a._onPlayStop.bind(a)),a.hasLoaded=!1,a.__loaded=!1,a._isSourceReady()?a._onCanPlay():(i.addEventListener("canplay",a._onCanPlay),i.addEventListener("canplaythrough",a._onCanPlay)),a}return t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&e.paused===!1&&e.ended===!1&&e.readyState>2},t.prototype._isSourceReady=function(){return this.source.readyState===3||this.source.readyState===4},t.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(qe.shared.add(this.update,this,Po.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},t.prototype._onPlayStop=function(){this._isAutoUpdating&&(qe.shared.remove(this.update,this),this._isAutoUpdating=!1)},t.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},t.prototype.destroy=function(){this._isAutoUpdating&&qe.shared.remove(this.update,this),this.source&&this.source._pixiId&&(En.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),r.prototype.destroy.call(this)},t.fromVideo=function(e,n,a){e._pixiId||(e._pixiId="video_"+(0,Oo.uid)());var s=Oo.BaseTextureCache[e._pixiId];return s||(s=new t(e,n,a),En.default.addToCache(s,e._pixiId)),s},t.fromUrl=function(e,n,a,s){var o=document.createElement("video");o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline","");var l=Array.isArray(e)?e[0].src||e[0]:e.src||e;if(a===void 0&&l.indexOf("data:")!==0?o.crossOrigin=(0,np.default)(l):a&&(o.crossOrigin=typeof a=="string"?a:"anonymous"),Array.isArray(e))for(var h=0;h<e.length;++h)o.appendChild(Ro(e[h].src||e[h],e[h].mime));else o.appendChild(Ro(l,e.mime));return o.load(),t.fromVideo(o,n,s)},ep(t,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isAutoUpdating?(qe.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(qe.shared.add(this.update,this,Po.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),t}(En.default);Fi.default=va;va.fromUrls=va.fromUrl;function Ro(r,t){if(!t){var i=r.split("?").shift().toLowerCase();t="video/"+i.substr(i.lastIndexOf(".")+1)}var e=document.createElement("source");return e.src=r,e.type=t,e}var Bi={};Bi.__esModule=!0;var lp=Di,Ot=hp(lp);function hp(r){return r&&r.__esModule?r:{default:r}}function up(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var fp=function(){function r(){up(this,r),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return r.prototype.set=function(i,e,n){var a=e.width,s=e.height;if(n){var o=i.width/2/a,l=i.height/2/s,h=i.x/a+o,u=i.y/s+l;n=Ot.default.add(n,Ot.default.NW),this.x0=h+o*Ot.default.uX(n),this.y0=u+l*Ot.default.uY(n),n=Ot.default.add(n,2),this.x1=h+o*Ot.default.uX(n),this.y1=u+l*Ot.default.uY(n),n=Ot.default.add(n,2),this.x2=h+o*Ot.default.uX(n),this.y2=u+l*Ot.default.uY(n),n=Ot.default.add(n,2),this.x3=h+o*Ot.default.uX(n),this.y3=u+l*Ot.default.uY(n)}else this.x0=i.x/a,this.y0=i.y/s,this.x1=(i.x+i.width)/a,this.y1=i.y/s,this.x2=(i.x+i.width)/a,this.y2=(i.y+i.height)/s,this.x3=i.x/a,this.y3=(i.y+i.height)/s;this.uvsUint32[0]=(Math.round(this.y0*65535)&65535)<<16|Math.round(this.x0*65535)&65535,this.uvsUint32[1]=(Math.round(this.y1*65535)&65535)<<16|Math.round(this.x1*65535)&65535,this.uvsUint32[2]=(Math.round(this.y2*65535)&65535)<<16|Math.round(this.x2*65535)&65535,this.uvsUint32[3]=(Math.round(this.y3*65535)&65535)<<16|Math.round(this.x3*65535)&65535},r}();Bi.default=fp;Yt.__esModule=!0;var cp=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),dp=de,Kt=Cr(dp),_p=Fi,Io=Cr(_p),pp=Bi,mp=Cr(pp),gp=Qt,vp=Cr(gp),Ke=vt,Lt=X,yp=_t,Tp=Cr(yp);function Cr(r){return r&&r.__esModule?r:{default:r}}function xp(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function wp(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function bp(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Jt=function(r){bp(t,r);function t(i,e,n,a,s,o){xp(this,t);var l=wp(this,r.call(this));if(l.noFrame=!1,e||(l.noFrame=!0,e=new Ke.Rectangle(0,0,1,1)),i instanceof t&&(i=i.baseTexture),l.baseTexture=i,l._frame=e,l.trim=a,l.valid=!1,l.requiresUpdate=!1,l._uvs=null,l.orig=n||e,l._rotate=Number(s||0),s===!0)l._rotate=2;else if(l._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return i.hasLoaded?(l.noFrame&&(e=new Ke.Rectangle(0,0,i.width,i.height),i.on("update",l.onBaseTextureUpdated,l)),l.frame=e):i.once("loaded",l.onBaseTextureLoaded,l),l.defaultAnchor=o?new Ke.Point(o.x,o.y):new Ke.Point(0,0),l._updateID=0,l.transform=null,l.textureCacheIds=[],l}return t.prototype.update=function(){this.baseTexture.update()},t.prototype.onBaseTextureLoaded=function(e){this._updateID++,this.noFrame?this.frame=new Ke.Rectangle(0,0,e.width,e.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},t.prototype.onBaseTextureUpdated=function(e){this._updateID++,this._frame.width=e.width,this._frame.height=e.height,this.emit("update",this)},t.prototype.destroy=function(e){this.baseTexture&&(e&&(Lt.TextureCache[this.baseTexture.imageUrl]&&t.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},t.prototype._updateUvs=function(){this._uvs||(this._uvs=new mp.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.fromImage=function(e,n,a,s){var o=Lt.TextureCache[e];return o||(o=new t(Kt.default.fromImage(e,n,a,s)),t.addToCache(o,e)),o},t.fromFrame=function(e){var n=Lt.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return n},t.fromCanvas=function(e,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"canvas";return new t(Kt.default.fromCanvas(e,n,a))},t.fromVideo=function(e,n,a,s){return typeof e=="string"?t.fromVideoUrl(e,n,a,s):new t(Io.default.fromVideo(e,n,s))},t.fromVideoUrl=function(e,n,a,s){return new t(Io.default.fromUrl(e,n,a,s))},t.from=function(e){if(typeof e=="string"){var n=Lt.TextureCache[e];if(!n){var a=e.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)!==null;return a?t.fromVideoUrl(e):t.fromImage(e)}return n}else{if(e instanceof HTMLImageElement)return new t(Kt.default.from(e));if(e instanceof HTMLCanvasElement)return t.fromCanvas(e,Tp.default.SCALE_MODE,"HTMLCanvasElement");if(e instanceof HTMLVideoElement)return t.fromVideo(e);if(e instanceof Kt.default)return new t(e)}return e},t.fromLoader=function(e,n,a){var s=new Kt.default(e,void 0,(0,Lt.getResolutionOfUrl)(n)),o=new t(s);return s.imageUrl=n,a||(a=n),Kt.default.addToCache(o.baseTexture,a),t.addToCache(o,a),a!==n&&(Kt.default.addToCache(o.baseTexture,n),t.addToCache(o,n)),o},t.addToCache=function(e,n){n&&(e.textureCacheIds.indexOf(n)===-1&&e.textureCacheIds.push(n),Lt.TextureCache[n]&&console.warn("Texture added to the cache with an id ["+n+"] that already had an entry"),Lt.TextureCache[n]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var n=Lt.TextureCache[e];if(n){var a=n.textureCacheIds.indexOf(e);return a>-1&&n.textureCacheIds.splice(a,1),delete Lt.TextureCache[e],n}}else if(e&&e.textureCacheIds){for(var s=0;s<e.textureCacheIds.length;++s)Lt.TextureCache[e.textureCacheIds[s]]===e&&delete Lt.TextureCache[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null},cp(t,[{key:"frame",get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var n=e.x,a=e.y,s=e.width,o=e.height,l=n+s>this.baseTexture.width,h=a+o>this.baseTexture.height;if(l||h){var u=l&&h?"and":"or",f="X: "+n+" + "+s+" = "+(n+s)+" > "+this.baseTexture.width,d="Y: "+a+" + "+o+" = "+(a+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(f+" "+u+" "+d))}this.valid=s&&o&&this.baseTexture.hasLoaded,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),t}(vp.default);Yt.default=Jt;function Ep(){var r=document.createElement("canvas");r.width=10,r.height=10;var t=r.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,10,10),new Jt(new Kt.default(r))}function Li(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}Jt.EMPTY=new Jt(new Kt.default);Li(Jt.EMPTY);Li(Jt.EMPTY.baseTexture);Jt.WHITE=Ep();Li(Jt.WHITE);Li(Jt.WHITE.baseTexture);Ir.__esModule=!0;var Sp=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),ya=vt,Ze=X,Dp=W,Ap=Yt,ti=uh(Ap),Mp=Me,Op=uh(Mp);function uh(r){return r&&r.__esModule?r:{default:r}}function Pp(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Rp(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Ip(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Qe=new ya.Point,Cp=function(r){Ip(t,r);function t(i){Pp(this,t);var e=Rp(this,r.call(this));return e._anchor=new ya.ObservablePoint(e._onAnchorUpdate,e,i?i.defaultAnchor.x:0,i?i.defaultAnchor.y:0),e._texture=null,e._width=0,e._height=0,e._tint=null,e._tintRGB=null,e.tint=16777215,e.blendMode=Dp.BLEND_MODES.NORMAL,e.shader=null,e.cachedTint=16777215,e.texture=i||ti.default.EMPTY,e.vertexData=new Float32Array(8),e.vertexTrimmedData=null,e._transformID=-1,e._textureID=-1,e._transformTrimmedID=-1,e._textureTrimmedID=-1,e.pluginName="sprite",e}return t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,Ze.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,Ze.sign)(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){if(!(this._transformID===this.transform._worldID&&this._textureID===this._texture._updateID)){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var e=this._texture,n=this.transform.worldTransform,a=n.a,s=n.b,o=n.c,l=n.d,h=n.tx,u=n.ty,f=this.vertexData,d=e.trim,p=e.orig,_=this._anchor,m=0,g=0,y=0,w=0;d?(g=d.x-_._x*p.width,m=g+d.width,w=d.y-_._y*p.height,y=w+d.height):(g=-_._x*p.width,m=g+p.width,w=-_._y*p.height,y=w+p.height),f[0]=a*g+o*w+h,f[1]=l*w+s*g+u,f[2]=a*m+o*w+h,f[3]=l*w+s*m+u,f[4]=a*m+o*y+h,f[5]=l*y+s*m+u,f[6]=a*g+o*y+h,f[7]=l*y+s*g+u}},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,n=this.vertexTrimmedData,a=e.orig,s=this._anchor,o=this.transform.worldTransform,l=o.a,h=o.b,u=o.c,f=o.d,d=o.tx,p=o.ty,_=-s._x*a.width,m=_+a.width,g=-s._y*a.height,y=g+a.height;n[0]=l*_+u*g+d,n[1]=f*g+h*_+p,n[2]=l*m+u*g+d,n[3]=f*g+h*m+p,n[4]=l*m+u*y+d,n[5]=f*y+h*m+p,n[6]=l*_+u*y+d,n[7]=f*y+h*_+p},t.prototype._renderWebGL=function(e){this.calculateVertices(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(e){e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new ya.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Qe);var n=this._texture.orig.width,a=this._texture.orig.height,s=-n*this.anchor.x,o=0;return Qe.x>=s&&Qe.x<s+n&&(o=-a*this.anchor.y,Qe.y>=o&&Qe.y<o+a)},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var n=typeof e=="boolean"?e:e&&e.texture;if(n){var a=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!a)}this._texture=null,this.shader=null},t.from=function(e){return new t(ti.default.from(e))},t.fromFrame=function(e){var n=Ze.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return new t(n)},t.fromImage=function(e,n,a){return new t(ti.default.fromImage(e,n,a))},Sp(t,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var n=(0,Ze.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var n=(0,Ze.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}},{key:"anchor",get:function(){return this._anchor},set:function(e){this._anchor.copy(e)}},{key:"tint",get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)}},{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e||ti.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}]),t}(Op.default);Ir.default=Cp;var Wa={},Oe={},Ni={},Fr={},ki={};ki.__esModule=!0;var Fp=de,Bp=fh(Fp),Lp=_t,Co=fh(Lp);function fh(r){return r&&r.__esModule?r:{default:r}}function Np(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function kp(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Up(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var $p=function(r){Up(t,r);function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,n=arguments[2],a=arguments[3];Np(this,t);var s=kp(this,r.call(this,null,n));return s.resolution=a||Co.default.RESOLUTION,s.width=Math.ceil(i),s.height=Math.ceil(e),s.realWidth=s.width*s.resolution,s.realHeight=s.height*s.resolution,s.scaleMode=n!==void 0?n:Co.default.SCALE_MODE,s.hasLoaded=!0,s._glRenderTargets={},s._canvasRenderTarget=null,s.valid=!1,s}return t.prototype.resize=function(e,n){e=Math.ceil(e),n=Math.ceil(n),!(e===this.width&&n===this.height)&&(this.valid=e>0&&n>0,this.width=e,this.height=n,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},t.prototype.destroy=function(){r.prototype.destroy.call(this,!0),this.renderer=null},t}(Bp.default);ki.default=$p;Fr.__esModule=!0;var Gp=ki,Sn=ch(Gp),Xp=Yt,Vp=ch(Xp);function ch(r){return r&&r.__esModule?r:{default:r}}function Wp(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Hp(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Yp(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var zp=function(r){Yp(t,r);function t(i,e){Wp(this,t);var n=null;if(!(i instanceof Sn.default)){var a=arguments[1],s=arguments[2],o=arguments[3],l=arguments[4];console.warn("Please use RenderTexture.create("+a+", "+s+") instead of the ctor directly."),n=arguments[0],e=null,i=new Sn.default(a,s,o,l)}var h=Hp(this,r.call(this,i,e));return h.legacyRenderer=n,h.valid=!0,h._updateUvs(),h}return t.prototype.resize=function(e,n,a){e=Math.ceil(e),n=Math.ceil(n),this.valid=e>0&&n>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=n,a||this.baseTexture.resize(e,n),this._updateUvs()},t.create=function(e,n,a,s){return new t(new Sn.default(e,n,a,s))},t}(Vp.default);Fr.default=zp;Ni.__esModule=!0;var qp=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Dn=X,dh=vt,Fo=W,Kp=_t,An=Ui(Kp),Zp=Me,Qp=Ui(Zp),Jp=Fr,jp=Ui(Jp),tm=Qt,em=Ui(tm);function Ui(r){return r&&r.__esModule?r:{default:r}}function rm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function im(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function nm(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Mn=new dh.Matrix,am=function(r){nm(t,r);function t(i,e,n,a){rm(this,t);var s=im(this,r.call(this));return(0,Dn.sayHello)(i),typeof e=="number"&&(e=Object.assign({width:e,height:n||An.default.RENDER_OPTIONS.height},a)),e=Object.assign({},An.default.RENDER_OPTIONS,e),s.options=e,s.type=Fo.RENDERER_TYPE.UNKNOWN,s.screen=new dh.Rectangle(0,0,e.width,e.height),s.view=e.view||document.createElement("canvas"),s.resolution=e.resolution||An.default.RESOLUTION,s.transparent=e.transparent,s.autoResize=e.autoResize||!1,s.blendModes=null,s.preserveDrawingBuffer=e.preserveDrawingBuffer,s.clearBeforeRender=e.clearBeforeRender,s.roundPixels=e.roundPixels,s._backgroundColor=0,s._backgroundColorRgba=[0,0,0,0],s._backgroundColorString="#000000",s.backgroundColor=e.backgroundColor||s._backgroundColor,s._tempDisplayObjectParent=new Qp.default,s._lastObjectRendered=s._tempDisplayObjectParent,s}return t.prototype.resize=function(e,n){this.screen.width=e,this.screen.height=n,this.view.width=e*this.resolution,this.view.height=n*this.resolution,this.autoResize&&(this.view.style.width=e+"px",this.view.style.height=n+"px")},t.prototype.generateTexture=function(e,n,a,s){s=s||e.getLocalBounds();var o=jp.default.create(s.width|0,s.height|0,n,a);return Mn.tx=-s.x,Mn.ty=-s.y,this.render(e,o,!1,Mn,!!e.parent),o},t.prototype.destroy=function(e){e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=Fo.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},qp(t,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=(0,Dn.hex2string)(e),(0,Dn.hex2rgb)(e,this._backgroundColorRgba)}}]),t}(em.default);Ni.default=am;var Ha={};Ha.__esModule=!0;var Je=W;function sm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var om=function(){function r(t){sm(this,r),this.renderer=t}return r.prototype.pushMask=function(i){var e=this.renderer;e.context.save();var n=i.alpha,a=i.transform.worldTransform,s=e.resolution;e.context.setTransform(a.a*s,a.b*s,a.c*s,a.d*s,a.tx*s,a.ty*s),i._texture||(this.renderGraphicsShape(i),e.context.clip()),i.worldAlpha=n},r.prototype.renderGraphicsShape=function(i){var e=this.renderer.context,n=i.graphicsData.length;if(n!==0){e.beginPath();for(var a=0;a<n;a++){var s=i.graphicsData[a],o=s.shape;if(s.type===Je.SHAPES.POLY){var l=o.points,h=s.holes,u=void 0,f=void 0;e.moveTo(l[0],l[1]);for(var d=2;d<l.length;d+=2)e.lineTo(l[d],l[d+1]);if(l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&e.closePath(),h.length>0){u=0;for(var p=0;p<l.length;p+=2)u+=l[p]*l[p+3]-l[p+1]*l[p+2];for(var _=0;_<h.length;_++){l=h[_].points,f=0;for(var m=0;m<l.length;m+=2)f+=l[m]*l[m+3]-l[m+1]*l[m+2];if(e.moveTo(l[0],l[1]),f*u<0)for(var g=2;g<l.length;g+=2)e.lineTo(l[g],l[g+1]);else for(var y=l.length-2;y>=2;y-=2)e.lineTo(l[y],l[y+1])}}}else if(s.type===Je.SHAPES.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(s.type===Je.SHAPES.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(s.type===Je.SHAPES.ELIP){var w=o.width*2,T=o.height*2,x=o.x-w/2,E=o.y-T/2,b=.5522848,D=w/2*b,S=T/2*b,M=x+w,O=E+T,F=x+w/2,L=E+T/2;e.moveTo(x,L),e.bezierCurveTo(x,L-S,F-D,E,F,E),e.bezierCurveTo(F+D,E,M,L-S,M,L),e.bezierCurveTo(M,L+S,F+D,O,F,O),e.bezierCurveTo(F-D,O,x,L+S,x,L),e.closePath()}else if(s.type===Je.SHAPES.RREC){var B=o.x,I=o.y,U=o.width,G=o.height,$=o.radius,k=Math.min(U,G)/2|0;$=$>k?k:$,e.moveTo(B,I+$),e.lineTo(B,I+G-$),e.quadraticCurveTo(B,I+G,B+$,I+G),e.lineTo(B+U-$,I+G),e.quadraticCurveTo(B+U,I+G,B+U,I+G-$),e.lineTo(B+U,I+$),e.quadraticCurveTo(B+U,I,B+U-$,I),e.lineTo(B+$,I),e.quadraticCurveTo(B,I,B,I+$),e.closePath()}}}},r.prototype.popMask=function(i){i.context.restore(),i.invalidateBlendMode()},r.prototype.destroy=function(){},r}();Ha.default=om;var $i={};$i.__esModule=!0;var lm=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),hm=_t,um=fm(hm);function fm(r){return r&&r.__esModule?r:{default:r}}function cm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var dm=function(){function r(t,i,e){cm(this,r),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=e||um.default.RESOLUTION,this.resize(t,i)}return r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(i,e){this.canvas.width=i*this.resolution,this.canvas.height=e*this.resolution},r.prototype.destroy=function(){this.context=null,this.canvas=null},lm(r,[{key:"width",get:function(){return this.canvas.width},set:function(i){this.canvas.width=i}},{key:"height",get:function(){return this.canvas.height},set:function(i){this.canvas.height=i}}]),r}();$i.default=dm;var Ya={},Gi={};Gi.__esModule=!0;Gi.default=_m;function Bo(r){var t=document.createElement("canvas");t.width=6,t.height=1;var i=t.getContext("2d");return i.fillStyle=r,i.fillRect(0,0,6,1),t}function _m(){if(typeof document>"u")return!1;var r=Bo("#ff00ff"),t=Bo("#ffff00"),i=document.createElement("canvas");i.width=6,i.height=1;var e=i.getContext("2d");e.globalCompositeOperation="multiply",e.drawImage(r,0,0),e.drawImage(t,2,0);var n=e.getImageData(2,0,1,1);if(!n)return!1;var a=n.data;return a[0]===255&&a[1]===0&&a[2]===0}Ya.__esModule=!0;Ya.default=vm;var K=W,pm=Gi,mm=gm(pm);function gm(r){return r&&r.__esModule?r:{default:r}}function vm(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return(0,mm.default)()?(r[K.BLEND_MODES.NORMAL]="source-over",r[K.BLEND_MODES.ADD]="lighter",r[K.BLEND_MODES.MULTIPLY]="multiply",r[K.BLEND_MODES.SCREEN]="screen",r[K.BLEND_MODES.OVERLAY]="overlay",r[K.BLEND_MODES.DARKEN]="darken",r[K.BLEND_MODES.LIGHTEN]="lighten",r[K.BLEND_MODES.COLOR_DODGE]="color-dodge",r[K.BLEND_MODES.COLOR_BURN]="color-burn",r[K.BLEND_MODES.HARD_LIGHT]="hard-light",r[K.BLEND_MODES.SOFT_LIGHT]="soft-light",r[K.BLEND_MODES.DIFFERENCE]="difference",r[K.BLEND_MODES.EXCLUSION]="exclusion",r[K.BLEND_MODES.HUE]="hue",r[K.BLEND_MODES.SATURATION]="saturate",r[K.BLEND_MODES.COLOR]="color",r[K.BLEND_MODES.LUMINOSITY]="luminosity"):(r[K.BLEND_MODES.NORMAL]="source-over",r[K.BLEND_MODES.ADD]="lighter",r[K.BLEND_MODES.MULTIPLY]="source-over",r[K.BLEND_MODES.SCREEN]="source-over",r[K.BLEND_MODES.OVERLAY]="source-over",r[K.BLEND_MODES.DARKEN]="source-over",r[K.BLEND_MODES.LIGHTEN]="source-over",r[K.BLEND_MODES.COLOR_DODGE]="source-over",r[K.BLEND_MODES.COLOR_BURN]="source-over",r[K.BLEND_MODES.HARD_LIGHT]="source-over",r[K.BLEND_MODES.SOFT_LIGHT]="source-over",r[K.BLEND_MODES.DIFFERENCE]="source-over",r[K.BLEND_MODES.EXCLUSION]="source-over",r[K.BLEND_MODES.HUE]="source-over",r[K.BLEND_MODES.SATURATION]="source-over",r[K.BLEND_MODES.COLOR]="source-over",r[K.BLEND_MODES.LUMINOSITY]="source-over"),r[K.BLEND_MODES.NORMAL_NPM]=r[K.BLEND_MODES.NORMAL],r[K.BLEND_MODES.ADD_NPM]=r[K.BLEND_MODES.ADD],r[K.BLEND_MODES.SCREEN_NPM]=r[K.BLEND_MODES.SCREEN],r}Oe.__esModule=!0;var ym=Ni,Tm=Br(ym),xm=Ha,wm=Br(xm),bm=$i,Em=Br(bm),Sm=Ya,Dm=Br(Sm),Am=X,ei=W,Mm=_t,Om=Br(Mm);function Br(r){return r&&r.__esModule?r:{default:r}}function Pm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Rm(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Im(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var _h=function(r){Im(t,r);function t(i,e,n){Pm(this,t);var a=Rm(this,r.call(this,"Canvas",i,e,n));return a.type=ei.RENDERER_TYPE.CANVAS,a.rootContext=a.view.getContext("2d",{alpha:a.transparent}),a.context=a.rootContext,a.refresh=!0,a.maskManager=new wm.default(a),a.smoothProperty="imageSmoothingEnabled",a.rootContext.imageSmoothingEnabled||(a.rootContext.webkitImageSmoothingEnabled?a.smoothProperty="webkitImageSmoothingEnabled":a.rootContext.mozImageSmoothingEnabled?a.smoothProperty="mozImageSmoothingEnabled":a.rootContext.oImageSmoothingEnabled?a.smoothProperty="oImageSmoothingEnabled":a.rootContext.msImageSmoothingEnabled&&(a.smoothProperty="msImageSmoothingEnabled")),a.initPlugins(),a.blendModes=(0,Dm.default)(),a._activeBlendMode=null,a.renderingToScreen=!1,a.resize(a.options.width,a.options.height),a}return t.prototype.render=function(e,n,a,s,o){if(this.view){this.renderingToScreen=!n,this.emit("prerender");var l=this.resolution;n?(n=n.baseTexture||n,n._canvasRenderTarget||(n._canvasRenderTarget=new Em.default(n.width,n.height,n.resolution),n.source=n._canvasRenderTarget.canvas,n.valid=!0),this.context=n._canvasRenderTarget.context,this.resolution=n._canvasRenderTarget.resolution):this.context=this.rootContext;var h=this.context;if(n||(this._lastObjectRendered=e),!o){var u=e.parent,f=this._tempDisplayObjectParent.transform.worldTransform;s?(s.copy(f),this._tempDisplayObjectParent.transform._worldID=-1):f.identity(),e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=u}h.save(),h.setTransform(1,0,0,1,0,0),h.globalAlpha=1,this._activeBlendMode=ei.BLEND_MODES.NORMAL,h.globalCompositeOperation=this.blendModes[ei.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(h.fillStyle="black",h.clear()),(a!==void 0?a:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?h.clearRect(0,0,this.width,this.height):(h.fillStyle=this._backgroundColorString,h.fillRect(0,0,this.width,this.height)));var d=this.context;this.context=h,e.renderCanvas(this),this.context=d,h.restore(),this.resolution=l,this.emit("postrender")}},t.prototype.clear=function(e){var n=this.context;e=e||this._backgroundColorString,!this.transparent&&e?(n.fillStyle=e,n.fillRect(0,0,this.width,this.height)):n.clearRect(0,0,this.width,this.height)},t.prototype.setBlendMode=function(e){this._activeBlendMode!==e&&(this._activeBlendMode=e,this.context.globalCompositeOperation=this.blendModes[e])},t.prototype.destroy=function(e){this.destroyPlugins(),r.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},t.prototype.resize=function(e,n){r.prototype.resize.call(this,e,n),this.smoothProperty&&(this.rootContext[this.smoothProperty]=Om.default.SCALE_MODE===ei.SCALE_MODES.LINEAR)},t.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},t}(Tm.default);Oe.default=_h;Am.pluginTarget.mixin(_h);var Ge={};Ge.__esModule=!0;var On=X,Cm=Gi,Fm=Bm(Cm);function Bm(r){return r&&r.__esModule?r:{default:r}}var Gt={getTintedTexture:function(t,i){var e=t._texture;i=Gt.roundColor(i);var n="#"+("00000"+(i|0).toString(16)).substr(-6);e.tintCache=e.tintCache||{};var a=e.tintCache[n],s=void 0;if(a){if(a.tintId===e._updateID)return e.tintCache[n];s=e.tintCache[n]}else s=Gt.canvas||document.createElement("canvas");if(Gt.tintMethod(e,i,s),s.tintId=e._updateID,Gt.convertTintToImage){var o=new Image;o.src=s.toDataURL(),e.tintCache[n]=o}else e.tintCache[n]=s,Gt.canvas=null;return s},tintWithMultiply:function(t,i,e){var n=e.getContext("2d"),a=t._frame.clone(),s=t.baseTexture.resolution;a.x*=s,a.y*=s,a.width*=s,a.height*=s,e.width=Math.ceil(a.width),e.height=Math.ceil(a.height),n.save(),n.fillStyle="#"+("00000"+(i|0).toString(16)).substr(-6),n.fillRect(0,0,a.width,a.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),n.restore()},tintWithOverlay:function(t,i,e){var n=e.getContext("2d"),a=t._frame.clone(),s=t.baseTexture.resolution;a.x*=s,a.y*=s,a.width*=s,a.height*=s,e.width=Math.ceil(a.width),e.height=Math.ceil(a.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(i|0).toString(16)).substr(-6),n.fillRect(0,0,a.width,a.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),n.restore()},tintWithPerPixel:function(t,i,e){var n=e.getContext("2d"),a=t._frame.clone(),s=t.baseTexture.resolution;a.x*=s,a.y*=s,a.width*=s,a.height*=s,e.width=Math.ceil(a.width),e.height=Math.ceil(a.height),n.save(),n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),n.restore();for(var o=(0,On.hex2rgb)(i),l=o[0],h=o[1],u=o[2],f=n.getImageData(0,0,a.width,a.height),d=f.data,p=0;p<d.length;p+=4)d[p+0]*=l,d[p+1]*=h,d[p+2]*=u;n.putImageData(f,0,0)},roundColor:function(t){var i=Gt.cacheStepsPerColorChannel,e=(0,On.hex2rgb)(t);return e[0]=Math.min(255,e[0]/i*i),e[1]=Math.min(255,e[1]/i*i),e[2]=Math.min(255,e[2]/i*i),(0,On.rgb2hex)(e)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,Fm.default)(),tintMethod:0};Gt.tintMethod=Gt.canUseMultiply?Gt.tintWithMultiply:Gt.tintWithPerPixel;Ge.default=Gt;Wa.__esModule=!0;var Lm=Oe,Nm=mh(Lm),km=W,ph=vt,Um=Ge,$m=mh(Um);function mh(r){return r&&r.__esModule?r:{default:r}}function Gm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Lo=new ph.Matrix,gh=function(){function r(t){Gm(this,r),this.renderer=t}return r.prototype.render=function(i){var e=i._texture,n=this.renderer,a=e._frame.width,s=e._frame.height,o=i.transform.worldTransform,l=0,h=0;if(!(e.orig.width<=0||e.orig.height<=0||!e.baseTexture.source)&&(n.setBlendMode(i.blendMode),e.valid)){n.context.globalAlpha=i.worldAlpha;var u=e.baseTexture.scaleMode===km.SCALE_MODES.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==u&&(n.context[n.smoothProperty]=u),e.trim?(l=e.trim.width/2+e.trim.x-i.anchor.x*e.orig.width,h=e.trim.height/2+e.trim.y-i.anchor.y*e.orig.height):(l=(.5-i.anchor.x)*e.orig.width,h=(.5-i.anchor.y)*e.orig.height),e.rotate&&(o.copy(Lo),o=Lo,ph.GroupD8.matrixAppendRotationInv(o,e.rotate,l,h),l=0,h=0),l-=a/2,h-=s/2,n.roundPixels?(n.context.setTransform(o.a,o.b,o.c,o.d,o.tx*n.resolution|0,o.ty*n.resolution|0),l=l|0,h=h|0):n.context.setTransform(o.a,o.b,o.c,o.d,o.tx*n.resolution,o.ty*n.resolution);var f=e.baseTexture.resolution;i.tint!==16777215?((i.cachedTint!==i.tint||i.tintedTexture.tintId!==i._texture._updateID)&&(i.cachedTint=i.tint,i.tintedTexture=$m.default.getTintedTexture(i,i.tint)),n.context.drawImage(i.tintedTexture,0,0,a*f,s*f,l*n.resolution,h*n.resolution,a*n.resolution,s*n.resolution)):n.context.drawImage(e.baseTexture.source,e._frame.x*f,e._frame.y*f,a*f,s*f,l*n.resolution,h*n.resolution,a*n.resolution,s*n.resolution)}},r.prototype.destroy=function(){this.renderer=null},r}();Wa.default=gh;Nm.default.registerPlugin("sprite",gh);var za={},Xe={},Pe={};Pe.__esModule=!0;function Xm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Vm=function(){function r(t){Xm(this,r),this.renderer=t,this.renderer.on("context",this.onContextChange,this)}return r.prototype.onContextChange=function(){},r.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},r}();Pe.default=Vm;Xe.__esModule=!0;var Wm=Pe,Hm=Ym(Wm);function Ym(r){return r&&r.__esModule?r:{default:r}}function zm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function qm(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Km(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Zm=function(r){Km(t,r);function t(){return zm(this,t),qm(this,r.apply(this,arguments))}return t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.flush=function(){},t.prototype.render=function(e){},t}(Hm.default);Xe.default=Zm;var Ve={},qa={},Xi={},Vi={},Ka={};Ka.__esModule=!0;Ka.default=eg;var Qm=At,Jm=jm(Qm);function jm(r){return r&&r.__esModule?r:{default:r}}var tg=Jm.default.shader.defaultValue;function eg(r,t,i){var e=No(r),n=No(t);return Object.assign(e,n)}function No(r){for(var t=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),i={},e=void 0,n=r.replace(/\s+/g," ").split(/\s*;\s*/),a=0;a<n.length;a++){var s=n[a].trim();if(s.indexOf("uniform")>-1){var o=s.split(" "),l=o[1],h=o[2],u=1;h.indexOf("[")>-1&&(e=h.split(/\[|]/),h=e[0],u*=Number(e[1])),h.match(t)||(i[h]={value:tg(l,u),name:h,type:l})}}return i}Vi.__esModule=!0;var rg=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),ig=Ka,ng=vh(ig),ag=X,sg=W,og=_t,lg=vh(og);function vh(r){return r&&r.__esModule?r:{default:r}}function hg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Pn={},ug=function(){function r(t,i,e){hg(this,r),this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=i||r.defaultFragmentSrc,this._blendMode=sg.BLEND_MODES.NORMAL,this.uniformData=e||(0,ng.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var n in this.uniformData)this.uniforms[n]=this.uniformData[n].value,this.uniformData[n].type&&(this.uniformData[n].type=this.uniformData[n].type.toLowerCase());this.glShaders={},Pn[this.vertexSrc+this.fragmentSrc]||(Pn[this.vertexSrc+this.fragmentSrc]=(0,ag.uid)()),this.glShaderKey=Pn[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=lg.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return r.prototype.apply=function(i,e,n,a,s){i.applyFilter(this,e,n,a)},rg(r,[{key:"blendMode",get:function(){return this._blendMode},set:function(i){this._blendMode=i}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join(`
`)}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join(`
`)}}]),r}();Vi.default=ug;var Wi={};Wi.__esModule=!0;var fg=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),cg=Dr,yh=dg(cg);function dg(r){return r&&r.__esModule?r:{default:r}}function _g(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ko=new yh.default,pg=function(){function r(t,i){_g(this,r),this._texture=t,this.mapCoord=new yh.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=typeof i>"u"?.5:i}return r.prototype.multiplyUvs=function(i,e){e===void 0&&(e=i);for(var n=this.mapCoord,a=0;a<i.length;a+=2){var s=i[a],o=i[a+1];e[a]=s*n.a+o*n.c+n.tx,e[a+1]=s*n.b+o*n.d+n.ty}return e},r.prototype.update=function(i){var e=this._texture;if(!e||!e.valid||!i&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var a=e.orig,s=e.trim;s&&(ko.set(a.width/s.width,0,0,a.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(ko));var o=e.baseTexture,l=this.uClampFrame,h=this.clampMargin/o.resolution,u=this.clampOffset;return l[0]=(e._frame.x+h+u)/o.width,l[1]=(e._frame.y+h+u)/o.height,l[2]=(e._frame.x+e._frame.width-h+u)/o.width,l[3]=(e._frame.y+e._frame.height-h+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,!0},fg(r,[{key:"texture",get:function(){return this._texture},set:function(i){this._texture=i,this._lastTextureID=-1}}]),r}();Wi.default=pg;Xi.__esModule=!0;var mg=Vi,gg=Th(mg),vg=vt,yg=Wi,Tg=Th(yg);function Th(r){return r&&r.__esModule?r:{default:r}}function xg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function wg(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function bg(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Eg=function(r){bg(t,r);function t(i){xg(this,t);var e=new vg.Matrix,n=wg(this,r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);

    original *= (masky.r * masky.a * alpha * clip);

    gl_FragColor = original;
}
`));return i.renderable=!1,n.maskSprite=i,n.maskMatrix=e,n}return t.prototype.apply=function(e,n,a,s){var o=this.maskSprite,l=this.maskSprite.texture;l.valid&&(l.transform||(l.transform=new Tg.default(l,0)),l.transform.update(),this.uniforms.mask=l,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(l.transform.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=l.transform.uClampFrame,e.applyFilter(this,n,a,s))},t}(gg.default);Xi.default=Eg;qa.__esModule=!0;var Sg=Pe,Dg=xh(Sg),Ag=Xi,Mg=xh(Ag);function xh(r){return r&&r.__esModule?r:{default:r}}function Og(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Pg(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Rg(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Ig=function(r){Rg(t,r);function t(i){Og(this,t);var e=Pg(this,r.call(this,i));return e.scissor=!1,e.scissorData=null,e.scissorRenderTarget=null,e.enableScissor=!0,e.alphaMaskPool=[],e.alphaMaskIndex=0,e}return t.prototype.pushMask=function(e,n){if(n.texture)this.pushSpriteMask(e,n);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&n.isFastRect()){var a=n.worldTransform,s=Math.atan2(a.b,a.a);s=Math.round(s*(180/Math.PI)),s%90?this.pushStencilMask(n):this.pushScissorMask(e,n)}else this.pushStencilMask(n)},t.prototype.popMask=function(e,n){n.texture?this.popSpriteMask(e,n):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(e,n):this.popStencilMask(e,n)},t.prototype.pushSpriteMask=function(e,n){var a=this.alphaMaskPool[this.alphaMaskIndex];a||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new Mg.default(n)]),a[0].resolution=this.renderer.resolution,a[0].maskSprite=n;var s=e.filterArea;e.filterArea=n.getBounds(!0),this.renderer.filterManager.pushFilter(e,a),e.filterArea=s,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},t.prototype.pushStencilMask=function(e){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(e)},t.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},t.prototype.pushScissorMask=function(e,n){n.renderable=!0;var a=this.renderer._activeRenderTarget,s=n.getBounds();s.fit(a.size),n.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var o=this.renderer.resolution;this.renderer.gl.scissor(s.x*o,(a.root?a.size.height-s.y-s.height:s.y)*o,s.width*o,s.height*o),this.scissorRenderTarget=a,this.scissorData=n,this.scissor=!0},t.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var e=this.renderer.gl;e.disable(e.SCISSOR_TEST)},t}(Dg.default);qa.default=Ig;var Za={};Za.__esModule=!0;var Cg=Pe,Uo=Fg(Cg);function Fg(r){return r&&r.__esModule?r:{default:r}}function Bg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Lg(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Ng(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var kg=function(r){Ng(t,r);function t(i){Bg(this,t);var e=Lg(this,r.call(this,i));return e.stencilMaskStack=null,e}return t.prototype.setMaskStack=function(e){this.stencilMaskStack=e;var n=this.renderer.gl;e.length===0?n.disable(n.STENCIL_TEST):n.enable(n.STENCIL_TEST)},t.prototype.pushStencil=function(e){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var n=this.renderer.gl,a=this.stencilMaskStack.length;a===0&&n.enable(n.STENCIL_TEST),this.stencilMaskStack.push(e),n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,a,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),this.renderer.plugins.graphics.render(e),this._useCurrent()},t.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var e=this.renderer.gl,n=this.stencilMaskStack.pop();this.stencilMaskStack.length===0?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),this.renderer.plugins.graphics.render(n),this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},t.prototype.destroy=function(){Uo.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},t}(Uo.default);Za.default=kg;var Qa={},We={};We.__esModule=!0;var Rn=vt,Ug=W,$g=_t,$o=Gg($g),Go=At;function Gg(r){return r&&r.__esModule?r:{default:r}}function Xg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Vg=function(){function r(t,i,e,n,a,s){Xg(this,r),this.gl=t,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new Rn.Rectangle(0,0,1,1),this.resolution=a||$o.default.RESOLUTION,this.projectionMatrix=new Rn.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new Rn.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=n!==void 0?n:$o.default.SCALE_MODE,this.root=s||!1,this.root?(this.frameBuffer=new Go.GLFramebuffer(t,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=Go.GLFramebuffer.createRGBA(t,100,100),this.scaleMode===Ug.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(i,e)}return r.prototype.clear=function(i){var e=i||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},r.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},r.prototype.setFrame=function(i,e){this.destinationFrame=i||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},r.prototype.activate=function(){var i=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(i.enable(i.SCISSOR_TEST),i.scissor(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):i.disable(i.SCISSOR_TEST),i.viewport(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},r.prototype.calculateProjection=function(i,e){var n=this.projectionMatrix;e=e||i,n.identity(),this.root?(n.a=1/i.width*2,n.d=-1/i.height*2,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/i.width*2,n.d=1/i.height*2,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},r.prototype.resize=function(i,e){if(i=i|0,e=e|0,!(this.size.width===i&&this.size.height===e)){this.size.width=i,this.size.height=e,this.defaultFrame.width=i,this.defaultFrame.height=e,this.frameBuffer.resize(i*this.resolution,e*this.resolution);var n=this.frame||this.size;this.calculateProjection(n)}},r.prototype.destroy=function(){this.frameBuffer.stencil&&this.gl.deleteRenderbuffer(this.frameBuffer.stencil),this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},r}();We.default=Vg;var Hi={},Lr={};Lr.__esModule=!0;Lr.default=Wg;function Wg(r){for(var t=r*6,i=new Uint16Array(t),e=0,n=0;e<t;e+=6,n+=4)i[e+0]=n+0,i[e+1]=n+1,i[e+2]=n+2,i[e+3]=n+0,i[e+4]=n+2,i[e+5]=n+3;return i}Hi.__esModule=!0;var Hg=At,In=wh(Hg),Yg=Lr,zg=wh(Yg);function wh(r){return r&&r.__esModule?r:{default:r}}function qg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Kg=function(){function r(t,i){qg(this,r),this.gl=t,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(8*2);for(var e=0;e<4;e++)this.interleaved[e*4]=this.vertices[e*2],this.interleaved[e*4+1]=this.vertices[e*2+1],this.interleaved[e*4+2]=this.uvs[e*2],this.interleaved[e*4+3]=this.uvs[e*2+1];this.indices=(0,zg.default)(1),this.vertexBuffer=In.default.GLBuffer.createVertexBuffer(t,this.interleaved,t.STATIC_DRAW),this.indexBuffer=In.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.vao=new In.default.VertexArrayObject(t,i)}return r.prototype.initVao=function(i){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,i.attributes.aVertexPosition,this.gl.FLOAT,!1,4*4,0).addAttribute(this.vertexBuffer,i.attributes.aTextureCoord,this.gl.FLOAT,!1,4*4,2*4)},r.prototype.map=function(i,e){var n=0,a=0;return this.uvs[0]=n,this.uvs[1]=a,this.uvs[2]=n+e.width/i.width,this.uvs[3]=a,this.uvs[4]=n+e.width/i.width,this.uvs[5]=a+e.height/i.height,this.uvs[6]=n,this.uvs[7]=a+e.height/i.height,n=e.x,a=e.y,this.vertices[0]=n,this.vertices[1]=a,this.vertices[2]=n+e.width,this.vertices[3]=a,this.vertices[4]=n+e.width,this.vertices[5]=a+e.height,this.vertices[6]=n,this.vertices[7]=a+e.height,this},r.prototype.upload=function(){for(var i=0;i<4;i++)this.interleaved[i*4]=this.vertices[i*2],this.interleaved[i*4+1]=this.vertices[i*2+1],this.interleaved[i*4+2]=this.uvs[i*2],this.interleaved[i*4+3]=this.uvs[i*2+1];return this.vertexBuffer.upload(this.interleaved),this},r.prototype.destroy=function(){var i=this.gl;i.deleteBuffer(this.vertexBuffer),i.deleteBuffer(this.indexBuffer)},r}();Hi.default=Kg;var Re={};Re.__esModule=!0;var Zg=At,Qg=_t,Xo=Jg(Qg);function Jg(r){return r&&r.__esModule?r:{default:r}}function jg(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function tv(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function ev(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}function Vo(r,t){if(r instanceof Array){if(r[0].substring(0,9)!=="precision"){var i=r.slice(0);return i.unshift("precision "+t+" float;"),i}}else if(r.trim().substring(0,9)!=="precision")return"precision "+t+` float;
`+r;return r}var rv=function(r){ev(t,r);function t(i,e,n,a,s){return jg(this,t),tv(this,r.call(this,i,Vo(e,s||Xo.default.PRECISION_VERTEX),Vo(n,s||Xo.default.PRECISION_FRAGMENT),void 0,a))}return t}(Zg.GLShader);Re.default=rv;var Nr={};Nr.__esModule=!0;Nr.calculateScreenSpaceMatrix=nv;Nr.calculateNormalizedScreenSpaceMatrix=av;Nr.calculateSpriteMatrix=sv;var iv=vt;function nv(r,t,i){var e=r.identity();return e.translate(t.x/i.width,t.y/i.height),e.scale(i.width,i.height),e}function av(r,t,i){var e=r.identity();e.translate(t.x/i.width,t.y/i.height);var n=i.width/t.width,a=i.height/t.height;return e.scale(n,a),e}function sv(r,t,i,e){var n=e._texture.orig,a=r.set(i.width,0,0,i.height,t.x,t.y),s=e.worldTransform.copy(iv.Matrix.TEMP_MATRIX);return s.invert(),a.prepend(s),a.scale(1/n.width,1/n.height),a.translate(e.anchor.x,e.anchor.y),a}Qa.__esModule=!0;var ov=Pe,lv=kr(ov),hv=We,uv=kr(hv),fv=Hi,cv=kr(fv),Wo=vt,dv=Re,Ho=kr(dv),_v=Nr,Cn=mv(_v),pv=ht,Yo=kr(pv);function mv(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function kr(r){return r&&r.__esModule?r:{default:r}}function gv(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function vv(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}function bh(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var zo=function(){function r(){bh(this,r),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new Wo.Rectangle,this.destinationFrame=new Wo.Rectangle,this.filters=[]}return r.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},r}(),Fn="screen",yv=function(r){vv(t,r);function t(i){bh(this,t);var e=gv(this,r.call(this,i));return e.gl=e.renderer.gl,e.quad=new cv.default(e.gl,i.state.attribState),e.shaderCache={},e.pool={},e.filterData=null,e.managedFilters=[],e.renderer.on("prerender",e.onPrerender,e),e._screenWidth=i.view.width,e._screenHeight=i.view.height,e}return t.prototype.pushFilter=function(e,n){var a=this.renderer,s=this.filterData;if(!s){s=this.renderer._activeRenderTarget.filterStack;var o=new zo;o.sourceFrame=o.destinationFrame=this.renderer._activeRenderTarget.size,o.renderTarget=a._activeRenderTarget,this.renderer._activeRenderTarget.filterData=s={index:0,stack:[o]},this.filterData=s}var l=s.stack[++s.index],h=s.stack[0].destinationFrame;l||(l=s.stack[s.index]=new zo);var u=e.filterArea&&e.filterArea.x===0&&e.filterArea.y===0&&e.filterArea.width===a.screen.width&&e.filterArea.height===a.screen.height,f=n[0].resolution,d=n[0].padding|0,p=u?a.screen:e.filterArea||e.getBounds(!0),_=l.sourceFrame,m=l.destinationFrame;_.x=(p.x*f|0)/f,_.y=(p.y*f|0)/f,_.width=(p.width*f|0)/f,_.height=(p.height*f|0)/f,u||(s.stack[0].renderTarget.transform||n[0].autoFit&&_.fit(h),_.pad(d)),m.width=_.width,m.height=_.height;var g=this.getPotRenderTarget(a.gl,_.width,_.height,f);l.target=e,l.filters=n,l.resolution=f,l.renderTarget=g,g.setFrame(m,_),a.bindRenderTarget(g),g.clear()},t.prototype.popFilter=function(){var e=this.filterData,n=e.stack[e.index-1],a=e.stack[e.index];this.quad.map(a.renderTarget.size,a.sourceFrame).upload();var s=a.filters;if(s.length===1)s[0].apply(this,a.renderTarget,n.renderTarget,!1,a),this.freePotRenderTarget(a.renderTarget);else{var o=a.renderTarget,l=this.getPotRenderTarget(this.renderer.gl,a.sourceFrame.width,a.sourceFrame.height,a.resolution);l.setFrame(a.destinationFrame,a.sourceFrame),l.clear();var h=0;for(h=0;h<s.length-1;++h){s[h].apply(this,o,l,!0,a);var u=o;o=l,l=u}s[h].apply(this,o,n.renderTarget,!1,a),this.freePotRenderTarget(o),this.freePotRenderTarget(l)}a.clear(),e.index--,e.index===0&&(this.filterData=null)},t.prototype.applyFilter=function(e,n,a,s){var o=this.renderer,l=o.gl,h=e.glShaders[o.CONTEXT_UID];h||(e.glShaderKey?(h=this.shaderCache[e.glShaderKey],h||(h=new Ho.default(this.gl,e.vertexSrc,e.fragmentSrc),e.glShaders[o.CONTEXT_UID]=this.shaderCache[e.glShaderKey]=h,this.managedFilters.push(e))):(h=e.glShaders[o.CONTEXT_UID]=new Ho.default(this.gl,e.vertexSrc,e.fragmentSrc),this.managedFilters.push(e)),o.bindVao(null),this.quad.initVao(h)),o.bindVao(this.quad.vao),o.bindRenderTarget(a),s&&(l.disable(l.SCISSOR_TEST),o.clear(),l.enable(l.SCISSOR_TEST)),a===o.maskManager.scissorRenderTarget&&o.maskManager.pushScissorMask(null,o.maskManager.scissorData),o.bindShader(h);var u=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=u,this.syncUniforms(h,e),o.state.setBlendMode(e.blendMode),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,n.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),l.bindTexture(l.TEXTURE_2D,u._glTextures[this.renderer.CONTEXT_UID].texture)},t.prototype.syncUniforms=function(e,n){var a=n.uniformData,s=n.uniforms,o=1,l=void 0;if(e.uniforms.filterArea){l=this.filterData.stack[this.filterData.index];var h=e.uniforms.filterArea;h[0]=l.renderTarget.size.width,h[1]=l.renderTarget.size.height,h[2]=l.sourceFrame.x,h[3]=l.sourceFrame.y,e.uniforms.filterArea=h}if(e.uniforms.filterClamp){l=l||this.filterData.stack[this.filterData.index];var u=e.uniforms.filterClamp;u[0]=0,u[1]=0,u[2]=(l.sourceFrame.width-1)/l.renderTarget.size.width,u[3]=(l.sourceFrame.height-1)/l.renderTarget.size.height,e.uniforms.filterClamp=u}for(var f in a)if(e.uniforms.data[f]){var d=a[f].type;if(d==="sampler2d"&&s[f]!==0){if(s[f].baseTexture)e.uniforms[f]=this.renderer.bindTexture(s[f].baseTexture,o);else{e.uniforms[f]=o;var p=this.renderer.gl;this.renderer.boundTextures[o]=this.renderer.emptyTextures[o],p.activeTexture(p.TEXTURE0+o),s[f].texture.bind()}o++}else if(d==="mat3")s[f].a!==void 0?e.uniforms[f]=s[f].toArray(!0):e.uniforms[f]=s[f];else if(d==="vec2")if(s[f].x!==void 0){var _=e.uniforms[f]||new Float32Array(2);_[0]=s[f].x,_[1]=s[f].y,e.uniforms[f]=_}else e.uniforms[f]=s[f];else d==="float"?e.uniforms.data[f].value!==a[f]&&(e.uniforms[f]=s[f]):e.uniforms[f]=s[f]}},t.prototype.getRenderTarget=function(e,n){var a=this.filterData.stack[this.filterData.index],s=this.getPotRenderTarget(this.renderer.gl,a.sourceFrame.width,a.sourceFrame.height,n||a.resolution);return s.setFrame(a.destinationFrame,a.sourceFrame),s},t.prototype.returnRenderTarget=function(e){this.freePotRenderTarget(e)},t.prototype.calculateScreenSpaceMatrix=function(e){var n=this.filterData.stack[this.filterData.index];return Cn.calculateScreenSpaceMatrix(e,n.sourceFrame,n.renderTarget.size)},t.prototype.calculateNormalizedScreenSpaceMatrix=function(e){var n=this.filterData.stack[this.filterData.index];return Cn.calculateNormalizedScreenSpaceMatrix(e,n.sourceFrame,n.renderTarget.size,n.destinationFrame)},t.prototype.calculateSpriteMatrix=function(e,n){var a=this.filterData.stack[this.filterData.index];return Cn.calculateSpriteMatrix(e,a.sourceFrame,a.renderTarget.size,n)},t.prototype.destroy=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.renderer,a=this.managedFilters;n.off("prerender",this.onPrerender,this);for(var s=0;s<a.length;s++)e||a[s].glShaders[n.CONTEXT_UID].destroy(),delete a[s].glShaders[n.CONTEXT_UID];this.shaderCache={},e?this.pool={}:this.emptyPool()},t.prototype.getPotRenderTarget=function(e,n,a,s){var o=Fn;n*=s,a*=s,(n!==this._screenWidth||a!==this._screenHeight)&&(n=Yo.default.nextPow2(n),a=Yo.default.nextPow2(a),o=(n&65535)<<16|a&65535),this.pool[o]||(this.pool[o]=[]);var l=this.pool[o].pop();if(!l){var h=this.renderer.boundTextures[0];e.activeTexture(e.TEXTURE0),l=new uv.default(e,n,a,null,1),e.bindTexture(e.TEXTURE_2D,h._glTextures[this.renderer.CONTEXT_UID].texture)}return l.resolution=s,l.defaultFrame.width=l.size.width=n/s,l.defaultFrame.height=l.size.height=a/s,l.filterPoolKey=o,l},t.prototype.emptyPool=function(){for(var e in this.pool){var n=this.pool[e];if(n)for(var a=0;a<n.length;a++)n[a].destroy(!0)}this.pool={}},t.prototype.freePotRenderTarget=function(e){this.pool[e.filterPoolKey].push(e)},t.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var e=this.pool[Fn];if(e)for(var n=0;n<e.length;n++)e[n].destroy(!0);this.pool[Fn]=[]}},t}(lv.default);Qa.default=yv;var Ja={};Ja.__esModule=!0;var Tv=At,Bn=W,xv=We,wv=Ev(xv),bv=X;function Ev(r){return r&&r.__esModule?r:{default:r}}function Sv(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Dv=function(){function r(t){Sv(this,r),this.renderer=t,this.gl=t.gl,this._managedTextures=[]}return r.prototype.bindTexture=function(){},r.prototype.getTexture=function(){},r.prototype.updateTexture=function(i,e){var n=this.gl,a=!!i._glRenderTargets;if(!i.hasLoaded)return null;var s=this.renderer.boundTextures;if(e===void 0){e=0;for(var o=0;o<s.length;++o)if(s[o]===i){e=o;break}}s[e]=i,n.activeTexture(n.TEXTURE0+e);var l=i._glTextures[this.renderer.CONTEXT_UID];if(l)a?i._glRenderTargets[this.renderer.CONTEXT_UID].resize(i.width,i.height):l.upload(i.source);else{if(a){var h=new wv.default(this.gl,i.width,i.height,i.scaleMode,i.resolution);h.resize(i.width,i.height),i._glRenderTargets[this.renderer.CONTEXT_UID]=h,l=h.texture,this.renderer._activeRenderTarget.root||this.renderer._activeRenderTarget.frameBuffer.bind()}else l=new Tv.GLTexture(this.gl,null,null,null,null),l.bind(e),l.premultiplyAlpha=!0,l.upload(i.source);i._glTextures[this.renderer.CONTEXT_UID]=l,i.on("update",this.updateTexture,this),i.on("dispose",this.destroyTexture,this),this._managedTextures.push(i),i.isPowerOfTwo?(i.mipmap&&l.enableMipmap(),i.wrapMode===Bn.WRAP_MODES.CLAMP?l.enableWrapClamp():i.wrapMode===Bn.WRAP_MODES.REPEAT?l.enableWrapRepeat():l.enableWrapMirrorRepeat()):l.enableWrapClamp(),i.scaleMode===Bn.SCALE_MODES.NEAREST?l.enableNearestScaling():l.enableLinearScaling()}return l},r.prototype.destroyTexture=function(i,e){if(i=i.baseTexture||i,!!i.hasLoaded){var n=this.renderer,a=n.CONTEXT_UID,s=i._glTextures,o=i._glRenderTargets;if(s[a]&&(n.unbindTexture(i),s[a].destroy(),i.off("update",this.updateTexture,this),i.off("dispose",this.destroyTexture,this),delete s[a],!e)){var l=this._managedTextures.indexOf(i);l!==-1&&(0,bv.removeItems)(this._managedTextures,l,1)}o&&o[a]&&(n._activeRenderTarget===o[a]&&n.bindRenderTarget(n.rootRenderTarget),o[a].destroy(),delete o[a])}},r.prototype.removeAll=function(){for(var i=0;i<this._managedTextures.length;++i){var e=this._managedTextures[i];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},r.prototype.destroy=function(){for(var i=0;i<this._managedTextures.length;++i){var e=this._managedTextures[i];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},r}();Ja.default=Dv;var ja={};ja.__esModule=!0;var Av=W,Mv=_t,Ln=Ov(Mv);function Ov(r){return r&&r.__esModule?r:{default:r}}function Pv(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Rv=function(){function r(t){Pv(this,r),this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Ln.default.GC_MAX_IDLE,this.checkCountMax=Ln.default.GC_MAX_CHECK_COUNT,this.mode=Ln.default.GC_MODE}return r.prototype.update=function(){this.count++,this.mode!==Av.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},r.prototype.run=function(){for(var i=this.renderer.textureManager,e=i._managedTextures,n=!1,a=0;a<e.length;a++){var s=e[a];!s._glRenderTargets&&this.count-s.touched>this.maxIdle&&(i.destroyTexture(s,!0),e[a]=null,n=!0)}if(n){for(var o=0,l=0;l<e.length;l++)e[l]!==null&&(e[o++]=e[l]);e.length=o}},r.prototype.unload=function(i){var e=this.renderer.textureManager;i._texture&&i._texture._glRenderTargets&&e.destroyTexture(i._texture,!0);for(var n=i.children.length-1;n>=0;n--)this.unload(i.children[n])},r}();ja.default=Rv;var ts={},es={};es.__esModule=!0;es.default=Iv;var dt=W;function Iv(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t[dt.BLEND_MODES.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.ADD]=[r.ONE,r.ONE],t[dt.BLEND_MODES.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[dt.BLEND_MODES.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[dt.BLEND_MODES.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t}ts.__esModule=!0;var Cv=es,Fv=Bv(Cv);function Bv(r){return r&&r.__esModule?r:{default:r}}function Lv(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Nn=0,kn=1,Un=2,$n=3,Gn=4,Nv=function(){function r(t){Lv(this,r),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=t,this.maxAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,Fv.default)(t),this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")}return r.prototype.push=function(){var i=this.stack[this.stackIndex];i||(i=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)i[e]=this.activeState[e]},r.prototype.pop=function(){var i=this.stack[--this.stackIndex];this.setState(i)},r.prototype.setState=function(i){this.setBlend(i[Nn]),this.setDepthTest(i[kn]),this.setFrontFace(i[Un]),this.setCullFace(i[$n]),this.setBlendMode(i[Gn])},r.prototype.setBlend=function(i){i=i?1:0,this.activeState[Nn]!==i&&(this.activeState[Nn]=i,this.gl[i?"enable":"disable"](this.gl.BLEND))},r.prototype.setBlendMode=function(i){if(i!==this.activeState[Gn]){this.activeState[Gn]=i;var e=this.blendModes[i];e.length===2?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},r.prototype.setDepthTest=function(i){i=i?1:0,this.activeState[kn]!==i&&(this.activeState[kn]=i,this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST))},r.prototype.setCullFace=function(i){i=i?1:0,this.activeState[$n]!==i&&(this.activeState[$n]=i,this.gl[i?"enable":"disable"](this.gl.CULL_FACE))},r.prototype.setFrontFace=function(i){i=i?1:0,this.activeState[Un]!==i&&(this.activeState[Un]=i,this.gl.frontFace(this.gl[i?"CW":"CCW"]))},r.prototype.resetAttributes=function(){for(var i=0;i<this.attribState.tempAttribState.length;i++)this.attribState.tempAttribState[i]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var n=1;n<this.maxAttribs;n++)this.gl.disableVertexAttribArray(n)},r.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var i=0;i<this.activeState.length;++i)this.activeState[i]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},r}();ts.default=Nv;var rs={};rs.__esModule=!0;rs.default=kv;var me=W;function kv(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t[me.DRAW_MODES.POINTS]=r.POINTS,t[me.DRAW_MODES.LINES]=r.LINES,t[me.DRAW_MODES.LINE_LOOP]=r.LINE_LOOP,t[me.DRAW_MODES.LINE_STRIP]=r.LINE_STRIP,t[me.DRAW_MODES.TRIANGLES]=r.TRIANGLES,t[me.DRAW_MODES.TRIANGLE_STRIP]=r.TRIANGLE_STRIP,t[me.DRAW_MODES.TRIANGLE_FAN]=r.TRIANGLE_FAN,t}var is={};is.__esModule=!0;is.default=Uv;function Uv(r){var t=r.getContextAttributes();t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}Ve.__esModule=!0;var $v=Ni,qo=Pt($v),Gv=qa,Xv=Pt(Gv),Vv=Za,Wv=Pt(Vv),Hv=Qa,Yv=Pt(Hv),zv=We,qv=Pt(zv),Kv=Xe,Zv=Pt(Kv),Qv=Ja,Jv=Pt(Qv),jv=de,ty=Pt(jv),ey=ja,ry=Pt(ey),iy=ts,ny=Pt(iy),ay=rs,sy=Pt(ay),oy=is,ly=Pt(oy),hy=X,uy=At,ri=Pt(uy),fy=W;function Pt(r){return r&&r.__esModule?r:{default:r}}function cy(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function dy(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function _y(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var py=0,Eh=function(r){_y(t,r);function t(i,e,n){cy(this,t);var a=dy(this,r.call(this,"WebGL",i,e,n));return a.legacy=a.options.legacy,a.legacy&&(ri.default.VertexArrayObject.FORCE_NATIVE=!0),a.type=fy.RENDERER_TYPE.WEBGL,a.handleContextLost=a.handleContextLost.bind(a),a.handleContextRestored=a.handleContextRestored.bind(a),a.view.addEventListener("webglcontextlost",a.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",a.handleContextRestored,!1),a._contextOptions={alpha:a.transparent,antialias:a.options.antialias,premultipliedAlpha:a.transparent&&a.transparent!=="notMultiplied",stencil:!0,preserveDrawingBuffer:a.options.preserveDrawingBuffer,powerPreference:a.options.powerPreference},a._backgroundColorRgba[3]=a.transparent?0:1,a.maskManager=new Xv.default(a),a.stencilManager=new Wv.default(a),a.emptyRenderer=new Zv.default(a),a.currentRenderer=a.emptyRenderer,a.textureManager=null,a.filterManager=null,a.initPlugins(),a.options.context&&(0,ly.default)(a.options.context),a.gl=a.options.context||ri.default.createContext(a.view,a._contextOptions),a.CONTEXT_UID=py++,a.state=new ny.default(a.gl),a.renderingToScreen=!0,a.boundTextures=null,a._activeShader=null,a._activeVao=null,a._activeRenderTarget=null,a._initContext(),a.drawModes=(0,sy.default)(a.gl),a._nextTextureLocation=0,a.setBlendMode(0),a}return t.prototype._initContext=function(){var e=this.gl;e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext();var n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(n),this.emptyTextures=new Array(n),this._unknownBoundTextures=!1,this.textureManager=new Jv.default(this),this.filterManager=new Yv.default(this),this.textureGC=new ry.default(this),this.state.resetToDefault(),this.rootRenderTarget=new qv.default(e,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var a=new ri.default.GLTexture.fromData(e,null,1,1),s={_glTextures:{}};s._glTextures[this.CONTEXT_UID]={};for(var o=0;o<n;o++){var l=new ty.default;l._glTextures[this.CONTEXT_UID]=a,this.boundTextures[o]=s,this.emptyTextures[o]=l,this.bindTexture(null,o)}this.emit("context",e),this.resize(this.screen.width,this.screen.height)},t.prototype.render=function(e,n,a,s,o){if(this.renderingToScreen=!n,this.emit("prerender"),!(!this.gl||this.gl.isContextLost())){if(this._nextTextureLocation=0,n||(this._lastObjectRendered=e),!o){var l=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=l}this.bindRenderTexture(n,s),this.currentRenderer.start(),(a!==void 0?a:this.clearBeforeRender)&&this._activeRenderTarget.clear(),e.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.resize=function(e,n){qo.default.prototype.resize.call(this,e,n),this.rootRenderTarget.resize(e,n),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},t.prototype.setBlendMode=function(e){this.state.setBlendMode(e)},t.prototype.clear=function(e){this._activeRenderTarget.clear(e)},t.prototype.setTransform=function(e){this._activeRenderTarget.transform=e},t.prototype.clearRenderTexture=function(e,n){var a=e.baseTexture,s=a._glRenderTargets[this.CONTEXT_UID];return s&&s.clear(n),this},t.prototype.bindRenderTexture=function(e,n){var a=void 0;if(e){var s=e.baseTexture;s._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(s,0),this.unbindTexture(s),a=s._glRenderTargets[this.CONTEXT_UID],a.setFrame(e.frame)}else a=this.rootRenderTarget;return a.transform=n,this.bindRenderTarget(a),this},t.prototype.bindRenderTarget=function(e){return e!==this._activeRenderTarget&&(this._activeRenderTarget=e,e.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=e.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(e.stencilMaskStack)),this},t.prototype.bindShader=function(e,n){return this._activeShader!==e&&(this._activeShader=e,e.bind(),n!==!1&&(e.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},t.prototype.bindTexture=function(e,n,a){if(e=e||this.emptyTextures[n],e=e.baseTexture||e,e.touched=this.textureGC.count,a)n=n||0;else{for(var s=0;s<this.boundTextures.length;s++)if(this.boundTextures[s]===e)return s;n===void 0&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,n=this.boundTextures.length-this._nextTextureLocation-1)}var o=this.gl,l=e._glTextures[this.CONTEXT_UID];return l?(this.boundTextures[n]=e,o.activeTexture(o.TEXTURE0+n),o.bindTexture(o.TEXTURE_2D,l.texture)):this.textureManager.updateTexture(e,n),n},t.prototype.unbindTexture=function(e){var n=this.gl;if(e=e.baseTexture||e,this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var a=0;a<this.boundTextures.length;a++)this.boundTextures[a]===this.emptyTextures[a]&&(n.activeTexture(n.TEXTURE0+a),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[a]._glTextures[this.CONTEXT_UID].texture))}for(var s=0;s<this.boundTextures.length;s++)this.boundTextures[s]===e&&(this.boundTextures[s]=this.emptyTextures[s],n.activeTexture(n.TEXTURE0+s),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[s]._glTextures[this.CONTEXT_UID].texture));return this},t.prototype.createVao=function(){return new ri.default.VertexArrayObject(this.gl,this.state.attribState)},t.prototype.bindVao=function(e){return this._activeVao===e?this:(e?e.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=e,this)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this._unknownBoundTextures=!0;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.emptyTextures[e];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},t.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),r.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},t}(qo.default);Ve.default=Eh;hy.pluginTarget.mixin(Eh);var ns={};ns.__esModule=!0;ns.default=Ty;var my=Re,gy=vy(my);function vy(r){return r&&r.__esModule?r:{default:r}}var yy=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join(`
`);function Ty(r,t){var i=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor;
}
`,e=yy;e=e.replace(/%count%/gi,t),e=e.replace(/%forloop%/gi,xy(t));for(var n=new gy.default(r,i,e),a=[],s=0;s<t;s++)a[s]=s;return n.bind(),n.uniforms.uSamplers=a,n}function xy(r){var t="";t+=`
`,t+=`
`;for(var i=0;i<r;i++)i>0&&(t+=`
else `),i<r-1&&(t+="if(vTextureId < "+i+".5)"),t+=`
{`,t+=`
	color = texture2D(uSamplers[`+i+"], vTextureCoord);",t+=`
}`;return t+=`
`,t+=`
`,t}var as={};as.__esModule=!0;as.default=Dy;var wy=At,by=Ey(wy);function Ey(r){return r&&r.__esModule?r:{default:r}}var Sy=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Dy(r,t){var i=!t;if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(i){var e=document.createElement("canvas");e.width=1,e.height=1,t=by.default.createContext(e)}for(var n=t.createShader(t.FRAGMENT_SHADER);;){var a=Sy.replace(/%forloop%/gi,Ay(r));if(t.shaderSource(n,a),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))r=r/2|0;else break}return i&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),r}function Ay(r){for(var t="",i=0;i<r;++i)i>0&&(t+=`
else `),i<r-1&&(t+="if(test == "+i+".0){}");return t}var ss={};ss.__esModule=!0;function My(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Oy=function(){function r(t){My(this,r),this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return r.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},r}();ss.default=Oy;za.__esModule=!0;var Py=Xe,Ry=te(Py),Iy=Ve,Cy=te(Iy),Fy=Lr,By=te(Fy),Ly=ns,Ny=te(Ly),ky=as,Uy=te(ky),$y=ss,Gy=te($y),Xy=_t,ii=te(Xy),Xn=X,Vy=At,Vn=te(Vy),Wy=ht,Wn=te(Wy);function te(r){return r&&r.__esModule?r:{default:r}}function Hy(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Yy(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function zy(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var zt=0,Ko=0,Sh=function(r){zy(t,r);function t(i){Hy(this,t);var e=Yy(this,r.call(this,i));e.vertSize=5,e.vertByteSize=e.vertSize*4,e.size=ii.default.SPRITE_BATCH_SIZE,e.buffers=[];for(var n=1;n<=Wn.default.nextPow2(e.size);n*=2)e.buffers.push(new Gy.default(n*4*e.vertByteSize));e.indices=(0,By.default)(e.size),e.shader=null,e.currentIndex=0,e.groups=[];for(var a=0;a<e.size;a++)e.groups[a]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return e.sprites=[],e.vertexBuffers=[],e.vaos=[],e.vaoMax=2,e.vertexCount=0,e.renderer.on("prerender",e.onPrerender,e),e}return t.prototype.onContextChange=function(){var e=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),ii.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,Uy.default)(this.MAX_TEXTURES,e)),this.shader=(0,Ny.default)(e,this.MAX_TEXTURES),this.indexBuffer=Vn.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.renderer.bindVao(null);for(var n=this.shader.attributes,a=0;a<this.vaoMax;a++){var s=this.vertexBuffers[a]=Vn.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),o=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(s,n.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(s,n.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,2*4).addAttribute(s,n.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,3*4);n.aTextureId&&o.addAttribute(s,n.aTextureId,e.FLOAT,!1,this.vertByteSize,4*4),this.vaos[a]=o}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},t.prototype.onPrerender=function(){this.vertexCount=0},t.prototype.render=function(e){this.currentIndex>=this.size&&this.flush(),e._texture._uvs&&(this.sprites[this.currentIndex++]=e)},t.prototype.flush=function(){if(this.currentIndex!==0){var e=this.renderer.gl,n=this.MAX_TEXTURES,a=Wn.default.nextPow2(this.currentIndex),s=Wn.default.log2(a),o=this.buffers[s],l=this.sprites,h=this.groups,u=o.float32View,f=o.uint32View,d=this.boundTextures,p=this.renderer.boundTextures,_=this.renderer.textureGC.count,m=0,g=void 0,y=void 0,w=1,T=0,x=h[0],E=void 0,b=void 0,D=Xn.premultiplyBlendMode[l[0]._texture.baseTexture.premultipliedAlpha?1:0][l[0].blendMode];x.textureCount=0,x.start=0,x.blend=D,zt++;var S=void 0;for(S=0;S<n;++S){var M=p[S];if(M._enabled===zt){d[S]=this.renderer.emptyTextures[S];continue}d[S]=M,M._virtalBoundId=S,M._enabled=zt}for(zt++,S=0;S<this.currentIndex;++S){var O=l[S];l[S]=null,g=O._texture.baseTexture;var F=Xn.premultiplyBlendMode[Number(g.premultipliedAlpha)][O.blendMode];if(D!==F&&(D=F,y=null,T=n,zt++),y!==g&&(y=g,g._enabled!==zt)){if(T===n&&(zt++,x.size=S-x.start,T=0,x=h[w++],x.blend=D,x.textureCount=0,x.start=S),g.touched=_,g._virtalBoundId===-1)for(var L=0;L<n;++L){var B=(L+Ko)%n,I=d[B];if(I._enabled!==zt){Ko++,I._virtalBoundId=-1,g._virtalBoundId=B,d[B]=g;break}}g._enabled=zt,x.textureCount++,x.ids[T]=g._virtalBoundId,x.textures[T++]=g}if(E=O.vertexData,b=O._texture._uvs.uvsUint32,this.renderer.roundPixels){var U=this.renderer.resolution;u[m]=(E[0]*U|0)/U,u[m+1]=(E[1]*U|0)/U,u[m+5]=(E[2]*U|0)/U,u[m+6]=(E[3]*U|0)/U,u[m+10]=(E[4]*U|0)/U,u[m+11]=(E[5]*U|0)/U,u[m+15]=(E[6]*U|0)/U,u[m+16]=(E[7]*U|0)/U}else u[m]=E[0],u[m+1]=E[1],u[m+5]=E[2],u[m+6]=E[3],u[m+10]=E[4],u[m+11]=E[5],u[m+15]=E[6],u[m+16]=E[7];f[m+2]=b[0],f[m+7]=b[1],f[m+12]=b[2],f[m+17]=b[3];var G=Math.min(O.worldAlpha,1),$=G<1&&g.premultipliedAlpha?(0,Xn.premultiplyTint)(O._tintRGB,G):O._tintRGB+(G*255<<24);f[m+3]=f[m+8]=f[m+13]=f[m+18]=$,u[m+4]=u[m+9]=u[m+14]=u[m+19]=g._virtalBoundId,m+=20}if(x.size=S-x.start,ii.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var k=this.shader.attributes,q=this.vertexBuffers[this.vertexCount]=Vn.default.GLBuffer.createVertexBuffer(e,null,e.STREAM_DRAW),z=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(q,k.aVertexPosition,e.FLOAT,!1,this.vertByteSize,0).addAttribute(q,k.aTextureCoord,e.UNSIGNED_SHORT,!0,this.vertByteSize,2*4).addAttribute(q,k.aColor,e.UNSIGNED_BYTE,!0,this.vertByteSize,3*4);k.aTextureId&&z.addAttribute(q,k.aTextureId,e.FLOAT,!1,this.vertByteSize,4*4),this.vaos[this.vertexCount]=z}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!1),this.vertexCount++}for(S=0;S<n;++S)p[S]._virtalBoundId=-1;for(S=0;S<w;++S){for(var H=h[S],et=H.textureCount,it=0;it<et;it++)y=H.textures[it],p[H.ids[it]]!==y&&this.renderer.bindTexture(y,H.ids[it],!0),y._virtalBoundId=-1;this.renderer.state.setBlendMode(H.blend),e.drawElements(e.TRIANGLES,H.size*6,e.UNSIGNED_SHORT,H.start*6*2)}this.currentIndex=0}},t.prototype.start=function(){this.renderer.bindShader(this.shader),ii.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),r.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var n=0;n<this.buffers.length;++n)this.buffers[n].destroy()},t}(Ry.default);za.default=Sh;Cy.default.registerPlugin("sprite",Sh);var os={},Yi={};Yi.__esModule=!0;var qy=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Ky=W,Zy=X;function Qy(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Hn={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Ky.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Jy=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],jy=function(){function r(t){Qy(this,r),this.styleID=0,this.reset(),zn(this,t,t)}return r.prototype.clone=function(){var i={};return zn(i,this,Hn),new r(i)},r.prototype.reset=function(){zn(this,Hn,Hn)},r.prototype.toFontString=function(){var i=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var a=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(a)&&Jy.indexOf(a)<0&&(a='"'+a+'"'),e[n]=a}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+i+" "+e.join(",")},qy(r,[{key:"align",get:function(){return this._align},set:function(i){this._align!==i&&(this._align=i,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(i){var e=Yn(i);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(i){var e=Yn(i);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(i){t0(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(i){this._leading!==i&&(this._leading=i,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(i){this._padding!==i&&(this._padding=i,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(i){var e=Yn(i);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(i){this._trim!==i&&(this._trim=i,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}}]),r}();Yi.default=jy;function Zo(r){return typeof r=="number"?(0,Zy.hex2string)(r):(typeof r=="string"&&r.indexOf("0x")===0&&(r=r.replace("0x","#")),r)}function Yn(r){if(Array.isArray(r)){for(var t=0;t<r.length;++t)r[t]=Zo(r[t]);return r}else return Zo(r)}function t0(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(var i=0;i<r.length;++i)if(r[i]!==t[i])return!1;return!0}function zn(r,t,i){for(var e in i)Array.isArray(t[e])?r[e]=t[e].slice():r[e]=t[e]}var zi={};zi.__esModule=!0;function e0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ee=function(){function r(t,i,e,n,a,s,o,l,h){e0(this,r),this.text=t,this.style=i,this.width=e,this.height=n,this.lines=a,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=h}return r.measureText=function(i,e,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r._canvas;n=n??e.wordWrap;var s=e.toFontString(),o=r.measureFont(s),l=a.getContext("2d");l.font=s;for(var h=n?r.wordWrap(i,e,a):i,u=h.split(/(?:\r\n|\r|\n)/),f=new Array(u.length),d=0,p=0;p<u.length;p++){var _=l.measureText(u[p]).width+(u[p].length-1)*e.letterSpacing;f[p]=_,d=Math.max(d,_)}var m=d+e.strokeThickness;e.dropShadow&&(m+=e.dropShadowDistance);var g=e.lineHeight||o.fontSize+e.strokeThickness,y=Math.max(g,o.fontSize+e.strokeThickness)+(u.length-1)*(g+e.leading);return e.dropShadow&&(y+=e.dropShadowDistance),new r(i,e,m,y,u,f,g+e.leading,d,o)},r.wordWrap=function(i,e){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r._canvas,a=n.getContext("2d"),s=0,o="",l="",h={},u=e.letterSpacing,f=e.whiteSpace,d=r.collapseSpaces(f),p=r.collapseNewlines(f),_=!d,m=e.wordWrapWidth+u,g=r.tokenize(i),y=0;y<g.length;y++){var w=g[y];if(r.isNewline(w)){if(!p){l+=r.addLine(o),_=!d,o="",s=0;continue}w=" "}if(d){var T=r.isBreakingSpace(w),x=r.isBreakingSpace(o[o.length-1]);if(T&&x)continue}var E=r.getFromCache(w,u,h,a);if(E>m)if(o!==""&&(l+=r.addLine(o),o="",s=0),r.canBreakWords(w,e.breakWords))for(var b=w.split(""),D=0;D<b.length;D++){for(var S=b[D],M=1;b[D+M];){var O=b[D+M],F=S[S.length-1];if(!r.canBreakChars(F,O,w,D,e.breakWords))S+=O;else break;M++}D+=S.length-1;var L=r.getFromCache(S,u,h,a);L+s>m&&(l+=r.addLine(o),_=!1,o="",s=0),o+=S,s+=L}else{o.length>0&&(l+=r.addLine(o),o="",s=0);var B=y===g.length-1;l+=r.addLine(w,!B),_=!1,o="",s=0}else E+s>m&&(_=!1,l+=r.addLine(o),o="",s=0),(o.length>0||!r.isBreakingSpace(w)||_)&&(o+=w,s+=E)}return l+=r.addLine(o,!1),l},r.addLine=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return i=r.trimRight(i),i=e?i+`
`:i,i},r.getFromCache=function(i,e,n,a){var s=n[i];if(s===void 0){var o=i.length*e;s=a.measureText(i).width+o,n[i]=s}return s},r.collapseSpaces=function(i){return i==="normal"||i==="pre-line"},r.collapseNewlines=function(i){return i==="normal"},r.trimRight=function(i){if(typeof i!="string")return"";for(var e=i.length-1;e>=0;e--){var n=i[e];if(!r.isBreakingSpace(n))break;i=i.slice(0,-1)}return i},r.isNewline=function(i){return typeof i!="string"?!1:r._newlines.indexOf(i.charCodeAt(0))>=0},r.isBreakingSpace=function(i){return typeof i!="string"?!1:r._breakingSpaces.indexOf(i.charCodeAt(0))>=0},r.tokenize=function(i){var e=[],n="";if(typeof i!="string")return e;for(var a=0;a<i.length;a++){var s=i[a];if(r.isBreakingSpace(s)||r.isNewline(s)){n!==""&&(e.push(n),n=""),e.push(s);continue}n+=s}return n!==""&&e.push(n),e},r.canBreakWords=function(i,e){return e},r.canBreakChars=function(i,e,n,a,s){return!0},r.measureFont=function(i){if(r._fonts[i])return r._fonts[i];var e={},n=r._canvas,a=r._context;a.font=i;var s=r.METRICS_STRING+r.BASELINE_SYMBOL,o=Math.ceil(a.measureText(s).width),l=Math.ceil(a.measureText(r.BASELINE_SYMBOL).width),h=2*l;l=l*r.BASELINE_MULTIPLIER|0,n.width=o,n.height=h,a.fillStyle="#f00",a.fillRect(0,0,o,h),a.font=i,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(s,0,l);var u=a.getImageData(0,0,o,h).data,f=u.length,d=o*4,p=0,_=0,m=!1;for(p=0;p<l;++p){for(var g=0;g<d;g+=4)if(u[_+g]!==255){m=!0;break}if(!m)_+=d;else break}for(e.ascent=l-p,_=f-d,m=!1,p=h;p>l;--p){for(var y=0;y<d;y+=4)if(u[_+y]!==255){m=!0;break}if(!m)_-=d;else break}return e.descent=p-l,e.fontSize=e.ascent+e.descent,r._fonts[i]=e,e},r.clearMetrics=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";i?delete r._fonts[i]:r._fonts={}},r}();zi.default=ee;var vi=document.createElement("canvas");vi.width=vi.height=10;ee._canvas=vi;ee._context=vi.getContext("2d");ee._fonts={};ee.METRICS_STRING="|q";ee.BASELINE_SYMBOL="M";ee.BASELINE_MULTIPLIER=1.4;ee._newlines=[10,13];ee._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var ls={};ls.__esModule=!0;ls.default=r0;function r0(r){var t=r.width,i=r.height,e=r.getContext("2d"),n=e.getImageData(0,0,t,i),a=n.data,s=a.length,o={top:null,left:null,right:null,bottom:null},l=null,h=void 0,u=void 0,f=void 0;for(h=0;h<s;h+=4)a[h+3]!==0&&(u=h/4%t,f=~~(h/4/t),o.top===null&&(o.top=f),(o.left===null||u<o.left)&&(o.left=u),(o.right===null||o.right<u)&&(o.right=u+1),(o.bottom===null||o.bottom<f)&&(o.bottom=f));return o.top!==null&&(t=o.right-o.left,i=o.bottom-o.top+1,l=e.getImageData(o.left,o.top,t,i)),{height:i,width:t,data:l}}os.__esModule=!0;var i0=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),n0=Ir,a0=He(n0),s0=Yt,Qo=He(s0),Jo=vt,jo=X,o0=W,l0=_t,tl=He(l0),h0=Yi,el=He(h0),u0=zi,f0=He(u0),c0=ls,d0=He(c0);function He(r){return r&&r.__esModule?r:{default:r}}function _0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function p0(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function m0(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var g0={texture:!0,children:!1,baseTexture:!0},v0=function(r){m0(t,r);function t(i,e,n){_0(this,t),n=n||document.createElement("canvas"),n.width=3,n.height=3;var a=Qo.default.fromCanvas(n,tl.default.SCALE_MODE,"text");a.orig=new Jo.Rectangle,a.trim=new Jo.Rectangle;var s=p0(this,r.call(this,a));return Qo.default.addToCache(s._texture,s._texture.baseTexture.textureCacheIds[0]),s.canvas=n,s.context=s.canvas.getContext("2d"),s.resolution=tl.default.RESOLUTION,s._text=null,s._style=null,s._styleListener=null,s._font="",s.text=i,s.style=e,s.localStyleID=-1,s}return t.prototype.updateText=function(e){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),!(!this.dirty&&e)){this._font=this._style.toFontString();var a=this.context,s=f0.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),o=s.width,l=s.height,h=s.lines,u=s.lineHeight,f=s.lineWidths,d=s.maxLineWidth,p=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,o)+n.padding*2)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,l)+n.padding*2)*this.resolution),a.scale(this.resolution,this.resolution),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=this._font,a.strokeStyle=n.stroke,a.lineWidth=n.strokeThickness,a.textBaseline=n.textBaseline,a.lineJoin=n.lineJoin,a.miterLimit=n.miterLimit;var _=void 0,m=void 0;if(n.dropShadow){a.fillStyle=n.dropShadowColor,a.globalAlpha=n.dropShadowAlpha,a.shadowBlur=n.dropShadowBlur,n.dropShadowBlur>0&&(a.shadowColor=n.dropShadowColor);for(var g=Math.cos(n.dropShadowAngle)*n.dropShadowDistance,y=Math.sin(n.dropShadowAngle)*n.dropShadowDistance,w=0;w<h.length;w++)_=n.strokeThickness/2,m=n.strokeThickness/2+w*u+p.ascent,n.align==="right"?_+=d-f[w]:n.align==="center"&&(_+=(d-f[w])/2),n.fill&&(this.drawLetterSpacing(h[w],_+g+n.padding,m+y+n.padding),n.stroke&&n.strokeThickness&&(a.strokeStyle=n.dropShadowColor,this.drawLetterSpacing(h[w],_+g+n.padding,m+y+n.padding,!0),a.strokeStyle=n.stroke))}a.shadowBlur=0,a.globalAlpha=1,a.fillStyle=this._generateFillStyle(n,h);for(var T=0;T<h.length;T++)_=n.strokeThickness/2,m=n.strokeThickness/2+T*u+p.ascent,n.align==="right"?_+=d-f[T]:n.align==="center"&&(_+=(d-f[T])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(h[T],_+n.padding,m+n.padding,!0),n.fill&&this.drawLetterSpacing(h[T],_+n.padding,m+n.padding);this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,n,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this._style,l=o.letterSpacing;if(l===0){s?this.context.strokeText(e,n,a):this.context.fillText(e,n,a);return}for(var h=String.prototype.split.call(e,""),u=n,f=0,d="",p=this.context.measureText(e).width,_=0;f<e.length;)d=h[f++],s?this.context.strokeText(d,u,a):this.context.fillText(d,u,a),_=this.context.measureText(e.substring(f)).width,u+=p-_+l,p=_},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var n=(0,d0.default)(e);n.data&&(e.width=n.width,e.height=n.height,this.context.putImageData(n.data,0,0))}var a=this._texture,s=this._style,o=s.trim?0:s.padding,l=a.baseTexture;l.hasLoaded=!0,l.resolution=this.resolution,l.realWidth=e.width,l.realHeight=e.height,l.width=e.width/this.resolution,l.height=e.height/this.resolution,a.trim.width=a._frame.width=e.width/this.resolution,a.trim.height=a._frame.height=e.height/this.resolution,a.trim.x=-o,a.trim.y=-o,a.orig.width=a._frame.width-o*2,a.orig.height=a._frame.height-o*2,this._onTextureUpdate(),l.emit("update",l),this.dirty=!1},t.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),r.prototype.renderWebGL.call(this,e)},t.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),r.prototype._renderCanvas.call(this,e)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),r.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._onStyleChange=function(){this.dirty=!0},t.prototype._generateFillStyle=function(e,n){if(!Array.isArray(e.fill))return e.fill;if(navigator.isCocoonJS)return e.fill[0];var a=void 0,s=void 0,o=void 0,l=void 0,h=this.canvas.width/this.resolution,u=this.canvas.height/this.resolution,f=e.fill.slice(),d=e.fillGradientStops.slice();if(!d.length)for(var p=f.length+1,_=1;_<p;++_)d.push(_/p);if(f.unshift(e.fill[0]),d.unshift(0),f.push(e.fill[e.fill.length-1]),d.push(1),e.fillGradientType===o0.TEXT_GRADIENT.LINEAR_VERTICAL){a=this.context.createLinearGradient(h/2,0,h/2,u),s=(f.length+1)*n.length,o=0;for(var m=0;m<n.length;m++){o+=1;for(var g=0;g<f.length;g++)typeof d[g]=="number"?l=d[g]/n.length+m/n.length:l=o/s,a.addColorStop(l,f[g]),o++}}else{a=this.context.createLinearGradient(0,u/2,h,u/2),s=f.length+1,o=1;for(var y=0;y<f.length;y++)typeof d[y]=="number"?l=d[y]:l=o/s,a.addColorStop(l,f[y]),o++}return a},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},g0,e),r.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},i0(t,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var n=(0,jo.sign)(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var n=(0,jo.sign)(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}},{key:"style",get:function(){return this._style},set:function(e){e=e||{},e instanceof el.default?this._style=e:this._style=new el.default(e),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(e){e=String(e===""||e===null||e===void 0?" ":e),this._text!==e&&(this._text=e,this.dirty=!0)}}]),t}(a0.default);os.default=v0;var hs={},qi={};qi.__esModule=!0;function y0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var T0=function(){function r(t,i,e,n,a,s,o,l,h){y0(this,r),this.lineWidth=t,this.lineAlignment=h,this.nativeLines=o,this.lineColor=i,this.lineAlpha=e,this._lineTint=i,this.fillColor=n,this.fillAlpha=a,this._fillTint=n,this.fill=s,this.holes=[],this.shape=l,this.type=l.type}return r.prototype.clone=function(){return new r(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape,this.lineAlignment)},r.prototype.addHole=function(i){this.holes.push(i)},r.prototype.destroy=function(){this.shape=null,this.holes=null},r}();qi.default=T0;var us={};us.__esModule=!0;us.default=x0;function x0(r,t,i,e,n,a,s,o,l){var h=arguments.length>9&&arguments[9]!==void 0?arguments[9]:[],u=0,f=0,d=0,p=0,_=0;h.push(r,t);for(var m=1,g=0;m<=l;++m)g=m/l,u=1-g,f=u*u,d=f*u,p=g*g,_=p*g,h.push(d*r+3*f*g*i+3*u*p*n+_*s,d*t+3*f*g*e+3*u*p*a+_*o);return h}hs.__esModule=!0;var w0=Me,b0=_e(w0),E0=Fr,S0=_e(E0),D0=Yt,qn=_e(D0),A0=qi,M0=_e(A0),O0=Ir,P0=_e(O0),Wt=vt,Kn=X,Nt=W,R0=Mr,I0=_e(R0),C0=us,F0=_e(C0),B0=Oe,L0=_e(B0);function _e(r){return r&&r.__esModule?r:{default:r}}function N0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function k0(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function U0(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Zn=void 0,je=new Wt.Matrix,tr=new Wt.Point,$0=new Float32Array(4),G0=new Float32Array(4),fs=function(r){U0(t,r);function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;N0(this,t);var e=k0(this,r.call(this));return e.fillAlpha=1,e.lineWidth=0,e.nativeLines=i,e.lineColor=0,e.lineAlignment=.5,e.graphicsData=[],e.tint=16777215,e._prevTint=16777215,e.blendMode=Nt.BLEND_MODES.NORMAL,e.currentPath=null,e._webGL={},e.isMask=!1,e.boundsPadding=0,e._localBounds=new I0.default,e.dirty=0,e.fastRectDirty=-1,e.clearDirty=0,e.boundsDirty=-1,e.cachedSpriteDirty=!1,e._spriteRect=null,e._fastRect=!1,e._prevRectTint=null,e._prevRectFillColor=null,e}return t.prototype.clone=function(){var e=new t;e.renderable=this.renderable,e.fillAlpha=this.fillAlpha,e.lineWidth=this.lineWidth,e.lineColor=this.lineColor,e.lineAlignment=this.lineAlignment,e.tint=this.tint,e.blendMode=this.blendMode,e.isMask=this.isMask,e.boundsPadding=this.boundsPadding,e.dirty=0,e.cachedSpriteDirty=this.cachedSpriteDirty;for(var n=0;n<this.graphicsData.length;++n)e.graphicsData.push(this.graphicsData[n].clone());return e.currentPath=e.graphicsData[e.graphicsData.length-1],e.updateLocalBounds(),e},t.prototype._quadraticCurveLength=function(e,n,a,s,o,l){var h=e-2*a+o,u=n-2*s+l,f=2*a-2*e,d=2*s-2*n,p=4*(h*h+u*u),_=4*(h*f+u*d),m=f*f+d*d,g=2*Math.sqrt(p+_+m),y=Math.sqrt(p),w=2*p*y,T=2*Math.sqrt(m),x=_/y;return(w*g+y*_*(g-T)+(4*m*p-_*_)*Math.log((2*y+x+g)/(x+T)))/(4*w)},t.prototype._bezierCurveLength=function(e,n,a,s,o,l,h,u){for(var f=10,d=0,p=0,_=0,m=0,g=0,y=0,w=0,T=0,x=0,E=0,b=0,D=e,S=n,M=1;M<=f;++M)p=M/f,_=p*p,m=_*p,g=1-p,y=g*g,w=y*g,T=w*e+3*y*p*a+3*g*_*o+m*h,x=w*n+3*y*p*s+3*g*_*l+m*u,E=D-T,b=S-x,D=T,S=x,d+=Math.sqrt(E*E+b*b);return d},t.prototype._segmentsCount=function(e){var n=Math.ceil(e/t.CURVES.maxLength);return n<t.CURVES.minSegments?n=t.CURVES.minSegments:n>t.CURVES.maxSegments&&(n=t.CURVES.maxSegments),n},t.prototype.lineStyle=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.5;if(this.lineWidth=e,this.lineColor=n,this.lineAlpha=a,this.lineAlignment=s,this.currentPath)if(this.currentPath.shape.points.length){var o=new Wt.Polygon(this.currentPath.shape.points.slice(-2));o.closed=!1,this.drawShape(o)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment;return this},t.prototype.moveTo=function(e,n){var a=new Wt.Polygon([e,n]);return a.closed=!1,this.drawShape(a),this},t.prototype.lineTo=function(e,n){var a=this.currentPath.shape.points,s=a[a.length-2],o=a[a.length-1];return(s!==e||o!==n)&&(a.push(e,n),this.dirty++),this},t.prototype.quadraticCurveTo=function(e,n,a,s){this.currentPath?this.currentPath.shape.points.length===0&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,l=0,h=0;o.length===0&&this.moveTo(0,0);for(var u=o[o.length-2],f=o[o.length-1],d=t.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(u,f,e,n,a,s)):20,p=1;p<=d;++p){var _=p/d;l=u+(e-u)*_,h=f+(n-f)*_,o.push(l+(e+(a-e)*_-l)*_,h+(n+(s-n)*_-h)*_)}return this.dirty++,this},t.prototype.bezierCurveTo=function(e,n,a,s,o,l){this.currentPath?this.currentPath.shape.points.length===0&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var h=this.currentPath.shape.points,u=h[h.length-2],f=h[h.length-1];h.length-=2;var d=t.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(u,f,e,n,a,s,o,l)):20;return(0,F0.default)(u,f,e,n,a,s,o,l,d,h),this.dirty++,this},t.prototype.arcTo=function(e,n,a,s,o){this.currentPath?this.currentPath.shape.points.length===0&&this.currentPath.shape.points.push(e,n):this.moveTo(e,n);var l=this.currentPath.shape.points,h=l[l.length-2],u=l[l.length-1],f=u-n,d=h-e,p=s-n,_=a-e,m=Math.abs(f*_-d*p);if(m<1e-8||o===0)(l[l.length-2]!==e||l[l.length-1]!==n)&&l.push(e,n);else{var g=f*f+d*d,y=p*p+_*_,w=f*p+d*_,T=o*Math.sqrt(g)/m,x=o*Math.sqrt(y)/m,E=T*w/g,b=x*w/y,D=T*_+x*d,S=T*p+x*f,M=d*(x+E),O=f*(x+E),F=_*(T+b),L=p*(T+b),B=Math.atan2(O-S,M-D),I=Math.atan2(L-S,F-D);this.arc(D+e,S+n,o,B,I,d*p>_*f)}return this.dirty++,this},t.prototype.arc=function(e,n,a,s,o){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(s===o)return this;!l&&o<=s?o+=Nt.PI_2:l&&s<=o&&(s+=Nt.PI_2);var h=o-s,u=t.CURVES.adaptive?this._segmentsCount(Math.abs(h)*a):Math.ceil(Math.abs(h)/Nt.PI_2)*40;if(h===0)return this;var f=e+Math.cos(s)*a,d=n+Math.sin(s)*a,p=this.currentPath?this.currentPath.shape.points:null;if(p){var _=Math.abs(p[p.length-2]-f),m=Math.abs(p[p.length-1]-d);_<.001&&m<.001||p.push(f,d)}else this.moveTo(f,d),p=this.currentPath.shape.points;for(var g=h/(u*2),y=g*2,w=Math.cos(g),T=Math.sin(g),x=u-1,E=x%1/x,b=0;b<=x;++b){var D=b+E*b,S=g+s+y*D,M=Math.cos(S),O=-Math.sin(S);p.push((w*M+T*O)*a+e,(w*-O+T*M)*a+n)}return this.dirty++,this},t.prototype.beginFill=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.filling=!0,this.fillColor=e,this.fillAlpha=n,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},t.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},t.prototype.drawRect=function(e,n,a,s){return this.drawShape(new Wt.Rectangle(e,n,a,s)),this},t.prototype.drawRoundedRect=function(e,n,a,s,o){return this.drawShape(new Wt.RoundedRectangle(e,n,a,s,o)),this},t.prototype.drawCircle=function(e,n,a){return this.drawShape(new Wt.Circle(e,n,a)),this},t.prototype.drawEllipse=function(e,n,a,s){return this.drawShape(new Wt.Ellipse(e,n,a,s)),this},t.prototype.drawPolygon=function(e){var n=e,a=!0;if(n instanceof Wt.Polygon&&(a=n.closed,n=n.points),!Array.isArray(n)){n=new Array(arguments.length);for(var s=0;s<n.length;++s)n[s]=arguments[s]}var o=new Wt.Polygon(n);return o.closed=a,this.drawShape(o),this},t.prototype.drawStar=function(e,n,a,s,o){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;o=o||s/2;for(var h=-1*Math.PI/2+l,u=a*2,f=Nt.PI_2/u,d=[],p=0;p<u;p++){var _=p%2?o:s,m=p*f+h;d.push(e+_*Math.cos(m),n+_*Math.sin(m))}return this.drawPolygon(d)},t.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},t.prototype.isFastRect=function(){return this.graphicsData.length===1&&this.graphicsData[0].shape.type===Nt.SHAPES.RECT&&!this.graphicsData[0].lineWidth},t.prototype._renderWebGL=function(e){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(e):(e.setObjectRenderer(e.plugins.graphics),e.plugins.graphics.render(this))},t.prototype._renderSpriteRect=function(e){var n=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new P0.default(new qn.default(qn.default.WHITE)));var a=this._spriteRect,s=this.graphicsData[0].fillColor;if(this.tint===16777215)a.tint=s;else if(this.tint!==this._prevRectTint||s!==this._prevRectFillColor){var o=$0,l=G0;(0,Kn.hex2rgb)(s,o),(0,Kn.hex2rgb)(this.tint,l),o[0]*=l[0],o[1]*=l[1],o[2]*=l[2],a.tint=(0,Kn.rgb2hex)(o),this._prevRectTint=this.tint,this._prevRectFillColor=s}a.alpha=this.graphicsData[0].fillAlpha,a.worldAlpha=this.worldAlpha*a.alpha,a.blendMode=this.blendMode,a._texture._frame.width=n.width,a._texture._frame.height=n.height,a.transform.worldTransform=this.transform.worldTransform,a.anchor.set(-n.x/n.width,-n.y/n.height),a._onAnchorUpdate(),a._renderWebGL(e)},t.prototype._renderCanvas=function(e){this.isMask!==!0&&e.plugins.graphics.render(this)},t.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var e=this._localBounds;this._bounds.addFrame(this.transform,e.minX,e.minY,e.maxX,e.maxY)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tr);for(var n=this.graphicsData,a=0;a<n.length;++a){var s=n[a];if(s.fill&&s.shape&&s.shape.contains(tr.x,tr.y)){var o=!1;if(s.holes)for(var l=0;l<s.holes.length;l++){var h=s.holes[l];if(h.contains(tr.x,tr.y)){o=!0;break}}if(!o)return!0}}return!1},t.prototype.updateLocalBounds=function(){var e=1/0,n=-1/0,a=1/0,s=-1/0;if(this.graphicsData.length)for(var o=0,l=0,h=0,u=0,f=0,d=0;d<this.graphicsData.length;d++){var p=this.graphicsData[d],_=p.type,m=p.lineWidth,g=p.lineAlignment,y=m*g;if(o=p.shape,_===Nt.SHAPES.RECT||_===Nt.SHAPES.RREC)l=o.x-y,h=o.y-y,u=o.width+y*2,f=o.height+y*2,e=l<e?l:e,n=l+u>n?l+u:n,a=h<a?h:a,s=h+f>s?h+f:s;else if(_===Nt.SHAPES.CIRC)l=o.x,h=o.y,u=o.radius+y,f=o.radius+y,e=l-u<e?l-u:e,n=l+u>n?l+u:n,a=h-f<a?h-f:a,s=h+f>s?h+f:s;else if(_===Nt.SHAPES.ELIP)l=o.x,h=o.y,u=o.width+y,f=o.height+y,e=l-u<e?l-u:e,n=l+u>n?l+u:n,a=h-f<a?h-f:a,s=h+f>s?h+f:s;else for(var w=o.points,T=0,x=0,E=0,b=0,D=0,S=0,M=0,O=0,F=0;F+2<w.length;F+=2)l=w[F],h=w[F+1],T=w[F+2],x=w[F+3],E=Math.abs(T-l),b=Math.abs(x-h),f=y*2,u=Math.sqrt(E*E+b*b),!(u<1e-9)&&(D=(f/u*b+E)/2,S=(f/u*E+b)/2,M=(T+l)/2,O=(x+h)/2,e=M-D<e?M-D:e,n=M+D>n?M+D:n,a=O-S<a?O-S:a,s=O+S>s?O+S:s)}else e=0,n=0,a=0,s=0;var L=this.boundsPadding;this._localBounds.minX=e-L,this._localBounds.maxX=n+L,this._localBounds.minY=a-L,this._localBounds.maxY=s+L},t.prototype.drawShape=function(e){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var n=new M0.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,e,this.lineAlignment);return this.graphicsData.push(n),n.type===Nt.SHAPES.POLY&&(n.shape.closed=n.shape.closed,this.currentPath=n),this.dirty++,n},t.prototype.generateCanvasTexture=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=this.getLocalBounds(),s=S0.default.create(a.width,a.height,e,n);Zn||(Zn=new L0.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(je),je.invert(),je.tx-=a.x,je.ty-=a.y,Zn.render(this,s,!0,je);var o=qn.default.fromCanvas(s.baseTexture._canvasRenderTarget.canvas,e,"graphics");return o.baseTexture.resolution=n,o.baseTexture.update(),o},t.prototype.closePath=function(){var e=this.currentPath;return e&&e.shape&&e.shape.close(),this},t.prototype.addHole=function(){var e=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(e.shape),this.currentPath=null,this},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e);for(var n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();for(var a in this._webGL)for(var s=0;s<this._webGL[a].data.length;++s)this._webGL[a].data[s].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},t}(b0.default);hs.default=fs;fs._SPRITE_TEXTURE=null;fs.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048};var cs={},ds={};ds.__esModule=!0;var X0=At,Qn=V0(X0);function V0(r){return r&&r.__esModule?r:{default:r}}function W0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var H0=function(){function r(t,i,e){W0(this,r),this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=Qn.default.GLBuffer.createVertexBuffer(t),this.indexBuffer=Qn.default.GLBuffer.createIndexBuffer(t),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=i,this.vao=new Qn.default.VertexArrayObject(t,e).addIndex(this.indexBuffer).addAttribute(this.buffer,i.attributes.aVertexPosition,t.FLOAT,!1,4*6,0).addAttribute(this.buffer,i.attributes.aColor,t.FLOAT,!1,4*6,2*4)}return r.prototype.reset=function(){this.points.length=0,this.indices.length=0},r.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},r.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},r}();ds.default=H0;var _s={};_s.__esModule=!0;var Y0=Re,z0=q0(Y0);function q0(r){return r&&r.__esModule?r:{default:r}}function K0(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Z0(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Q0(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var J0=function(r){Q0(t,r);function t(i){return K0(this,t),Z0(this,r.call(this,i,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join(`
`),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join(`
`)))}return t}(z0.default);_s.default=J0;var ps={},Ye={};Ye.__esModule=!0;Ye.default=function(r,t,i){r.nativeLines?tT(r,i):j0(r,t)};var Jn=vt,Dh=X;function j0(r,t){var i=r.points;if(i.length!==0){var e=new Jn.Point(i[0],i[1]),n=new Jn.Point(i[i.length-2],i[i.length-1]);if(e.x===n.x&&e.y===n.y){i=i.slice(),i.pop(),i.pop(),n=new Jn.Point(i[i.length-2],i[i.length-1]);var a=n.x+(e.x-n.x)*.5,s=n.y+(e.y-n.y)*.5;i.unshift(a,s),i.push(a,s)}var o=t.points,l=t.indices,h=i.length/2,u=i.length,f=o.length/6,d=r.lineWidth/2,p=(0,Dh.hex2rgb)(r.lineColor),_=r.lineAlpha,m=p[0]*_,g=p[1]*_,y=p[2]*_,w=i[0],T=i[1],x=i[2],E=i[3],b=0,D=0,S=-(T-E),M=w-x,O=0,F=0,L=0,B=0,I=Math.sqrt(S*S+M*M);S/=I,M/=I,S*=d,M*=d;var U=r.lineAlignment,G=(1-U)*2,$=U*2;o.push(w-S*G,T-M*G,m,g,y,_),o.push(w+S*$,T+M*$,m,g,y,_);for(var k=1;k<h-1;++k){w=i[(k-1)*2],T=i[(k-1)*2+1],x=i[k*2],E=i[k*2+1],b=i[(k+1)*2],D=i[(k+1)*2+1],S=-(T-E),M=w-x,I=Math.sqrt(S*S+M*M),S/=I,M/=I,S*=d,M*=d,O=-(E-D),F=x-b,I=Math.sqrt(O*O+F*F),O/=I,F/=I,O*=d,F*=d;var q=-M+T-(-M+E),z=-S+x-(-S+w),H=(-S+w)*(-M+E)-(-S+x)*(-M+T),et=-F+D-(-F+E),it=-O+x-(-O+b),j=(-O+b)*(-F+E)-(-O+x)*(-F+D),wt=q*it-et*z;if(Math.abs(wt)<.1){wt+=10.1,o.push(x-S*G,E-M*G,m,g,y,_),o.push(x+S*$,E+M*$,m,g,y,_);continue}var ot=(z*j-it*H)/wt,nt=(et*H-q*j)/wt,Rt=(ot-x)*(ot-x)+(nt-E)*(nt-E);Rt>196*d*d?(L=S-O,B=M-F,I=Math.sqrt(L*L+B*B),L/=I,B/=I,L*=d,B*=d,o.push(x-L*G,E-B*G),o.push(m,g,y,_),o.push(x+L*$,E+B*$),o.push(m,g,y,_),o.push(x-L*$*G,E-B*G),o.push(m,g,y,_),u++):(o.push(x+(ot-x)*G,E+(nt-E)*G),o.push(m,g,y,_),o.push(x-(ot-x)*$,E-(nt-E)*$),o.push(m,g,y,_))}w=i[(h-2)*2],T=i[(h-2)*2+1],x=i[(h-1)*2],E=i[(h-1)*2+1],S=-(T-E),M=w-x,I=Math.sqrt(S*S+M*M),S/=I,M/=I,S*=d,M*=d,o.push(x-S*G,E-M*G),o.push(m,g,y,_),o.push(x+S*$,E+M*$),o.push(m,g,y,_),l.push(f);for(var Hr=0;Hr<u;++Hr)l.push(f++);l.push(f-1)}}function tT(r,t){var i=0,e=r.points;if(e.length!==0){var n=t.points,a=e.length/2,s=(0,Dh.hex2rgb)(r.lineColor),o=r.lineAlpha,l=s[0]*o,h=s[1]*o,u=s[2]*o;for(i=1;i<a;i++){var f=e[(i-1)*2],d=e[(i-1)*2+1],p=e[i*2],_=e[i*2+1];n.push(f,d),n.push(l,h,u,o),n.push(p,_),n.push(l,h,u,o)}}}ps.__esModule=!0;ps.default=sT;var eT=Ye,rT=Ah(eT),iT=X,nT=ke,aT=Ah(nT);function Ah(r){return r&&r.__esModule?r:{default:r}}function sT(r,t,i){r.points=r.shape.points.slice();var e=r.points;if(r.fill&&e.length>=6){for(var n=[],a=r.holes,s=0;s<a.length;s++){var o=a[s];n.push(e.length/2),e=e.concat(o.points)}var l=t.points,h=t.indices,u=e.length/2,f=(0,iT.hex2rgb)(r.fillColor),d=r.fillAlpha,p=f[0]*d,_=f[1]*d,m=f[2]*d,g=(0,aT.default)(e,n,2);if(!g)return;for(var y=l.length/6,w=0;w<g.length;w+=3)h.push(g[w]+y),h.push(g[w]+y),h.push(g[w+1]+y),h.push(g[w+2]+y),h.push(g[w+2]+y);for(var T=0;T<u;T++)l.push(e[T*2],e[T*2+1],p,_,m,d)}r.lineWidth>0&&(0,rT.default)(r,t,i)}var ms={};ms.__esModule=!0;ms.default=fT;var oT=Ye,lT=uT(oT),hT=X;function uT(r){return r&&r.__esModule?r:{default:r}}function fT(r,t,i){var e=r.shape,n=e.x,a=e.y,s=e.width,o=e.height;if(r.fill){var l=(0,hT.hex2rgb)(r.fillColor),h=r.fillAlpha,u=l[0]*h,f=l[1]*h,d=l[2]*h,p=t.points,_=t.indices,m=p.length/6;p.push(n,a),p.push(u,f,d,h),p.push(n+s,a),p.push(u,f,d,h),p.push(n,a+o),p.push(u,f,d,h),p.push(n+s,a+o),p.push(u,f,d,h),_.push(m,m,m+1,m+2,m+3,m+3)}if(r.lineWidth){var g=r.points;r.points=[n,a,n+s,a,n+s,a+o,n,a+o,n,a],(0,lT.default)(r,t,i),r.points=g}}var gs={};gs.__esModule=!0;gs.default=gT;var cT=ke,dT=Mh(cT),_T=Ye,pT=Mh(_T),mT=X;function Mh(r){return r&&r.__esModule?r:{default:r}}function gT(r,t,i){var e=r.shape,n=e.x,a=e.y,s=e.width,o=e.height,l=e.radius,h=[];if(h.push(n+l,a),ni(n+s-l,a,n+s,a,n+s,a+l,h),ni(n+s,a+o-l,n+s,a+o,n+s-l,a+o,h),ni(n+l,a+o,n,a+o,n,a+o-l,h),ni(n,a+l,n,a,n+l+1e-10,a,h),r.fill){for(var u=(0,mT.hex2rgb)(r.fillColor),f=r.fillAlpha,d=u[0]*f,p=u[1]*f,_=u[2]*f,m=t.points,g=t.indices,y=m.length/6,w=(0,dT.default)(h,null,2),T=0,x=w.length;T<x;T+=3)g.push(w[T]+y),g.push(w[T]+y),g.push(w[T+1]+y),g.push(w[T+2]+y),g.push(w[T+2]+y);for(var E=0,b=h.length;E<b;E++)m.push(h[E],h[++E],d,p,_,f)}if(r.lineWidth){var D=r.points;r.points=h,(0,pT.default)(r,t,i),r.points=D}}function Fe(r,t,i){var e=t-r;return r+e*i}function ni(r,t,i,e,n,a){for(var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[],o=20,l=s,h=0,u=0,f=0,d=0,p=0,_=0,m=0,g=0;m<=o;++m)g=m/o,h=Fe(r,i,g),u=Fe(t,e,g),f=Fe(i,n,g),d=Fe(e,a,g),p=Fe(h,f,g),_=Fe(u,d,g),l.push(p,_);return l}var vs={};vs.__esModule=!0;vs.default=bT;var vT=Ye,yT=wT(vT),TT=W,xT=X;function wT(r){return r&&r.__esModule?r:{default:r}}function bT(r,t,i){var e=r.shape,n=e.x,a=e.y,s=void 0,o=void 0;if(r.type===TT.SHAPES.CIRC?(s=e.radius,o=e.radius):(s=e.width,o=e.height),!(s===0||o===0)){var l=Math.floor(30*Math.sqrt(e.radius))||Math.floor(15*Math.sqrt(e.width+e.height)),h=Math.PI*2/l;if(r.fill){var u=(0,xT.hex2rgb)(r.fillColor),f=r.fillAlpha,d=u[0]*f,p=u[1]*f,_=u[2]*f,m=t.points,g=t.indices,y=m.length/6;g.push(y);for(var w=0;w<l+1;w++)m.push(n,a,d,p,_,f),m.push(n+Math.sin(h*w)*s,a+Math.cos(h*w)*o,d,p,_,f),g.push(y++,y++);g.push(y-1)}if(r.lineWidth){var T=r.points;r.points=[];for(var x=0;x<l;x++)r.points.push(n+Math.sin(h*-x)*s,a+Math.cos(h*-x)*o);r.points.push(r.points[0],r.points[1]),(0,yT.default)(r,t,i),r.points=T}}}cs.__esModule=!0;var ET=X,er=W,ST=Xe,rl=pe(ST),DT=Ve,AT=pe(DT),MT=ds,OT=pe(MT),PT=_s,RT=pe(PT),IT=ps,CT=pe(IT),FT=ms,BT=pe(FT),LT=gs,NT=pe(LT),kT=vs,UT=pe(kT);function pe(r){return r&&r.__esModule?r:{default:r}}function $T(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function GT(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function XT(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Oh=function(r){XT(t,r);function t(i){$T(this,t);var e=GT(this,r.call(this,i));return e.graphicsDataPool=[],e.primitiveShader=null,e.gl=i.gl,e.CONTEXT_UID=0,e}return t.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new RT.default(this.gl)},t.prototype.destroy=function(){rl.default.prototype.destroy.call(this);for(var e=0;e<this.graphicsDataPool.length;++e)this.graphicsDataPool[e].destroy();this.graphicsDataPool=null},t.prototype.render=function(e){var n=this.renderer,a=n.gl,s=void 0,o=e._webGL[this.CONTEXT_UID];(!o||e.dirty!==o.dirty)&&(this.updateGraphics(e),o=e._webGL[this.CONTEXT_UID]);var l=this.primitiveShader;n.bindShader(l),n.state.setBlendMode(e.blendMode);for(var h=0,u=o.data.length;h<u;h++){s=o.data[h];var f=s.shader;n.bindShader(f),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.tint=(0,ET.hex2rgb)(e.tint),f.uniforms.alpha=e.worldAlpha,n.bindVao(s.vao),s.nativeLines?a.drawArrays(a.LINES,0,s.points.length/6):s.vao.draw(a.TRIANGLE_STRIP,s.indices.length)}},t.prototype.updateGraphics=function(e){var n=this.renderer.gl,a=e._webGL[this.CONTEXT_UID];if(a||(a=e._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:n,clearDirty:-1,dirty:-1}),a.dirty=e.dirty,e.clearDirty!==a.clearDirty){a.clearDirty=e.clearDirty;for(var s=0;s<a.data.length;s++)this.graphicsDataPool.push(a.data[s]);a.data.length=0,a.lastIndex=0}for(var o=void 0,l=void 0,h=a.lastIndex;h<e.graphicsData.length;h++){var u=e.graphicsData[h];o=this.getWebGLData(a,0),u.nativeLines&&u.lineWidth&&(l=this.getWebGLData(a,0,!0),a.lastIndex++),u.type===er.SHAPES.POLY&&(0,CT.default)(u,o,l),u.type===er.SHAPES.RECT?(0,BT.default)(u,o,l):u.type===er.SHAPES.CIRC||u.type===er.SHAPES.ELIP?(0,UT.default)(u,o,l):u.type===er.SHAPES.RREC&&(0,NT.default)(u,o,l),a.lastIndex++}this.renderer.bindVao(null);for(var f=0;f<a.data.length;f++)o=a.data[f],o.dirty&&o.upload()},t.prototype.getWebGLData=function(e,n,a){var s=e.data[e.data.length-1];return(!s||s.nativeLines!==a||s.points.length>32e4)&&(s=this.graphicsDataPool.pop()||new OT.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),s.nativeLines=a,s.reset(n),e.data.push(s)),s.dirty=!0,s},t}(rl.default);cs.default=Oh;AT.default.registerPlugin("graphics",Oh);var ys={};ys.__esModule=!0;var VT=Oe,WT=HT(VT),rr=W;function HT(r){return r&&r.__esModule?r:{default:r}}function YT(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Ph=function(){function r(t){YT(this,r),this.renderer=t}return r.prototype.render=function(i){var e=this.renderer,n=e.context,a=i.worldAlpha,s=i.transform.worldTransform,o=e.resolution;n.setTransform(s.a*o,s.b*o,s.c*o,s.d*o,s.tx*o,s.ty*o),(i.canvasTintDirty!==i.dirty||i._prevTint!==i.tint)&&this.updateGraphicsTint(i),e.setBlendMode(i.blendMode);for(var l=0;l<i.graphicsData.length;l++){var h=i.graphicsData[l],u=h.shape,f=h._fillTint,d=h._lineTint;if(n.lineWidth=h.lineWidth,h.type===rr.SHAPES.POLY){n.beginPath();var p=u.points,_=h.holes,m=void 0,g=void 0,y=void 0,w=void 0;n.moveTo(p[0],p[1]);for(var T=2;T<p.length;T+=2)n.lineTo(p[T],p[T+1]);if(u.closed&&n.closePath(),_.length>0){m=0,y=p[0],w=p[1];for(var x=2;x+2<p.length;x+=2)m+=(p[x]-y)*(p[x+3]-w)-(p[x+2]-y)*(p[x+1]-w);for(var E=0;E<_.length;E++)if(p=_[E].points,!!p){g=0,y=p[0],w=p[1];for(var b=2;b+2<p.length;b+=2)g+=(p[b]-y)*(p[b+3]-w)-(p[b+2]-y)*(p[b+1]-w);if(g*m<0){n.moveTo(p[0],p[1]);for(var D=2;D<p.length;D+=2)n.lineTo(p[D],p[D+1])}else{n.moveTo(p[p.length-2],p[p.length-1]);for(var S=p.length-4;S>=0;S-=2)n.lineTo(p[S],p[S+1])}_[E].close&&n.closePath()}}h.fill&&(n.globalAlpha=h.fillAlpha*a,n.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6),n.fill()),h.lineWidth&&(n.globalAlpha=h.lineAlpha*a,n.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),n.stroke())}else if(h.type===rr.SHAPES.RECT)(h.fillColor||h.fillColor===0)&&(n.globalAlpha=h.fillAlpha*a,n.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6),n.fillRect(u.x,u.y,u.width,u.height)),h.lineWidth&&(n.globalAlpha=h.lineAlpha*a,n.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),n.strokeRect(u.x,u.y,u.width,u.height));else if(h.type===rr.SHAPES.CIRC)n.beginPath(),n.arc(u.x,u.y,u.radius,0,2*Math.PI),n.closePath(),h.fill&&(n.globalAlpha=h.fillAlpha*a,n.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6),n.fill()),h.lineWidth&&(n.globalAlpha=h.lineAlpha*a,n.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),n.stroke());else if(h.type===rr.SHAPES.ELIP){var M=u.width*2,O=u.height*2,F=u.x-M/2,L=u.y-O/2;n.beginPath();var B=.5522848,I=M/2*B,U=O/2*B,G=F+M,$=L+O,k=F+M/2,q=L+O/2;n.moveTo(F,q),n.bezierCurveTo(F,q-U,k-I,L,k,L),n.bezierCurveTo(k+I,L,G,q-U,G,q),n.bezierCurveTo(G,q+U,k+I,$,k,$),n.bezierCurveTo(k-I,$,F,q+U,F,q),n.closePath(),h.fill&&(n.globalAlpha=h.fillAlpha*a,n.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6),n.fill()),h.lineWidth&&(n.globalAlpha=h.lineAlpha*a,n.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),n.stroke())}else if(h.type===rr.SHAPES.RREC){var z=u.x,H=u.y,et=u.width,it=u.height,j=u.radius,wt=Math.min(et,it)/2|0;j=j>wt?wt:j,n.beginPath(),n.moveTo(z,H+j),n.lineTo(z,H+it-j),n.quadraticCurveTo(z,H+it,z+j,H+it),n.lineTo(z+et-j,H+it),n.quadraticCurveTo(z+et,H+it,z+et,H+it-j),n.lineTo(z+et,H+j),n.quadraticCurveTo(z+et,H,z+et-j,H),n.lineTo(z+j,H),n.quadraticCurveTo(z,H,z,H+j),n.closePath(),(h.fillColor||h.fillColor===0)&&(n.globalAlpha=h.fillAlpha*a,n.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6),n.fill()),h.lineWidth&&(n.globalAlpha=h.lineAlpha*a,n.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),n.stroke())}}},r.prototype.updateGraphicsTint=function(i){i._prevTint=i.tint,i.canvasTintDirty=i.dirty;for(var e=(i.tint>>16&255)/255,n=(i.tint>>8&255)/255,a=(i.tint&255)/255,s=0;s<i.graphicsData.length;++s){var o=i.graphicsData[s],l=o.fillColor|0,h=o.lineColor|0;o._fillTint=((l>>16&255)/255*e*255<<16)+((l>>8&255)/255*n*255<<8)+(l&255)/255*a*255,o._lineTint=((h>>16&255)/255*e*255<<16)+((h>>8&255)/255*n*255<<8)+(h&255)/255*a*255}},r.prototype.renderPolygon=function(i,e,n){n.moveTo(i[0],i[1]);for(var a=1;a<i.length/2;++a)n.lineTo(i[a*2],i[a*2+1]);e&&n.closePath()},r.prototype.destroy=function(){this.renderer=null},r}();ys.default=Ph;WT.default.registerPlugin("graphics",Ph);var ai={},il;function zT(){if(il)return ai;il=1,ai.__esModule=!0;var r=function(){function a(s,o){for(var l=0;l<o.length;l++){var h=o[l];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(s,h.key,h)}}return function(s,o,l){return o&&a(s.prototype,o),l&&a(s,l),s}}(),t=at(),i=X;function e(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var n=function(){r(a,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]);function a(s,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;e(this,a),this.baseTexture=s,this.textures={},this.animations={},this.data=o,this.resolution=this._updateResolution(l||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return a.prototype._updateResolution=function(o){var l=this.data.meta.scale,h=(0,i.getResolutionOfUrl)(o,null);return h===null&&(h=l!==void 0?parseFloat(l):1),h!==1&&(this.baseTexture.resolution=h,this.baseTexture.update()),h},a.prototype.parse=function(o){this._batchIndex=0,this._callback=o,this._frameKeys.length<=a.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},a.prototype._processFrames=function(o){for(var l=o,h=a.BATCH_SIZE,u=this.baseTexture.sourceScale;l-o<h&&l<this._frameKeys.length;){var f=this._frameKeys[l],d=this._frames[f],p=d.frame;if(p){var _=null,m=null,g=d.trimmed!==!1&&d.sourceSize?d.sourceSize:d.frame,y=new t.Rectangle(0,0,Math.floor(g.w*u)/this.resolution,Math.floor(g.h*u)/this.resolution);d.rotated?_=new t.Rectangle(Math.floor(p.x*u)/this.resolution,Math.floor(p.y*u)/this.resolution,Math.floor(p.h*u)/this.resolution,Math.floor(p.w*u)/this.resolution):_=new t.Rectangle(Math.floor(p.x*u)/this.resolution,Math.floor(p.y*u)/this.resolution,Math.floor(p.w*u)/this.resolution,Math.floor(p.h*u)/this.resolution),d.trimmed!==!1&&d.spriteSourceSize&&(m=new t.Rectangle(Math.floor(d.spriteSourceSize.x*u)/this.resolution,Math.floor(d.spriteSourceSize.y*u)/this.resolution,Math.floor(p.w*u)/this.resolution,Math.floor(p.h*u)/this.resolution)),this.textures[f]=new t.Texture(this.baseTexture,_,y,m,d.rotated?2:0,d.anchor),t.Texture.addToCache(this.textures[f],f)}l++}},a.prototype._processAnimations=function(){var o=this.data.animations||{};for(var l in o){this.animations[l]=[];for(var f=o[l],h=Array.isArray(f),u=0,f=h?f:f[Symbol.iterator]();;){var d;if(h){if(u>=f.length)break;d=f[u++]}else{if(u=f.next(),u.done)break;d=u.value}var p=d;this.animations[l].push(this.textures[p])}}},a.prototype._parseComplete=function(){var o=this._callback;this._callback=null,this._batchIndex=0,o.call(this,this.textures)},a.prototype._nextBatch=function(){var o=this;this._processFrames(this._batchIndex*a.BATCH_SIZE),this._batchIndex++,setTimeout(function(){o._batchIndex*a.BATCH_SIZE<o._frameKeys.length?o._nextBatch():(o._processAnimations(),o._parseComplete())},0)},a.prototype.destroy=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;for(var l in this.textures)this.textures[l].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,o&&this.baseTexture.destroy(),this.baseTexture=null},a}();return ai.default=n,ai}var Ki={},Zi={};Zi.__esModule=!0;Zi.autoDetectRenderer=ex;var qT=X,KT=tx(qT),ZT=Oe,QT=Rh(ZT),JT=Ve,jT=Rh(JT);function Rh(r){return r&&r.__esModule?r:{default:r}}function tx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function ex(r,t,i,e){var n=r&&r.forceCanvas;return e!==void 0&&(n=e),!n&&KT.isWebGLSupported()?new jT.default(r,t,i):new QT.default(r,t,i)}Ki.__esModule=!0;var rx=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),ix=Zi,nx=Me,ax=Ih(nx),nl=ce,sx=_t,ox=Ih(sx),lx=W;function Ih(r){return r&&r.__esModule?r:{default:r}}function hx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ux=function(){function r(t,i,e,n,a){hx(this,r),typeof t=="number"&&(t=Object.assign({width:t,height:i||ox.default.RENDER_OPTIONS.height,forceCanvas:!!n,sharedTicker:!!a},e)),this._options=t=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},t),this.renderer=(0,ix.autoDetectRenderer)(t),this.stage=new ax.default,this._ticker=null,this.ticker=t.sharedTicker?nl.shared:new nl.Ticker,t.autoStart&&this.start()}return r.prototype.render=function(){this.renderer.render(this.stage)},r.prototype.stop=function(){this._ticker.stop()},r.prototype.start=function(){this._ticker.start()},r.prototype.destroy=function(i,e){if(this._ticker){var n=this._ticker;this.ticker=null,n.destroy()}this.stage.destroy(e),this.stage=null,this.renderer.destroy(i),this.renderer=null,this._options=null},rx(r,[{key:"ticker",set:function(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,lx.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),r}();Ki.default=ux;var al;function at(){return al||(al=1,function(r){r.__esModule=!0,r.autoDetectRenderer=r.Application=r.Filter=r.SpriteMaskFilter=r.Quad=r.RenderTarget=r.ObjectRenderer=r.WebGLManager=r.Shader=r.CanvasRenderTarget=r.TextureUvs=r.VideoBaseTexture=r.BaseRenderTexture=r.RenderTexture=r.BaseTexture=r.TextureMatrix=r.Texture=r.Spritesheet=r.CanvasGraphicsRenderer=r.GraphicsRenderer=r.GraphicsData=r.Graphics=r.TextMetrics=r.TextStyle=r.Text=r.SpriteRenderer=r.CanvasTinter=r.CanvasSpriteRenderer=r.Sprite=r.TransformBase=r.TransformStatic=r.Transform=r.Container=r.DisplayObject=r.Bounds=r.glCore=r.WebGLRenderer=r.CanvasRenderer=r.ticker=r.utils=r.settings=void 0;var t=W;Object.keys(t).forEach(function(V){V==="default"||V==="__esModule"||Object.defineProperty(r,V,{enumerable:!0,get:function(){return t[V]}})});var i=vt;Object.keys(i).forEach(function(V){V==="default"||V==="__esModule"||Object.defineProperty(r,V,{enumerable:!0,get:function(){return i[V]}})});var e=At;Object.defineProperty(r,"glCore",{enumerable:!0,get:function(){return J(e).default}});var n=Mr;Object.defineProperty(r,"Bounds",{enumerable:!0,get:function(){return J(n).default}});var a=Ai;Object.defineProperty(r,"DisplayObject",{enumerable:!0,get:function(){return J(a).default}});var s=Me;Object.defineProperty(r,"Container",{enumerable:!0,get:function(){return J(s).default}});var o=Oi;Object.defineProperty(r,"Transform",{enumerable:!0,get:function(){return J(o).default}});var l=Mi;Object.defineProperty(r,"TransformStatic",{enumerable:!0,get:function(){return J(l).default}});var h=Or;Object.defineProperty(r,"TransformBase",{enumerable:!0,get:function(){return J(h).default}});var u=Ir;Object.defineProperty(r,"Sprite",{enumerable:!0,get:function(){return J(u).default}});var f=Wa;Object.defineProperty(r,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return J(f).default}});var d=Ge;Object.defineProperty(r,"CanvasTinter",{enumerable:!0,get:function(){return J(d).default}});var p=za;Object.defineProperty(r,"SpriteRenderer",{enumerable:!0,get:function(){return J(p).default}});var _=os;Object.defineProperty(r,"Text",{enumerable:!0,get:function(){return J(_).default}});var m=Yi;Object.defineProperty(r,"TextStyle",{enumerable:!0,get:function(){return J(m).default}});var g=zi;Object.defineProperty(r,"TextMetrics",{enumerable:!0,get:function(){return J(g).default}});var y=hs;Object.defineProperty(r,"Graphics",{enumerable:!0,get:function(){return J(y).default}});var w=qi;Object.defineProperty(r,"GraphicsData",{enumerable:!0,get:function(){return J(w).default}});var T=cs;Object.defineProperty(r,"GraphicsRenderer",{enumerable:!0,get:function(){return J(T).default}});var x=ys;Object.defineProperty(r,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return J(x).default}});var E=zT();Object.defineProperty(r,"Spritesheet",{enumerable:!0,get:function(){return J(E).default}});var b=Yt;Object.defineProperty(r,"Texture",{enumerable:!0,get:function(){return J(b).default}});var D=Wi;Object.defineProperty(r,"TextureMatrix",{enumerable:!0,get:function(){return J(D).default}});var S=de;Object.defineProperty(r,"BaseTexture",{enumerable:!0,get:function(){return J(S).default}});var M=Fr;Object.defineProperty(r,"RenderTexture",{enumerable:!0,get:function(){return J(M).default}});var O=ki;Object.defineProperty(r,"BaseRenderTexture",{enumerable:!0,get:function(){return J(O).default}});var F=Fi;Object.defineProperty(r,"VideoBaseTexture",{enumerable:!0,get:function(){return J(F).default}});var L=Bi;Object.defineProperty(r,"TextureUvs",{enumerable:!0,get:function(){return J(L).default}});var B=$i;Object.defineProperty(r,"CanvasRenderTarget",{enumerable:!0,get:function(){return J(B).default}});var I=Re;Object.defineProperty(r,"Shader",{enumerable:!0,get:function(){return J(I).default}});var U=Pe;Object.defineProperty(r,"WebGLManager",{enumerable:!0,get:function(){return J(U).default}});var G=Xe;Object.defineProperty(r,"ObjectRenderer",{enumerable:!0,get:function(){return J(G).default}});var $=We;Object.defineProperty(r,"RenderTarget",{enumerable:!0,get:function(){return J($).default}});var k=Hi;Object.defineProperty(r,"Quad",{enumerable:!0,get:function(){return J(k).default}});var q=Xi;Object.defineProperty(r,"SpriteMaskFilter",{enumerable:!0,get:function(){return J(q).default}});var z=Vi;Object.defineProperty(r,"Filter",{enumerable:!0,get:function(){return J(z).default}});var H=Ki;Object.defineProperty(r,"Application",{enumerable:!0,get:function(){return J(H).default}});var et=Zi;Object.defineProperty(r,"autoDetectRenderer",{enumerable:!0,get:function(){return et.autoDetectRenderer}});var it=X,j=ro(it),wt=ce,ot=ro(wt),nt=_t,Rt=J(nt),Hr=Oe,vu=J(Hr),yu=Ve,Tu=J(yu);function ro(V){if(V&&V.__esModule)return V;var ze={};if(V!=null)for(var dn in V)Object.prototype.hasOwnProperty.call(V,dn)&&(ze[dn]=V[dn]);return ze.default=V,ze}function J(V){return V&&V.__esModule?V:{default:V}}r.settings=Rt.default,r.utils=j,r.ticker=ot,r.CanvasRenderer=vu.default,r.WebGLRenderer=Tu.default}(yn)),yn}var Ts={};Ts.__esModule=!0;Ts.default=fx;var sl={};function N(r){if(!sl[r]){var t=new Error().stack;typeof t>"u"?console.warn("Deprecation Warning: ",r):(t=t.split(`
`).splice(3).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(t),console.groupEnd()):(console.warn("Deprecation Warning: ",r),console.warn(t))),sl[r]=!0}}function fx(r){var t=r.mesh,i=r.particles,e=r.extras,n=r.filters,a=r.prepare,s=r.loaders,o=r.interaction;Object.defineProperties(r,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return N("You do not need to use a PIXI Stage any more, you can simply render any container."),r.Container}},DisplayObjectContainer:{get:function(){return N("DisplayObjectContainer has been shortened to Container, please use Container from now on."),r.Container}},Strip:{get:function(){return N("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),t.Mesh}},Rope:{get:function(){return N("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),t.Rope}},ParticleContainer:{get:function(){return N("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),i.ParticleContainer}},MovieClip:{get:function(){return N("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),e.AnimatedSprite}},TilingSprite:{get:function(){return N("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),e.TilingSprite}},BitmapText:{get:function(){return N("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),e.BitmapText}},blendModes:{get:function(){return N("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),r.BLEND_MODES}},scaleModes:{get:function(){return N("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),r.SCALE_MODES}},BaseTextureCache:{get:function(){return N("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),r.utils.BaseTextureCache}},TextureCache:{get:function(){return N("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),r.utils.TextureCache}},math:{get:function(){return N("The math namespace is deprecated, please access members already accessible on PIXI."),r}},AbstractFilter:{get:function(){return N("AstractFilter has been renamed to Filter, please use PIXI.Filter"),r.Filter}},TransformManual:{get:function(){return N("TransformManual has been renamed to TransformBase, please update your pixi-spine"),r.TransformBase}},TARGET_FPMS:{get:function(){return N("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),r.settings.TARGET_FPMS},set:function(m){N("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),r.settings.TARGET_FPMS=m}},FILTER_RESOLUTION:{get:function(){return N("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),r.settings.FILTER_RESOLUTION},set:function(m){N("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),r.settings.FILTER_RESOLUTION=m}},RESOLUTION:{get:function(){return N("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),r.settings.RESOLUTION},set:function(m){N("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),r.settings.RESOLUTION=m}},MIPMAP_TEXTURES:{get:function(){return N("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),r.settings.MIPMAP_TEXTURES},set:function(m){N("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),r.settings.MIPMAP_TEXTURES=m}},SPRITE_BATCH_SIZE:{get:function(){return N("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),r.settings.SPRITE_BATCH_SIZE},set:function(m){N("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),r.settings.SPRITE_BATCH_SIZE=m}},SPRITE_MAX_TEXTURES:{get:function(){return N("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),r.settings.SPRITE_MAX_TEXTURES},set:function(m){N("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),r.settings.SPRITE_MAX_TEXTURES=m}},RETINA_PREFIX:{get:function(){return N("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),r.settings.RETINA_PREFIX},set:function(m){N("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),r.settings.RETINA_PREFIX=m}},DEFAULT_RENDER_OPTIONS:{get:function(){return N("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),r.settings.RENDER_OPTIONS}}});for(var l=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],h=function(m){var g=l[m];Object.defineProperty(r[g.parent],"DEFAULT",{get:function(){return N("PIXI."+g.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+g.target)),r.settings[g.target]},set:function(w){N("PIXI."+g.parent+".DEFAULT has been deprecated, "+("please use PIXI.settings."+g.target)),r.settings[g.target]=w}})},u=0;u<l.length;u++)h(u);Object.defineProperties(r.settings,{PRECISION:{get:function(){return N("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),r.settings.PRECISION_FRAGMENT},set:function(m){N("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),r.settings.PRECISION_FRAGMENT=m}}}),e.AnimatedSprite&&Object.defineProperties(e,{MovieClip:{get:function(){return N("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),e.AnimatedSprite}}}),e&&Object.defineProperties(e,{TextureTransform:{get:function(){return N("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),r.TextureMatrix}}}),r.DisplayObject.prototype.generateTexture=function(m,g,y){return N("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),m.generateTexture(this,g,y)},r.Graphics.prototype.generateTexture=function(m,g){return N("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(m,g)},r.GroupD8.isSwapWidthHeight=function(m){return N("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),r.GroupD8.isVertical(m)},r.RenderTexture.prototype.render=function(m,g,y,w){this.legacyRenderer.render(m,this,y,g,!w),N("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},r.RenderTexture.prototype.getImage=function(m){return N("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(m)},r.RenderTexture.prototype.getBase64=function(m){return N("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(m)},r.RenderTexture.prototype.getCanvas=function(m){return N("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(m)},r.RenderTexture.prototype.getPixels=function(m){return N("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(m)},r.Sprite.prototype.setTexture=function(m){this.texture=m,N("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},e.BitmapText&&(e.BitmapText.prototype.setText=function(m){this.text=m,N("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),r.Text.prototype.setText=function(m){this.text=m,N("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},r.Text.calculateFontProperties=function(m){return N("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),r.TextMetrics.measureFont(m)},Object.defineProperties(r.Text,{fontPropertiesCache:{get:function(){return N("Text.fontPropertiesCache is deprecated"),r.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return N("Text.fontPropertiesCanvas is deprecated"),r.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return N("Text.fontPropertiesContext is deprecated"),r.TextMetrics._context}}}),r.Text.prototype.setStyle=function(m){this.style=m,N("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},r.Text.prototype.determineFontProperties=function(m){return N("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),r.TextMetrics.measureFont(m)},r.Text.getFontStyle=function(m){return N("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),m=m||{},m instanceof r.TextStyle||(m=new r.TextStyle(m)),m.toFontString()},Object.defineProperties(r.TextStyle.prototype,{font:{get:function(){N("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var m=typeof this._fontSize=="number"?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+m+" "+this._fontFamily},set:function(m){N("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),m.indexOf("italic")>1?this._fontStyle="italic":m.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",m.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var g=m.split(" "),y=-1;this._fontSize=26;for(var w=0;w<g.length;++w)if(g[w].match(/(px|pt|em|%)/)){y=w,this._fontSize=g[w];break}this._fontWeight="normal";for(var T=0;T<y;++T)if(g[T].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=g[T];break}if(y>-1&&y<g.length-1){this._fontFamily="";for(var x=y+1;x<g.length;++x)this._fontFamily+=g[x]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),r.Texture.prototype.setFrame=function(m){this.frame=m,N("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},r.Texture.addTextureToCache=function(m,g){r.Texture.addToCache(m,g),N("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},r.Texture.removeTextureFromCache=function(m){return N("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),r.BaseTexture.removeFromCache(m),r.Texture.removeFromCache(m)},Object.defineProperties(n,{AbstractFilter:{get:function(){return N("AstractFilter has been renamed to Filter, please use PIXI.Filter"),r.AbstractFilter}},SpriteMaskFilter:{get:function(){return N("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),r.SpriteMaskFilter}},VoidFilter:{get:function(){return N("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),n.AlphaFilter}}}),r.utils.uuid=function(){return N("utils.uuid() is deprecated, please use utils.uid() from now on."),r.utils.uid()},r.utils.canUseNewCanvasBlendModes=function(){return N("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),r.CanvasTinter.canUseMultiply};var f=!0;if(Object.defineProperty(r.utils,"_saidHello",{set:function(m){m&&(N("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),f=m},get:function(){return f}}),a.BasePrepare&&(a.BasePrepare.prototype.register=function(m,g){return N("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),m&&this.registerFindHook(m),g&&this.registerUploadHook(g),this}),a.canvas&&Object.defineProperty(a.canvas,"UPLOADS_PER_FRAME",{set:function(){N("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return N("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),a.webgl&&Object.defineProperty(a.webgl,"UPLOADS_PER_FRAME",{set:function(){N("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return N("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),s.Loader){var d=s.Resource,p=s.Loader;Object.defineProperties(d.prototype,{isJson:{get:function(){return N("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===d.TYPE.JSON}},isXml:{get:function(){return N("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===d.TYPE.XML}},isImage:{get:function(){return N("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===d.TYPE.IMAGE}},isAudio:{get:function(){return N("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===d.TYPE.AUDIO}},isVideo:{get:function(){return N("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===d.TYPE.VIDEO}}}),Object.defineProperties(p.prototype,{before:{get:function(){return N("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return N("The after() method is deprecated, please use use()."),this.use}}})}o.interactiveTarget&&Object.defineProperty(o.interactiveTarget,"defaultCursor",{set:function(m){N("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=m},get:function(){return N("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),o.InteractionManager&&(Object.defineProperty(o.InteractionManager,"defaultCursorStyle",{set:function(m){N("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=m},get:function(){return N("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(o.InteractionManager,"currentCursorStyle",{set:function(m){N("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=m},get:function(){return N("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}var Ch={},Qi={};Qi.__esModule=!0;Qi.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1};var xs={};xs.__esModule=!0;var cx=at(),xr=mx(cx),dx=pr,ol=Fh(dx),_x=Qi,px=Fh(_x);function Fh(r){return r&&r.__esModule?r:{default:r}}function mx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function gx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}xr.utils.mixins.delayMixin(xr.DisplayObject.prototype,px.default);var vx=9,si=100,yx=0,Tx=0,ll=2,hl=1,xx=-1e3,wx=-1e3,bx=2,ws=function(){function r(t){gx(this,r),(ol.default.tablet||ol.default.phone)&&!navigator.isCocoonJS&&this.createTouchHook();var i=document.createElement("div");i.style.width=si+"px",i.style.height=si+"px",i.style.position="absolute",i.style.top=yx+"px",i.style.left=Tx+"px",i.style.zIndex=ll,this.div=i,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return r.prototype.createTouchHook=function(){var i=this,e=document.createElement("button");e.style.width=hl+"px",e.style.height=hl+"px",e.style.position="absolute",e.style.top=xx+"px",e.style.left=wx+"px",e.style.zIndex=bx,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){i.isMobileAccessabillity=!0,i.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},r.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},r.prototype.deactivate=function(){!this.isActive||this.isMobileAccessabillity||(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},r.prototype.updateAccessibleObjects=function(i){if(i.visible){i.accessible&&i.interactive&&(i._accessibleActive||this.addChild(i),i.renderId=this.renderId);for(var e=i.children,n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},r.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var i=this.renderer.view.getBoundingClientRect(),e=i.width/this.renderer.width,n=i.height/this.renderer.height,a=this.div;a.style.left=i.left+"px",a.style.top=i.top+"px",a.style.width=this.renderer.width+"px",a.style.height=this.renderer.height+"px";for(var s=0;s<this.children.length;s++){var o=this.children[s];if(o.renderId!==this.renderId)o._accessibleActive=!1,xr.utils.removeItems(this.children,s,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,s--,this.children.length===0&&this.deactivate();else{a=o._accessibleDiv;var l=o.hitArea,h=o.worldTransform;o.hitArea?(a.style.left=(h.tx+l.x*h.a)*e+"px",a.style.top=(h.ty+l.y*h.d)*n+"px",a.style.width=l.width*h.a*e+"px",a.style.height=l.height*h.d*n+"px"):(l=o.getBounds(),this.capHitArea(l),a.style.left=l.x*e+"px",a.style.top=l.y*n+"px",a.style.width=l.width*e+"px",a.style.height=l.height*n+"px",a.title!==o.accessibleTitle&&o.accessibleTitle!==null&&(a.title=o.accessibleTitle),a.getAttribute("aria-label")!==o.accessibleHint&&o.accessibleHint!==null&&a.setAttribute("aria-label",o.accessibleHint))}}this.renderId++}},r.prototype.capHitArea=function(i){i.x<0&&(i.width+=i.x,i.x=0),i.y<0&&(i.height+=i.y,i.y=0),i.x+i.width>this.renderer.width&&(i.width=this.renderer.width-i.x),i.y+i.height>this.renderer.height&&(i.height=this.renderer.height-i.y)},r.prototype.addChild=function(i){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=si+"px",e.style.height=si+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=ll,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),i.accessibleTitle&&i.accessibleTitle!==null?e.title=i.accessibleTitle:(!i.accessibleHint||i.accessibleHint===null)&&(e.title="displayObject "+i.tabIndex),i.accessibleHint&&i.accessibleHint!==null&&e.setAttribute("aria-label",i.accessibleHint),i._accessibleActive=!0,i._accessibleDiv=e,e.displayObject=i,this.children.push(i),this.div.appendChild(i._accessibleDiv),i._accessibleDiv.tabIndex=i.tabIndex},r.prototype._onClick=function(i){var e=this.renderer.plugins.interaction;e.dispatchEvent(i.target.displayObject,"click",e.eventData)},r.prototype._onFocus=function(i){i.target.getAttribute("aria-live","off")||i.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(i.target.displayObject,"mouseover",e.eventData)},r.prototype._onFocusOut=function(i){i.target.getAttribute("aria-live","off")||i.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(i.target.displayObject,"mouseout",e.eventData)},r.prototype._onKeyDown=function(i){i.keyCode===vx&&this.activate()},r.prototype._onMouseMove=function(i){i.movementX===0&&i.movementY===0||this.deactivate()},r.prototype.destroy=function(){this.div=null;for(var i=0;i<this.children.length;i++)this.children[i].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},r}();xs.default=ws;xr.WebGLRenderer.registerPlugin("accessibility",ws);xr.CanvasRenderer.registerPlugin("accessibility",ws);(function(r){r.__esModule=!0;var t=Qi;Object.defineProperty(r,"accessibleTarget",{enumerable:!0,get:function(){return e(t).default}});var i=xs;Object.defineProperty(r,"AccessibilityManager",{enumerable:!0,get:function(){return e(i).default}});function e(n){return n&&n.__esModule?n:{default:n}}})(Ch);var Bh={},bs={};bs.__esModule=!0;var Ex=at(),dr=Sx(Ex);function Sx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Dx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ul=new dr.Rectangle,fl=4,Lh=function(){function r(t){Dx(this,r),this.renderer=t,t.extract=this}return r.prototype.image=function(i){var e=new Image;return e.src=this.base64(i),e},r.prototype.base64=function(i){return this.canvas(i).toDataURL()},r.prototype.canvas=function(i){var e=this.renderer,n=void 0,a=void 0,s=void 0,o=!1,l=void 0,h=!1;i&&(i instanceof dr.RenderTexture?l=i:(l=this.renderer.generateTexture(i),h=!0)),l?(n=l.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=n.resolution,s=l.frame,o=!1):(n=this.renderer.rootRenderTarget,a=n.resolution,o=!0,s=ul,s.width=n.size.width,s.height=n.size.height);var u=Math.floor(s.width*a+1e-4),f=Math.floor(s.height*a+1e-4),d=new dr.CanvasRenderTarget(u,f,1);if(n){e.bindRenderTarget(n);var p=new Uint8Array(fl*u*f),_=e.gl;_.readPixels(s.x*a,s.y*a,u,f,_.RGBA,_.UNSIGNED_BYTE,p);var m=d.context.getImageData(0,0,u,f);m.data.set(p),d.context.putImageData(m,0,0),o&&(d.context.scale(1,-1),d.context.drawImage(d.canvas,0,-f))}return h&&l.destroy(!0),d.canvas},r.prototype.pixels=function(i){var e=this.renderer,n=void 0,a=void 0,s=void 0,o=void 0,l=!1;i&&(i instanceof dr.RenderTexture?o=i:(o=this.renderer.generateTexture(i),l=!0)),o?(n=o.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=n.resolution,s=o.frame):(n=this.renderer.rootRenderTarget,a=n.resolution,s=ul,s.width=n.size.width,s.height=n.size.height);var h=s.width*a,u=s.height*a,f=new Uint8Array(fl*h*u);if(n){e.bindRenderTarget(n);var d=e.gl;d.readPixels(s.x*a,s.y*a,h,u,d.RGBA,d.UNSIGNED_BYTE,f)}return l&&o.destroy(!0),f},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},r}();bs.default=Lh;dr.WebGLRenderer.registerPlugin("extract",Lh);var Es={};Es.__esModule=!0;var Ax=at(),_r=Mx(Ax);function Mx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Ox(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var cl=new _r.Rectangle,Nh=function(){function r(t){Ox(this,r),this.renderer=t,t.extract=this}return r.prototype.image=function(i){var e=new Image;return e.src=this.base64(i),e},r.prototype.base64=function(i){return this.canvas(i).toDataURL()},r.prototype.canvas=function(i){var e=this.renderer,n=void 0,a=void 0,s=void 0,o=void 0;i&&(i instanceof _r.RenderTexture?o=i:o=e.generateTexture(i)),o?(n=o.baseTexture._canvasRenderTarget.context,a=o.baseTexture._canvasRenderTarget.resolution,s=o.frame):(n=e.rootContext,a=e.resolution,s=cl,s.width=this.renderer.width,s.height=this.renderer.height);var l=Math.floor(s.width*a+1e-4),h=Math.floor(s.height*a+1e-4),u=new _r.CanvasRenderTarget(l,h,1),f=n.getImageData(s.x*a,s.y*a,l,h);return u.context.putImageData(f,0,0),u.canvas},r.prototype.pixels=function(i){var e=this.renderer,n=void 0,a=void 0,s=void 0,o=void 0;return i&&(i instanceof _r.RenderTexture?o=i:o=e.generateTexture(i)),o?(n=o.baseTexture._canvasRenderTarget.context,a=o.baseTexture._canvasRenderTarget.resolution,s=o.frame):(n=e.rootContext,s=cl,s.width=e.width,s.height=e.height),n.getImageData(0,0,s.width*a,s.height*a).data},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},r}();Es.default=Nh;_r.CanvasRenderer.registerPlugin("extract",Nh);(function(r){r.__esModule=!0;var t=bs;Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return e(t).default}});var i=Es;Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return e(i).default}});function e(n){return n&&n.__esModule?n:{default:n}}})(Bh);var Ss={},Ds={};Ds.__esModule=!0;var Px=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Rx=at(),re=Ix(Rx);function Ix(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Cx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Fx(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Bx(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Lx=function(r){Bx(t,r);function t(i,e){Cx(this,t);var n=Fx(this,r.call(this,i[0]instanceof re.Texture?i[0]:i[0].texture));return n._textures=null,n._durations=null,n.textures=i,n._autoUpdate=e!==!1,n.animationSpeed=1,n.loop=!0,n.updateAnchor=!1,n.onComplete=null,n.onFrameChange=null,n.onLoop=null,n._currentTime=0,n.playing=!1,n}return t.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&re.ticker.shared.remove(this.update,this))},t.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&re.ticker.shared.add(this.update,this,re.UPDATE_PRIORITY.HIGH))},t.prototype.gotoAndStop=function(e){this.stop();var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){var n=this.animationSpeed*e,a=this.currentFrame;if(this._durations!==null){var s=this._currentTime%1*this._durations[this.currentFrame];for(s+=n/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):a!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<a?this.onLoop():this.animationSpeed<0&&this.currentFrame>a&&this.onLoop()),this.updateTexture())},t.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.updateAnchor&&this._anchor.copy(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame)},t.prototype.destroy=function(e){this.stop(),r.prototype.destroy.call(this,e)},t.fromFrames=function(e){for(var n=[],a=0;a<e.length;++a)n.push(re.Texture.fromFrame(e[a]));return new t(n)},t.fromImages=function(e){for(var n=[],a=0;a<e.length;++a)n.push(re.Texture.fromImage(e[a]));return new t(n)},Px(t,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(e){if(e[0]instanceof re.Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}}]),t}(re.Sprite);Ds.default=Lx;var As={};As.__esModule=!0;var Nx=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),kx=at(),qt=Xx(kx),Ux=Ge,$x=Gx(Ux);function Gx(r){return r&&r.__esModule?r:{default:r}}function Xx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Vx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Wx(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Hx(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var ir=new qt.Point,Yx=function(r){Hx(t,r);function t(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:100;Vx(this,t);var a=Wx(this,r.call(this,i));return a.tileTransform=new qt.TransformStatic,a._width=e,a._height=n,a._canvasPattern=null,a.uvTransform=i.transform||new qt.TextureMatrix(i),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return t.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},t.prototype._renderWebGL=function(e){var n=this._texture;!n||!n.valid||(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._renderCanvas=function(e){var n=this._texture;if(n.baseTexture.hasLoaded){var a=e.context,s=this.worldTransform,o=e.resolution,l=n.rotate===2,h=n.baseTexture,u=h.resolution,f=this.tilePosition.x/this.tileScale.x%n.orig.width*u,d=this.tilePosition.y/this.tileScale.y%n.orig.height*u;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var p=new qt.CanvasRenderTarget(n.orig.width,n.orig.height,u);if(this.tint!==16777215)this.tintedTexture=$x.default.getTintedTexture(this,this.tint),p.context.drawImage(this.tintedTexture,0,0);else{var _=n._frame.x*u,m=n._frame.y*u,g=n._frame.width*u,y=n._frame.height*u,w=(n.trim?n.trim.width:n.orig.width)*u,T=(n.trim?n.trim.height:n.orig.height)*u,x=(n.trim?n.trim.x:0)*u,E=(n.trim?n.trim.y:0)*u;l?(p.context.rotate(-Math.PI/2),p.context.translate(-T,0),p.context.drawImage(h.source,_,m,g,y,-E,x,T,w)):p.context.drawImage(h.source,_,m,g,y,x,E,w,T)}this.cachedTint=this.tint,this._canvasPattern=p.context.createPattern(p.canvas,"repeat")}a.globalAlpha=this.worldAlpha,a.setTransform(s.a*o,s.b*o,s.c*o,s.d*o,s.tx*o,s.ty*o),e.setBlendMode(this.blendMode),a.fillStyle=this._canvasPattern,a.scale(this.tileScale.x/u,this.tileScale.y/u);var b=this.anchor.x*-this._width*u,D=this.anchor.y*-this._height*u;this.uvRespectAnchor?(a.translate(f,d),a.fillRect(-f+b,-d+D,this._width/this.tileScale.x*u,this._height/this.tileScale.y*u)):(a.translate(f+b,d+D),a.fillRect(-f,-d,this._width/this.tileScale.x*u,this._height/this.tileScale.y*u))}},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,n=this._height*-this._anchor._y,a=this._width*(1-this._anchor._x),s=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,n,a,s)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new qt.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,ir);var n=this._width,a=this._height,s=-n*this.anchor._x;if(ir.x>=s&&ir.x<s+n){var o=-a*this.anchor._y;if(ir.y>=o&&ir.y<o+a)return!0}return!1},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},t.from=function(e,n,a){return new t(qt.Texture.from(e),n,a)},t.fromFrame=function(e,n,a){var s=qt.utils.TextureCache[e];if(!s)throw new Error('The frameId "'+e+'" does not exist in the texture cache '+this);return new t(s,n,a)},t.fromImage=function(e,n,a,s,o){return new t(qt.Texture.fromImage(e,s,o),n,a)},Nx(t,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(e){this.uvTransform.clampMargin=e,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copy(e)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copy(e)}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}]),t}(qt.Sprite);As.default=Yx;var Ms={};Ms.__esModule=!0;var zx=at(),ne=qx(zx),jn=W;function qx(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Kx(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Zx(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Qx(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var oi=new ne.Matrix,kh=function(r){Qx(t,r);function t(i){Kx(this,t);var e=Zx(this,r.call(this,i));return e.shader=null,e.simpleShader=null,e.quad=null,e}return t.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new ne.Shader(e,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 sample = texture2D(uSampler, coord);
    gl_FragColor = sample * uColor;
}
`),this.simpleShader=new ne.Shader(e,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 sample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = sample * uColor;
}
`),this.renderer.bindVao(null),this.quad=new ne.Quad(e,this.renderer.state.attribState),this.quad.initVao(this.shader)},t.prototype.render=function(e){var n=this.renderer,a=this.quad;n.bindVao(a.vao);var s=a.vertices;s[0]=s[6]=e._width*-e.anchor.x,s[1]=s[3]=e._height*-e.anchor.y,s[2]=s[4]=e._width*(1-e.anchor.x),s[5]=s[7]=e._height*(1-e.anchor.y),e.uvRespectAnchor&&(s=a.uvs,s[0]=s[6]=-e.anchor.x,s[1]=s[3]=-e.anchor.y,s[2]=s[4]=1-e.anchor.x,s[5]=s[7]=1-e.anchor.y),a.upload();var o=e._texture,l=o.baseTexture,h=e.tileTransform.localTransform,u=e.uvTransform,f=l.isPowerOfTwo&&o.frame.width===l.width&&o.frame.height===l.height;f&&(l._glTextures[n.CONTEXT_UID]?f=l.wrapMode!==jn.WRAP_MODES.CLAMP:l.wrapMode===jn.WRAP_MODES.CLAMP&&(l.wrapMode=jn.WRAP_MODES.REPEAT));var d=f?this.simpleShader:this.shader;n.bindShader(d);var p=o.width,_=o.height,m=e._width,g=e._height;oi.set(h.a*p/m,h.b*p/g,h.c*_/m,h.d*_/g,h.tx/m,h.ty/g),oi.invert(),f?oi.prepend(u.mapCoord):(d.uniforms.uMapCoord=u.mapCoord.toArray(!0),d.uniforms.uClampFrame=u.uClampFrame,d.uniforms.uClampOffset=u.uClampOffset),d.uniforms.uTransform=oi.toArray(!0),d.uniforms.uColor=ne.utils.premultiplyTintToRgba(e.tint,e.worldAlpha,d.uniforms.uColor,l.premultipliedAlpha),d.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),d.uniforms.uSampler=n.bindTexture(o),n.setBlendMode(ne.utils.correctBlendMode(e.blendMode,l.premultipliedAlpha)),a.vao.draw(this.renderer.gl.TRIANGLES,6,0)},t}(ne.ObjectRenderer);Ms.default=kh;ne.WebGLRenderer.registerPlugin("tilingSprite",kh);var Os={};Os.__esModule=!0;var Jx=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),jx=at(),ie=aw(jx),tw=Si,ew=Uh(tw),rw=X,iw=_t,nw=Uh(iw);function Uh(r){return r&&r.__esModule?r:{default:r}}function aw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function sw(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function ow(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function lw(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var $h=function(r){lw(t,r);function t(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sw(this,t);var n=ow(this,r.call(this));return n._textWidth=0,n._textHeight=0,n._glyphs=[],n._font={tint:e.tint!==void 0?e.tint:16777215,align:e.align||"left",name:null,size:0},n.font=e.font,n._text=i,n._maxWidth=0,n._maxLineHeight=0,n._letterSpacing=0,n._anchor=new ew.default(function(){n.dirty=!0},n,0,0),n.dirty=!1,n.updateText(),n}return t.prototype.updateText=function(){for(var e=t.fonts[this._font.name],n=this._font.size/e.size,a=new ie.Point,s=[],o=[],l=this.text.replace(/(?:\r\n|\r)/g,`
`),h=l.length,u=this._maxWidth*e.size/this._font.size,f=null,d=0,p=0,_=0,m=-1,g=0,y=0,w=0,T=0;T<h;T++){var x=l.charCodeAt(T),E=l.charAt(T);if(/(?:\s)/.test(E)&&(m=T,g=d),E==="\r"||E===`
`){o.push(d),p=Math.max(p,d),++_,++y,a.x=0,a.y+=e.lineHeight,f=null;continue}var b=e.chars[x];b&&(f&&b.kerning[f]&&(a.x+=b.kerning[f]),s.push({texture:b.texture,line:_,charCode:x,position:new ie.Point(a.x+b.xOffset+this._letterSpacing/2,a.y+b.yOffset)}),a.x+=b.xAdvance+this._letterSpacing,d=a.x,w=Math.max(w,b.yOffset+b.texture.height),f=x,m!==-1&&u>0&&a.x>u&&(++y,ie.utils.removeItems(s,1+m-y,1+T-m),T=m,m=-1,o.push(g),p=Math.max(p,g),_++,a.x=0,a.y+=e.lineHeight,f=null))}var D=l.charAt(l.length-1);D!=="\r"&&D!==`
`&&(/(?:\s)/.test(D)&&(d=g),o.push(d),p=Math.max(p,d));for(var S=[],M=0;M<=_;M++){var O=0;this._font.align==="right"?O=p-o[M]:this._font.align==="center"&&(O=(p-o[M])/2),S.push(O)}for(var F=s.length,L=this.tint,B=0;B<F;B++){var I=this._glyphs[B];I?I.texture=s[B].texture:(I=new ie.Sprite(s[B].texture),this._glyphs.push(I)),I.position.x=(s[B].position.x+S[s[B].line])*n,I.position.y=s[B].position.y*n,I.scale.x=I.scale.y=n,I.tint=L,I.parent||this.addChild(I)}for(var U=F;U<this._glyphs.length;++U)this.removeChild(this._glyphs[U]);if(this._textWidth=p*n,this._textHeight=(a.y+e.lineHeight)*n,this.anchor.x!==0||this.anchor.y!==0)for(var G=0;G<F;G++)this._glyphs[G].x-=this._textWidth*this.anchor.x,this._glyphs[G].y-=this._textHeight*this.anchor.y;this._maxLineHeight=w*n},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),r.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},t.registerFont=function(e,n){var a={},s=e.getElementsByTagName("info")[0],o=e.getElementsByTagName("common")[0],l=e.getElementsByTagName("page"),h=(0,rw.getResolutionOfUrl)(l[0].getAttribute("file"),nw.default.RESOLUTION),u={};a.font=s.getAttribute("face"),a.size=parseInt(s.getAttribute("size"),10),a.lineHeight=parseInt(o.getAttribute("lineHeight"),10)/h,a.chars={},n instanceof ie.Texture&&(n=[n]);for(var f=0;f<l.length;f++){var d=l[f].getAttribute("id"),p=l[f].getAttribute("file");u[d]=n instanceof Array?n[f]:n[p]}for(var _=e.getElementsByTagName("char"),m=0;m<_.length;m++){var g=_[m],y=parseInt(g.getAttribute("id"),10),w=g.getAttribute("page")||0,T=new ie.Rectangle(parseInt(g.getAttribute("x"),10)/h+u[w].frame.x/h,parseInt(g.getAttribute("y"),10)/h+u[w].frame.y/h,parseInt(g.getAttribute("width"),10)/h,parseInt(g.getAttribute("height"),10)/h);a.chars[y]={xOffset:parseInt(g.getAttribute("xoffset"),10)/h,yOffset:parseInt(g.getAttribute("yoffset"),10)/h,xAdvance:parseInt(g.getAttribute("xadvance"),10)/h,kerning:{},texture:new ie.Texture(u[w].baseTexture,T),page:w}}for(var x=e.getElementsByTagName("kerning"),E=0;E<x.length;E++){var b=x[E],D=parseInt(b.getAttribute("first"),10)/h,S=parseInt(b.getAttribute("second"),10)/h,M=parseInt(b.getAttribute("amount"),10)/h;a.chars[S]&&(a.chars[S].kerning[D]=M)}return t.fonts[a.font]=a,a},Jx(t,[{key:"tint",get:function(){return this._font.tint},set:function(e){this._font.tint=typeof e=="number"&&e>=0?e:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(e){this._font.align=e||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copy(e)}},{key:"font",get:function(){return this._font},set:function(e){e&&(typeof e=="string"?(e=e.split(" "),this._font.name=e.length===1?e[0]:e.slice(1).join(" "),this._font.size=e.length>=2?parseInt(e[0],10):t.fonts[this._font.name].size):(this._font.name=e.name,this._font.size=typeof e.size=="number"?e.size:parseInt(e.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(e){e=e.toString()||" ",this._text!==e&&(this._text=e,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),t}(ie.Container);Os.default=$h;$h.fonts={};var hw=at(),ue=cw(hw),uw=Yt,Ps=Xh(uw),fw=de,Rs=Xh(fw),Gh=X;function Xh(r){return r&&r.__esModule?r:{default:r}}function cw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function dw(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Vt=ue.DisplayObject,Vh=new ue.Matrix;Vt.prototype._cacheAsBitmap=!1;Vt.prototype._cacheData=!1;var _w=function r(){dw(this,r),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(Vt.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){this._cacheAsBitmap=t;var i=void 0;t?(this._cacheData||(this._cacheData=new _w),i=this._cacheData,i.originalRenderWebGL=this.renderWebGL,i.originalRenderCanvas=this.renderCanvas,i.originalUpdateTransform=this.updateTransform,i.originalCalculateBounds=this.calculateBounds,i.originalGetLocalBounds=this.getLocalBounds,i.originalDestroy=this.destroy,i.originalContainsPoint=this.containsPoint,i.originalMask=this._mask,i.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(i=this._cacheData,i.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=i.originalRenderWebGL,this.renderCanvas=i.originalRenderCanvas,this.calculateBounds=i.originalCalculateBounds,this.getLocalBounds=i.originalGetLocalBounds,this.destroy=i.originalDestroy,this.updateTransform=i.originalUpdateTransform,this.containsPoint=i.originalContainsPoint,this._mask=i.originalMask,this.filterArea=i.originalFilterArea)}}}});Vt.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))};Vt.prototype._initCachedDisplayObject=function(t){if(!(this._cacheData&&this._cacheData.sprite)){var i=this.alpha;this.alpha=1,t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters&&this._filters.length){var n=this._filters[0].padding;e.pad(n)}e.ceil(ue.settings.RESOLUTION);var a=t._activeRenderTarget,s=t.filterManager.filterStack,o=ue.RenderTexture.create(e.width,e.height),l="cacheAsBitmap_"+(0,Gh.uid)();this._cacheData.textureCacheId=l,Rs.default.addToCache(o.baseTexture,l),Ps.default.addToCache(o,l);var h=Vh;h.tx=-e.x,h.ty=-e.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,o,!0,h,!0),t.bindRenderTarget(a),t.filterManager.filterStack=s,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new ue.Sprite(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=i,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}};Vt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Vt.prototype._initCachedDisplayObjectCanvas=function(t){if(!(this._cacheData&&this._cacheData.sprite)){var i=this.getLocalBounds(),e=this.alpha;this.alpha=1;var n=t.context;i.ceil(ue.settings.RESOLUTION);var a=ue.RenderTexture.create(i.width,i.height),s="cacheAsBitmap_"+(0,Gh.uid)();this._cacheData.textureCacheId=s,Rs.default.addToCache(a.baseTexture,s),Ps.default.addToCache(a,s);var o=Vh;this.transform.localTransform.copy(o),o.invert(),o.tx-=i.x,o.ty-=i.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,a,!0,o,!1),t.context=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new ue.Sprite(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(i.x/i.width),l.anchor.y=-(i.y/i.height),l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}};Vt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID};Vt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()};Vt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Rs.default.removeFromCache(this._cacheData.textureCacheId),Ps.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Vt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};var pw=at(),Wh=mw(pw);function mw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}Wh.DisplayObject.prototype.name=null;Wh.Container.prototype.getChildByName=function(t){for(var i=0;i<this.children.length;i++)if(this.children[i].name===t)return this.children[i];return null};var gw=at(),dl=vw(gw);function vw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}dl.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new dl.Point,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.parent?this.parent.toGlobal(this.position,t,i):(t.x=this.position.x,t.y=this.position.y),t};(function(r){r.__esModule=!0,r.BitmapText=r.TilingSpriteRenderer=r.TilingSprite=r.AnimatedSprite=void 0;var t=Ds;Object.defineProperty(r,"AnimatedSprite",{enumerable:!0,get:function(){return a(t).default}});var i=As;Object.defineProperty(r,"TilingSprite",{enumerable:!0,get:function(){return a(i).default}});var e=Ms;Object.defineProperty(r,"TilingSpriteRenderer",{enumerable:!0,get:function(){return a(e).default}});var n=Os;Object.defineProperty(r,"BitmapText",{enumerable:!0,get:function(){return a(n).default}});function a(s){return s&&s.__esModule?s:{default:s}}})(Ss);var Hh={},Is={};Is.__esModule=!0;var yw=at(),Tw=xw(yw);function xw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function ww(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bw(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Ew(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Sw=function(r){Ew(t,r);function t(){return ww(this,t),bw(this,r.call(this,`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

uniform vec4 filterArea;

varying vec2 vTextureCoord;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

void texcoords(vec2 fragCoord, vec2 resolution,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    vec2 inverseVP = 1.0 / resolution.xy;
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

   vTextureCoord = aTextureCoord;

   vec2 fragCoord = vTextureCoord * filterArea.xy;

   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}`,`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.
 
 --
 
 From:
 https://github.com/mitsuhiko/webgl-meincraft
 
 Copyright (c) 2011 by Armin Ronacher.
 
 Some rights reserved.
 
 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:
 
 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
 
 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.
 
 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.
 
 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));
    
    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));
    
    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);
    
    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;
    
    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);
    
    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec2 fragCoord = vTextureCoord * filterArea.xy;

      vec4 color;

    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`))}return t}(Tw.Filter);Is.default=Sw;var Cs={};Cs.__esModule=!0;var Dw=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Aw=at(),Mw=Ow(Aw);function Ow(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Pw(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Rw(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Iw(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Cw=function(r){Iw(t,r);function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.5,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Math.random();Pw(this,t);var n=Rw(this,r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`));return n.noise=i,n.seed=e,n}return Dw(t,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e}}]),t}(Mw.Filter);Cs.default=Cw;var Fs={};Fs.__esModule=!0;var Fw=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Bw=at(),ta=Lw(Bw);function Lw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Nw(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function kw(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Uw(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var $w=function(r){Uw(t,r);function t(i,e){Nw(this,t);var n=new ta.Matrix;i.renderable=!1;var a=kw(this,r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;
   vTextureCoord = aTextureCoord;
}`,`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;

uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy *= scale / filterArea.xy;

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));
}
`));return a.maskSprite=i,a.maskMatrix=n,a.uniforms.mapSampler=i._texture,a.uniforms.filterMatrix=n,a.uniforms.scale={x:1,y:1},e==null&&(e=20),a.scale=new ta.Point(e,e),a}return t.prototype.apply=function(e,n,a){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,e.applyFilter(this,n,a)},Fw(t,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e}}]),t}(ta.Filter);Fs.default=$w;var Bs={},Ji={},ji={};ji.__esModule=!0;ji.default=Xw;var Gw=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join(`
`);function Xw(r,t){var i=Math.ceil(r/2),e=Gw,n="",a=void 0;t?a="vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<r;s++){var o=a.replace("%index%",s);o=o.replace("%sampleIndex%",s-(i-1)+".0"),n+=o,n+=`
`}return e=e.replace("%blur%",n),e=e.replace("%size%",r),e}var tn={};tn.__esModule=!0;tn.default=Hw;var Vw={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ww=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function Hw(r){for(var t=Vw[r],i=t.length,e=Ww,n="",a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",s=void 0,o=0;o<r;o++){var l=a.replace("%index%",o);s=o,o>=i&&(s=r-o-1),l=l.replace("%value%",t[s]),n+=l,n+=`
`}return e=e.replace("%blur%",n),e=e.replace("%size%",r),e}var en={};en.__esModule=!0;en.default=Yw;function Yw(r){for(var t=r.getParameter(r.MAX_VARYING_VECTORS),i=15;i>t;)i-=2;return i}Ji.__esModule=!0;var zw=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),qw=at(),_l=jw(qw),Kw=ji,pl=Ls(Kw),Zw=tn,ml=Ls(Zw),Qw=en,Jw=Ls(Qw);function Ls(r){return r&&r.__esModule?r:{default:r}}function jw(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function tb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function eb(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function rb(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var ib=function(r){rb(t,r);function t(i,e,n,a){tb(this,t),a=a||5;var s=(0,pl.default)(a,!0),o=(0,ml.default)(a),l=eb(this,r.call(this,s,o));return l.resolution=n||_l.settings.RESOLUTION,l._quality=0,l.quality=e||4,l.strength=i||8,l.firstRun=!0,l}return t.prototype.apply=function(e,n,a,s){if(this.firstRun){var o=e.renderer.gl,l=(0,Jw.default)(o);this.vertexSrc=(0,pl.default)(l,!0),this.fragmentSrc=(0,ml.default)(l),this.firstRun=!1}if(this.uniforms.strength=1/a.size.width*(a.size.width/n.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,a,s);else{for(var h=e.getRenderTarget(!0),u=n,f=h,d=0;d<this.passes-1;d++){e.applyFilter(this,u,f,!0);var p=f;f=u,u=p}e.applyFilter(this,u,a,s),e.returnRenderTarget(h)}},zw(t,[{key:"blur",get:function(){return this.strength},set:function(e){this.padding=Math.abs(e)*2,this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),t}(_l.Filter);Ji.default=ib;var rn={};rn.__esModule=!0;var nb=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),ab=at(),vl=ub(ab),sb=ji,yl=Ns(sb),ob=tn,Tl=Ns(ob),lb=en,hb=Ns(lb);function Ns(r){return r&&r.__esModule?r:{default:r}}function ub(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function fb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function cb(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function db(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var _b=function(r){db(t,r);function t(i,e,n,a){fb(this,t),a=a||5;var s=(0,yl.default)(a,!1),o=(0,Tl.default)(a),l=cb(this,r.call(this,s,o));return l.resolution=n||vl.settings.RESOLUTION,l._quality=0,l.quality=e||4,l.strength=i||8,l.firstRun=!0,l}return t.prototype.apply=function(e,n,a,s){if(this.firstRun){var o=e.renderer.gl,l=(0,hb.default)(o);this.vertexSrc=(0,yl.default)(l,!1),this.fragmentSrc=(0,Tl.default)(l),this.firstRun=!1}if(this.uniforms.strength=1/a.size.height*(a.size.height/n.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)e.applyFilter(this,n,a,s);else{for(var h=e.getRenderTarget(!0),u=n,f=h,d=0;d<this.passes-1;d++){e.applyFilter(this,u,f,!0);var p=f;f=u,u=p}e.applyFilter(this,u,a,s),e.returnRenderTarget(h)}},nb(t,[{key:"blur",get:function(){return this.strength},set:function(e){this.padding=Math.abs(e)*2,this.strength=e}},{key:"quality",get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e}}]),t}(vl.Filter);rn.default=_b;Bs.__esModule=!0;var pb=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),mb=at(),xl=xb(mb),gb=Ji,vb=Yh(gb),yb=rn,Tb=Yh(yb);function Yh(r){return r&&r.__esModule?r:{default:r}}function xb(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function wb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bb(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Eb(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Sb=function(r){Eb(t,r);function t(i,e,n,a){wb(this,t);var s=bb(this,r.call(this));return s.blurXFilter=new vb.default(i,e,n,a),s.blurYFilter=new Tb.default(i,e,n,a),s.padding=0,s.resolution=n||xl.settings.RESOLUTION,s.quality=e||4,s.blur=i||8,s}return t.prototype.apply=function(e,n,a){var s=e.getRenderTarget(!0);this.blurXFilter.apply(e,n,s,!0),this.blurYFilter.apply(e,s,a,!1),e.returnRenderTarget(s)},pb(t,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(e){this.blurYFilter._blendMode=e}}]),t}(xl.Filter);Bs.default=Sb;var ks={};ks.__esModule=!0;var Db=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Ab=at(),Mb=Ob(Ab);function Ob(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Pb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Rb(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Ib(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Ta=function(r){Ib(t,r);function t(){Pb(this,t);var i=Rb(this,r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`));return i.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i.alpha=1,i}return t.prototype._loadMatrix=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=e;n&&(this._multiply(a,this.uniforms.m,e),a=this._colorMatrix(a)),this.uniforms.m=a},t.prototype._multiply=function(e,n,a){return e[0]=n[0]*a[0]+n[1]*a[5]+n[2]*a[10]+n[3]*a[15],e[1]=n[0]*a[1]+n[1]*a[6]+n[2]*a[11]+n[3]*a[16],e[2]=n[0]*a[2]+n[1]*a[7]+n[2]*a[12]+n[3]*a[17],e[3]=n[0]*a[3]+n[1]*a[8]+n[2]*a[13]+n[3]*a[18],e[4]=n[0]*a[4]+n[1]*a[9]+n[2]*a[14]+n[3]*a[19]+n[4],e[5]=n[5]*a[0]+n[6]*a[5]+n[7]*a[10]+n[8]*a[15],e[6]=n[5]*a[1]+n[6]*a[6]+n[7]*a[11]+n[8]*a[16],e[7]=n[5]*a[2]+n[6]*a[7]+n[7]*a[12]+n[8]*a[17],e[8]=n[5]*a[3]+n[6]*a[8]+n[7]*a[13]+n[8]*a[18],e[9]=n[5]*a[4]+n[6]*a[9]+n[7]*a[14]+n[8]*a[19]+n[9],e[10]=n[10]*a[0]+n[11]*a[5]+n[12]*a[10]+n[13]*a[15],e[11]=n[10]*a[1]+n[11]*a[6]+n[12]*a[11]+n[13]*a[16],e[12]=n[10]*a[2]+n[11]*a[7]+n[12]*a[12]+n[13]*a[17],e[13]=n[10]*a[3]+n[11]*a[8]+n[12]*a[13]+n[13]*a[18],e[14]=n[10]*a[4]+n[11]*a[9]+n[12]*a[14]+n[13]*a[19]+n[14],e[15]=n[15]*a[0]+n[16]*a[5]+n[17]*a[10]+n[18]*a[15],e[16]=n[15]*a[1]+n[16]*a[6]+n[17]*a[11]+n[18]*a[16],e[17]=n[15]*a[2]+n[16]*a[7]+n[17]*a[12]+n[18]*a[17],e[18]=n[15]*a[3]+n[16]*a[8]+n[17]*a[13]+n[18]*a[18],e[19]=n[15]*a[4]+n[16]*a[9]+n[17]*a[14]+n[18]*a[19]+n[19],e},t.prototype._colorMatrix=function(e){var n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n},t.prototype.brightness=function(e,n){var a=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(a,n)},t.prototype.greyscale=function(e,n){var a=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(a,n)},t.prototype.blackAndWhite=function(e){var n=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.hue=function(e,n){e=(e||0)/180*Math.PI;var a=Math.cos(e),s=Math.sin(e),o=Math.sqrt,l=1/3,h=o(l),u=a+(1-a)*l,f=l*(1-a)-h*s,d=l*(1-a)+h*s,p=l*(1-a)+h*s,_=a+l*(1-a),m=l*(1-a)-h*s,g=l*(1-a)-h*s,y=l*(1-a)+h*s,w=a+l*(1-a),T=[u,f,d,0,0,p,_,m,0,0,g,y,w,0,0,0,0,0,1,0];this._loadMatrix(T,n)},t.prototype.contrast=function(e,n){var a=(e||0)+1,s=-.5*(a-1),o=[a,0,0,0,s,0,a,0,0,s,0,0,a,0,s,0,0,0,1,0];this._loadMatrix(o,n)},t.prototype.saturate=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments[1],a=e*2/3+1,s=(a-1)*-.5,o=[a,s,s,0,0,s,a,s,0,0,s,s,a,0,0,0,0,0,1,0];this._loadMatrix(o,n)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){var n=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.sepia=function(e){var n=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.technicolor=function(e){var n=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.polaroid=function(e){var n=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.toBGR=function(e){var n=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.kodachrome=function(e){var n=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.browni=function(e){var n=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.vintage=function(e){var n=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.colorTone=function(e,n,a,s,o){e=e||.2,n=n||.15,a=a||16770432,s=s||3375104;var l=(a>>16&255)/255,h=(a>>8&255)/255,u=(a&255)/255,f=(s>>16&255)/255,d=(s>>8&255)/255,p=(s&255)/255,_=[.3,.59,.11,0,0,l,h,u,e,0,f,d,p,n,0,l-f,h-d,u-p,0,0];this._loadMatrix(_,o)},t.prototype.night=function(e,n){e=e||.1;var a=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(a,n)},t.prototype.predator=function(e,n){var a=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(a,n)},t.prototype.lsd=function(e){var n=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(n,e)},t.prototype.reset=function(){var e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)},Db(t,[{key:"matrix",get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(Mb.Filter);ks.default=Ta;Ta.prototype.grayscale=Ta.prototype.greyscale;var Us={};Us.__esModule=!0;var Cb=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Fb=at(),Bb=Lb(Fb);function Lb(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Nb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function kb(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function Ub(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var $b=function(r){Ub(t,r);function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;Nb(this,t);var e=kb(this,r.call(this,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`));return e.alpha=i,e.glShaderKey="alpha",e}return Cb(t,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e}}]),t}(Bb.Filter);Us.default=$b;(function(r){r.__esModule=!0;var t=Is;Object.defineProperty(r,"FXAAFilter",{enumerable:!0,get:function(){return h(t).default}});var i=Cs;Object.defineProperty(r,"NoiseFilter",{enumerable:!0,get:function(){return h(i).default}});var e=Fs;Object.defineProperty(r,"DisplacementFilter",{enumerable:!0,get:function(){return h(e).default}});var n=Bs;Object.defineProperty(r,"BlurFilter",{enumerable:!0,get:function(){return h(n).default}});var a=Ji;Object.defineProperty(r,"BlurXFilter",{enumerable:!0,get:function(){return h(a).default}});var s=rn;Object.defineProperty(r,"BlurYFilter",{enumerable:!0,get:function(){return h(s).default}});var o=ks;Object.defineProperty(r,"ColorMatrixFilter",{enumerable:!0,get:function(){return h(o).default}});var l=Us;Object.defineProperty(r,"AlphaFilter",{enumerable:!0,get:function(){return h(l).default}});function h(u){return u&&u.__esModule?u:{default:u}}})(Hh);var zh={},nn={};nn.__esModule=!0;var Gb=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),Xb=at(),Vb=Wb(Xb);function Wb(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Hb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var Yb=function(){function r(){Hb(this,r),this.global=new Vb.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return r.prototype.getLocalPosition=function(i,e,n){return i.worldTransform.applyInverse(n||this.global,e)},r.prototype.copyEvent=function(i){i.isPrimary&&(this.isPrimary=!0),this.button=i.button,this.buttons=Number.isInteger(i.buttons)?i.buttons:i.which,this.width=i.width,this.height=i.height,this.tiltX=i.tiltX,this.tiltY=i.tiltY,this.pointerType=i.pointerType,this.pressure=i.pressure,this.rotationAngle=i.rotationAngle,this.twist=i.twist||0,this.tangentialPressure=i.tangentialPressure||0},r.prototype.reset=function(){this.isPrimary=!1},Gb(r,[{key:"pointerId",get:function(){return this.identifier}}]),r}();nn.default=Yb;var $s={},an={};an.__esModule=!0;function zb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var qb=function(){function r(){zb(this,r),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return r.prototype.stopPropagation=function(){this.stopped=!0},r.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},r}();an.default=qb;var sn={};sn.__esModule=!0;var Kb=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}();function Zb(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var qh=function(){function r(t){Zb(this,r),this._pointerId=t,this._flags=r.FLAGS.NONE}return r.prototype._doSet=function(i,e){e?this._flags=this._flags|i:this._flags=this._flags&~i},Kb(r,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(i){this._flags=i}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return(this._flags&this.constructor.FLAGS.OVER)!==0},set:function(i){this._doSet(this.constructor.FLAGS.OVER,i)}},{key:"rightDown",get:function(){return(this._flags&this.constructor.FLAGS.RIGHT_DOWN)!==0},set:function(i){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,i)}},{key:"leftDown",get:function(){return(this._flags&this.constructor.FLAGS.LEFT_DOWN)!==0},set:function(i){this._doSet(this.constructor.FLAGS.LEFT_DOWN,i)}}]),r}();sn.default=qh;qh.FLAGS=Object.freeze({NONE:0,OVER:1<<0,LEFT_DOWN:1<<1,RIGHT_DOWN:1<<2});var on={};on.__esModule=!0;on.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(r){r?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};$s.__esModule=!0;var Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Jb=at(),he=oE(Jb),jb=nn,wl=Ur(jb),tE=an,eE=Ur(tE),rE=sn,ea=Ur(rE),iE=Qt,nE=Ur(iE),aE=on,sE=Ur(aE);function Ur(r){return r&&r.__esModule?r:{default:r}}function oE(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function lE(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function hE(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function uE(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}he.utils.mixins.delayMixin(he.DisplayObject.prototype,sE.default);var li=1,hi={target:null,data:{global:null}},Gs=function(r){uE(t,r);function t(i,e){lE(this,t);var n=hE(this,r.call(this));return e=e||{},n.renderer=i,n.autoPreventDefault=e.autoPreventDefault!==void 0?e.autoPreventDefault:!0,n.interactionFrequency=e.interactionFrequency||10,n.mouse=new wl.default,n.mouse.identifier=li,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[li]=n.mouse,n.interactionDataPool=[],n.eventData=new eE.default,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.mouseOverRenderer=!1,n.supportsTouchEvents="ontouchstart"in window,n.supportsPointerEvents=!!window.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n._tempPoint=new he.Point,n.resolution=1,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return t.prototype.hitTest=function(e,n){return hi.target=null,hi.data.global=e,n||(n=this.renderer._lastObjectRendered),this.processInteractive(hi,n,null,!0),hi.target},t.prototype.setTargetElement=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=e,this.resolution=n,this.addEvents()},t.prototype.addEvents=function(){this.interactionDOMElement&&(he.ticker.shared.add(this.update,this,he.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},t.prototype.removeEvents=function(){this.interactionDOMElement&&(he.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},t.prototype.update=function(e){if(this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,!!this.interactionDOMElement)){if(this.didMove){this.didMove=!1;return}this.cursor=null;for(var n in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(n)){var a=this.activeInteractionData[n];if(a.originalEvent&&a.pointerType!=="touch"){var s=this.configureInteractionEventForDOMEvent(this.eventData,a.originalEvent,a);this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){if(e=e||"default",this.currentCursorMode!==e){this.currentCursorMode=e;var n=this.cursorStyles[e];if(n)switch(typeof n>"u"?"undefined":Qb(n)){case"string":this.interactionDOMElement.style.cursor=n;break;case"function":n(e);break;case"object":Object.assign(this.interactionDOMElement.style,n);break}else typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,n,a){a.stopped||(a.currentTarget=e,a.type=n,e.emit(n,a),e[n]&&e[n](a))},t.prototype.mapPositionToPoint=function(e,n,a){var s=void 0;this.interactionDOMElement.parentElement?s=this.interactionDOMElement.getBoundingClientRect():s={x:0,y:0,width:0,height:0};var o=navigator.isCocoonJS?this.resolution:1/this.resolution;e.x=(n-s.left)*(this.interactionDOMElement.width/s.width)*o,e.y=(a-s.top)*(this.interactionDOMElement.height/s.height)*o},t.prototype.processInteractive=function(e,n,a,s,o){if(!n||!n.visible)return!1;var l=e.data.global;o=n.interactive||o;var h=!1,u=o,f=!0;if(n.hitArea?(s&&(n.worldTransform.applyInverse(l,this._tempPoint),n.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?h=!0:(s=!1,f=!1)),u=!1):n._mask&&s&&(n._mask.containsPoint(l)||(s=!1,f=!1)),f&&n.interactiveChildren&&n.children)for(var d=n.children,p=d.length-1;p>=0;p--){var _=d[p],m=this.processInteractive(e,_,a,s,u);if(m){if(!_.parent)continue;u=!1,m&&(e.target&&(s=!1),h=!0)}}return o&&(s&&!e.target&&!n.hitArea&&n.containsPoint&&n.containsPoint(l)&&(h=!0),n.interactive&&(h&&!e.target&&(e.target=n),a&&a(e,n,!!h))),h},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var n=this.normalizeToPointerData(e);this.autoPreventDefault&&n[0].isNormalized&&e.preventDefault();for(var a=n.length,s=0;s<a;s++){var o=n[s],l=this.getInteractionDataForPointerId(o),h=this.configureInteractionEventForDOMEvent(this.eventData,o,l);if(h.data.originalEvent=e,this.processInteractive(h,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",h),o.pointerType==="touch")this.emit("touchstart",h);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var u=o.button===2;this.emit(u?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,n,a){var s=e.data,o=e.data.identifier;if(a){if(n.trackedPointers[o]||(n.trackedPointers[o]=new ea.default(o)),this.dispatchEvent(n,"pointerdown",e),s.pointerType==="touch")this.dispatchEvent(n,"touchstart",e);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;l?n.trackedPointers[o].rightDown=!0:n.trackedPointers[o].leftDown=!0,this.dispatchEvent(n,l?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,n,a){for(var s=this.normalizeToPointerData(e),o=s.length,l=e.target!==this.interactionDOMElement?"outside":"",h=0;h<o;h++){var u=s[h],f=this.getInteractionDataForPointerId(u),d=this.configureInteractionEventForDOMEvent(this.eventData,u,f);if(d.data.originalEvent=e,this.processInteractive(d,this.renderer._lastObjectRendered,a,n||!l),this.emit(n?"pointercancel":"pointerup"+l,d),u.pointerType==="mouse"||u.pointerType==="pen"){var p=u.button===2;this.emit(p?"rightup"+l:"mouseup"+l,d)}else u.pointerType==="touch"&&(this.emit(n?"touchcancel":"touchend"+l,d),this.releaseInteractionDataForPointerId(u.pointerId,f))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,n){var a=e.data,s=e.data.identifier;n.trackedPointers[s]!==void 0&&(delete n.trackedPointers[s],this.dispatchEvent(n,"pointercancel",e),a.pointerType==="touch"&&this.dispatchEvent(n,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,n,a){var s=e.data,o=e.data.identifier,l=n.trackedPointers[o],h=s.pointerType==="touch",u=s.pointerType==="mouse"||s.pointerType==="pen",f=!1;if(u){var d=s.button===2,p=ea.default.FLAGS,_=d?p.RIGHT_DOWN:p.LEFT_DOWN,m=l!==void 0&&l.flags&_;a?(this.dispatchEvent(n,d?"rightup":"mouseup",e),m&&(this.dispatchEvent(n,d?"rightclick":"click",e),f=!0)):m&&this.dispatchEvent(n,d?"rightupoutside":"mouseupoutside",e),l&&(d?l.rightDown=!1:l.leftDown=!1)}a?(this.dispatchEvent(n,"pointerup",e),h&&this.dispatchEvent(n,"touchend",e),l&&((!u||f)&&this.dispatchEvent(n,"pointertap",e),h&&(this.dispatchEvent(n,"tap",e),l.over=!1))):l&&(this.dispatchEvent(n,"pointerupoutside",e),h&&this.dispatchEvent(n,"touchendoutside",e)),l&&l.none&&delete n.trackedPointers[o]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var n=this.normalizeToPointerData(e);(n[0].pointerType==="mouse"||n[0].pointerType==="pen")&&(this.didMove=!0,this.cursor=null);for(var a=n.length,s=0;s<a;s++){var o=n[s],l=this.getInteractionDataForPointerId(o),h=this.configureInteractionEventForDOMEvent(this.eventData,o,l);h.data.originalEvent=e;var u=o.pointerType==="touch"?this.moveWhenInside:!0;this.processInteractive(h,this.renderer._lastObjectRendered,this.processPointerMove,u),this.emit("pointermove",h),o.pointerType==="touch"&&this.emit("touchmove",h),(o.pointerType==="mouse"||o.pointerType==="pen")&&this.emit("mousemove",h)}n[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,n,a){var s=e.data,o=s.pointerType==="touch",l=s.pointerType==="mouse"||s.pointerType==="pen";l&&this.processPointerOverOut(e,n,a),(!this.moveWhenInside||a)&&(this.dispatchEvent(n,"pointermove",e),o&&this.dispatchEvent(n,"touchmove",e),l&&this.dispatchEvent(n,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var n=this.normalizeToPointerData(e),a=n[0];a.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(a),o=this.configureInteractionEventForDOMEvent(this.eventData,a,s);o.data.originalEvent=a,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),a.pointerType==="mouse"||a.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(s.identifier)}},t.prototype.processPointerOverOut=function(e,n,a){var s=e.data,o=e.data.identifier,l=s.pointerType==="mouse"||s.pointerType==="pen",h=n.trackedPointers[o];a&&!h&&(h=n.trackedPointers[o]=new ea.default(o)),h!==void 0&&(a&&this.mouseOverRenderer?(h.over||(h.over=!0,this.dispatchEvent(n,"pointerover",e),l&&this.dispatchEvent(n,"mouseover",e)),l&&this.cursor===null&&(this.cursor=n.cursor)):h.over&&(h.over=!1,this.dispatchEvent(n,"pointerout",this.eventData),l&&this.dispatchEvent(n,"mouseout",e),h.none&&delete n.trackedPointers[o]))},t.prototype.onPointerOver=function(e){var n=this.normalizeToPointerData(e),a=n[0],s=this.getInteractionDataForPointerId(a),o=this.configureInteractionEventForDOMEvent(this.eventData,a,s);o.data.originalEvent=a,a.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),(a.pointerType==="mouse"||a.pointerType==="pen")&&this.emit("mouseover",o)},t.prototype.getInteractionDataForPointerId=function(e){var n=e.pointerId,a=void 0;return n===li||e.pointerType==="mouse"?a=this.mouse:this.activeInteractionData[n]?a=this.activeInteractionData[n]:(a=this.interactionDataPool.pop()||new wl.default,a.identifier=n,this.activeInteractionData[n]=a),a.copyEvent(e),a},t.prototype.releaseInteractionDataForPointerId=function(e){var n=this.activeInteractionData[e];n&&(delete this.activeInteractionData[e],n.reset(),this.interactionDataPool.push(n))},t.prototype.configureInteractionEventForDOMEvent=function(e,n,a){return e.data=a,this.mapPositionToPoint(a.global,n.clientX,n.clientY),navigator.isCocoonJS&&n.pointerType==="touch"&&(a.global.x=a.global.x/this.resolution,a.global.y=a.global.y/this.resolution),n.pointerType==="touch"&&(n.globalX=a.global.x,n.globalY=a.global.y),a.originalEvent=n,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var n=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var a=0,s=e.changedTouches.length;a<s;a++){var o=e.changedTouches[a];typeof o.button>"u"&&(o.button=e.touches.length?1:0),typeof o.buttons>"u"&&(o.buttons=e.touches.length?1:0),typeof o.isPrimary>"u"&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,n.push(o)}else e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof window.PointerEvent))&&(typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=li),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0),n.push(e);return n},t.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},t}(nE.default);$s.default=Gs;he.WebGLRenderer.registerPlugin("interaction",Gs);he.CanvasRenderer.registerPlugin("interaction",Gs);(function(r){r.__esModule=!0;var t=nn;Object.defineProperty(r,"InteractionData",{enumerable:!0,get:function(){return s(t).default}});var i=$s;Object.defineProperty(r,"InteractionManager",{enumerable:!0,get:function(){return s(i).default}});var e=on;Object.defineProperty(r,"interactiveTarget",{enumerable:!0,get:function(){return s(e).default}});var n=sn;Object.defineProperty(r,"InteractionTrackingData",{enumerable:!0,get:function(){return s(n).default}});var a=an;Object.defineProperty(r,"InteractionEvent",{enumerable:!0,get:function(){return s(a).default}});function s(o){return o&&o.__esModule?o:{default:o}}})(zh);var Kh={},$r={},jt={},fE={get exports(){return jt},set exports(r){jt=r}},ln={};class hr{constructor(t,i=!1,e){this._fn=t,this._once=i,this._thisArg=e,this._next=this._prev=this._owner=null}detach(){return this._owner===null?!1:(this._owner.detach(this),!0)}}function bl(r,t){return r._head?(r._tail._next=t,t._prev=r._tail,r._tail=t):(r._head=t,r._tail=t),t._owner=r,t}class El{constructor(){this._head=this._tail=void 0}handlers(t=!1){let i=this._head;if(t)return!!i;const e=[];for(;i;)e.push(i),i=i._next;return e}has(t){if(!(t instanceof hr))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}dispatch(){let t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}add(t,i=null){if(typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return bl(this,new hr(t,!1,i))}once(t,i=null){if(typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return bl(this,new hr(t,!0,i))}detach(t){if(!(t instanceof hr))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}detachAll(){let t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}const cE=Object.freeze(Object.defineProperty({__proto__:null,MiniSignalBinding:hr,MiniSignal:El,default:El},Symbol.toStringTag,{value:"Module"})),Zh=Vl(cE);var Qh=(r,t={})=>{if(!r)return;const i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}},e=i.parser[t.strictMode?"strict":"loose"].exec(r),n={};let a=14;for(;a--;)n[i.key[a]]=e[a]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(s,o,l){o&&(n[i.q.name][o]=l)}),n},Gr={};Gr.__esModule=!0;Gr.eachSeries=dE;Gr.queue=pE;function ge(){}function dE(r,t,i,e){var n=0,a=r.length;(function s(o){if(o||n===a){i&&i(o);return}e?setTimeout(function(){t(r[n++],s)},1):t(r[n++],s)})()}function _E(r){return function(){if(r===null)throw new Error("Callback was already called.");var i=r;r=null,i.apply(this,arguments)}}function pE(r,t){if(t==null)t=1;else if(t===0)throw new Error("Concurrency must not be zero");var i=0,e={_tasks:[],concurrency:t,saturated:ge,unsaturated:ge,buffer:t/4,empty:ge,drain:ge,error:ge,started:!1,paused:!1,push:function(o,l){n(o,!1,l)},kill:function(){i=0,e.drain=ge,e.started=!1,e._tasks=[]},unshift:function(o,l){n(o,!0,l)},process:function(){for(;!e.paused&&i<e.concurrency&&e._tasks.length;){var o=e._tasks.shift();e._tasks.length===0&&e.empty(),i+=1,i===e.concurrency&&e.saturated(),r(o.data,_E(a(o)))}},length:function(){return e._tasks.length},running:function(){return i},idle:function(){return e._tasks.length+i===0},pause:function(){e.paused!==!0&&(e.paused=!0)},resume:function(){if(e.paused!==!1){e.paused=!1;for(var o=1;o<=e.concurrency;o++)e.process()}}};function n(s,o,l){if(l!=null&&typeof l!="function")throw new Error("task callback must be a function");if(e.started=!0,s==null&&e.idle()){setTimeout(function(){return e.drain()},1);return}var h={data:s,callback:typeof l=="function"?l:ge};o?e._tasks.unshift(h):e._tasks.push(h),setTimeout(function(){return e.process()},1)}function a(s){return function(){i-=1,s.callback.apply(s,arguments),arguments[0]!=null&&e.error(arguments[0],s.data),i<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}}return e}var Ue={},mE={get exports(){return Ue},set exports(r){Ue=r}};(function(r,t){t.__esModule=!0,t.Resource=void 0;var i=function(){function x(E,b){for(var D=0;D<b.length;D++){var S=b[D];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}return function(E,b,D){return b&&x(E.prototype,b),D&&x(E,D),E}}(),e=Qh,n=o(e),a=Zh,s=o(a);function o(x){return x&&x.__esModule?x:{default:x}}function l(x,E){if(!(x instanceof E))throw new TypeError("Cannot call a class as a function")}var h=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest)),u=null,f=0,d=200,p=204,_=1223,m=2;function g(){}var y=t.Resource=function(){x.setExtensionLoadType=function(b,D){w(x._loadTypeMap,b,D)},x.setExtensionXhrType=function(b,D){w(x._xhrTypeMap,b,D)};function x(E,b,D){if(l(this,x),typeof E!="string"||typeof b!="string")throw new Error("Both name and url are required for constructing a resource.");D=D||{},this._flags=0,this._setFlag(x.STATUS_FLAGS.DATA_URL,b.indexOf("data:")===0),this.name=E,this.url=b,this.extension=this._getExtension(),this.data=null,this.crossOrigin=D.crossOrigin===!0?"anonymous":D.crossOrigin,this.timeout=D.timeout||0,this.loadType=D.loadType||this._determineLoadType(),this.xhrType=D.xhrType,this.metadata=D.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=x.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=g,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new s.default,this.onProgress=new s.default,this.onComplete=new s.default,this.onAfterMiddleware=new s.default}return x.prototype.complete=function(){this._clearEvents(),this._finish()},x.prototype.abort=function(b){if(!this.error){if(this.error=new Error(b),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=x.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},x.prototype.load=function(b){var D=this;if(!this.isLoading){if(this.isComplete){b&&setTimeout(function(){return b(D)},1);return}else b&&this.onComplete.once(b);switch(this._setFlag(x.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case x.LOAD_TYPE.IMAGE:this.type=x.TYPE.IMAGE,this._loadElement("image");break;case x.LOAD_TYPE.AUDIO:this.type=x.TYPE.AUDIO,this._loadSourceElement("audio");break;case x.LOAD_TYPE.VIDEO:this.type=x.TYPE.VIDEO,this._loadSourceElement("video");break;case x.LOAD_TYPE.XHR:default:h&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},x.prototype._hasFlag=function(b){return(this._flags&b)!==0},x.prototype._setFlag=function(b,D){this._flags=D?this._flags|b:this._flags&~b},x.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},x.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(x.STATUS_FLAGS.COMPLETE,!0),this._setFlag(x.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},x.prototype._loadElement=function(b){this.metadata.loadElement?this.data=this.metadata.loadElement:b==="image"&&typeof window.Image<"u"?this.data=new Image:this.data=document.createElement(b),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},x.prototype._loadSourceElement=function(b){if(this.metadata.loadElement?this.data=this.metadata.loadElement:b==="audio"&&typeof window.Audio<"u"?this.data=new Audio:this.data=document.createElement(b),this.data===null){this.abort("Unsupported element: "+b);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var D=this.metadata.mimeType,S=0;S<this.url.length;++S)this.data.appendChild(this._createSource(b,this.url[S],Array.isArray(D)?D[S]:D));else{var M=this.metadata.mimeType;this.data.appendChild(this._createSource(b,this.url,Array.isArray(M)?M[0]:M))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},x.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var b=this.xhr=new XMLHttpRequest;b.open("GET",this.url,!0),b.timeout=this.timeout,this.xhrType===x.XHR_RESPONSE_TYPE.JSON||this.xhrType===x.XHR_RESPONSE_TYPE.DOCUMENT?b.responseType=x.XHR_RESPONSE_TYPE.TEXT:b.responseType=this.xhrType,b.addEventListener("error",this._boundXhrOnError,!1),b.addEventListener("timeout",this._boundXhrOnTimeout,!1),b.addEventListener("abort",this._boundXhrOnAbort,!1),b.addEventListener("progress",this._boundOnProgress,!1),b.addEventListener("load",this._boundXhrOnLoad,!1),b.send()},x.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var b=this.xhr=new XDomainRequest;b.timeout=this.timeout||5e3,b.onerror=this._boundXhrOnError,b.ontimeout=this._boundXhrOnTimeout,b.onprogress=this._boundOnProgress,b.onload=this._boundXhrOnLoad,b.open("GET",this.url,!0),setTimeout(function(){return b.send()},1)},x.prototype._createSource=function(b,D,S){S||(S=b+"/"+this._getExtension(D));var M=document.createElement("source");return M.src=D,M.type=S,M},x.prototype._onError=function(b){this.abort("Failed to load element using: "+b.target.nodeName)},x.prototype._onProgress=function(b){b&&b.lengthComputable&&this.onProgress.dispatch(this,b.loaded/b.total)},x.prototype._onTimeout=function(){this.abort("Load timed out.")},x.prototype._xhrOnError=function(){var b=this.xhr;this.abort(T(b)+" Request failed. Status: "+b.status+', text: "'+b.statusText+'"')},x.prototype._xhrOnTimeout=function(){var b=this.xhr;this.abort(T(b)+" Request timed out.")},x.prototype._xhrOnAbort=function(){var b=this.xhr;this.abort(T(b)+" Request was aborted by the user.")},x.prototype._xhrOnLoad=function(){var b=this.xhr,D="",S=typeof b.status>"u"?d:b.status;(b.responseType===""||b.responseType==="text"||typeof b.responseType>"u")&&(D=b.responseText),S===f&&(D.length>0||b.responseType===x.XHR_RESPONSE_TYPE.BUFFER)?S=d:S===_&&(S=p);var M=S/100|0;if(M===m)if(this.xhrType===x.XHR_RESPONSE_TYPE.TEXT)this.data=D,this.type=x.TYPE.TEXT;else if(this.xhrType===x.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(D),this.type=x.TYPE.JSON}catch(L){this.abort("Error trying to parse loaded json: "+L);return}else if(this.xhrType===x.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var O=new DOMParser;this.data=O.parseFromString(D,"text/xml")}else{var F=document.createElement("div");F.innerHTML=D,this.data=F}this.type=x.TYPE.XML}catch(L){this.abort("Error trying to parse loaded xml: "+L);return}else this.data=b.response||D;else{this.abort("["+b.status+"] "+b.statusText+": "+b.responseURL);return}this.complete()},x.prototype._determineCrossOrigin=function(b,D){if(b.indexOf("data:")===0)return"";if(window.origin!==window.location.origin)return"anonymous";D=D||window.location,u||(u=document.createElement("a")),u.href=b,b=(0,n.default)(u.href,{strictMode:!0});var S=!b.port&&D.port===""||b.port===D.port,M=b.protocol?b.protocol+":":"";return b.host!==D.hostname||!S||M!==D.protocol?"anonymous":""},x.prototype._determineXhrType=function(){return x._xhrTypeMap[this.extension]||x.XHR_RESPONSE_TYPE.TEXT},x.prototype._determineLoadType=function(){return x._loadTypeMap[this.extension]||x.LOAD_TYPE.XHR},x.prototype._getExtension=function(){var b=this.url,D="";if(this.isDataUrl){var S=b.indexOf("/");D=b.substring(S+1,b.indexOf(";",S))}else{var M=b.indexOf("?"),O=b.indexOf("#"),F=Math.min(M>-1?M:b.length,O>-1?O:b.length);b=b.substring(0,F),D=b.substring(b.lastIndexOf(".")+1)}return D.toLowerCase()},x.prototype._getMimeFromXhrType=function(b){switch(b){case x.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case x.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case x.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case x.XHR_RESPONSE_TYPE.JSON:return"application/json";case x.XHR_RESPONSE_TYPE.DEFAULT:case x.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i(x,[{key:"isDataUrl",get:function(){return this._hasFlag(x.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(x.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(x.STATUS_FLAGS.LOADING)}}]),x}();y.STATUS_FLAGS={NONE:0,DATA_URL:1<<0,COMPLETE:1<<1,LOADING:1<<2},y.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},y.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},y.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},y._loadTypeMap={gif:y.LOAD_TYPE.IMAGE,png:y.LOAD_TYPE.IMAGE,bmp:y.LOAD_TYPE.IMAGE,jpg:y.LOAD_TYPE.IMAGE,jpeg:y.LOAD_TYPE.IMAGE,tif:y.LOAD_TYPE.IMAGE,tiff:y.LOAD_TYPE.IMAGE,webp:y.LOAD_TYPE.IMAGE,tga:y.LOAD_TYPE.IMAGE,svg:y.LOAD_TYPE.IMAGE,"svg+xml":y.LOAD_TYPE.IMAGE,mp3:y.LOAD_TYPE.AUDIO,ogg:y.LOAD_TYPE.AUDIO,wav:y.LOAD_TYPE.AUDIO,mp4:y.LOAD_TYPE.VIDEO,webm:y.LOAD_TYPE.VIDEO},y._xhrTypeMap={xhtml:y.XHR_RESPONSE_TYPE.DOCUMENT,html:y.XHR_RESPONSE_TYPE.DOCUMENT,htm:y.XHR_RESPONSE_TYPE.DOCUMENT,xml:y.XHR_RESPONSE_TYPE.DOCUMENT,tmx:y.XHR_RESPONSE_TYPE.DOCUMENT,svg:y.XHR_RESPONSE_TYPE.DOCUMENT,tsx:y.XHR_RESPONSE_TYPE.DOCUMENT,gif:y.XHR_RESPONSE_TYPE.BLOB,png:y.XHR_RESPONSE_TYPE.BLOB,bmp:y.XHR_RESPONSE_TYPE.BLOB,jpg:y.XHR_RESPONSE_TYPE.BLOB,jpeg:y.XHR_RESPONSE_TYPE.BLOB,tif:y.XHR_RESPONSE_TYPE.BLOB,tiff:y.XHR_RESPONSE_TYPE.BLOB,webp:y.XHR_RESPONSE_TYPE.BLOB,tga:y.XHR_RESPONSE_TYPE.BLOB,json:y.XHR_RESPONSE_TYPE.JSON,text:y.XHR_RESPONSE_TYPE.TEXT,txt:y.XHR_RESPONSE_TYPE.TEXT,ttf:y.XHR_RESPONSE_TYPE.BUFFER,otf:y.XHR_RESPONSE_TYPE.BUFFER},y.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";function w(x,E,b){E&&E.indexOf(".")===0&&(E=E.substring(1)),E&&(x[E]=b)}function T(x){return x.toString().replace("object ","")}r.exports.default=y})(mE,Ue);ln.__esModule=!0;ln.Loader=void 0;var gE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},vE=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),yE=Zh,nr=Jh(yE),TE=Qh,xE=Jh(TE),wE=Gr,ra=EE(wE),bE=Ue;function EE(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function Jh(r){return r&&r.__esModule?r:{default:r}}function SE(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ia=100,DE=/(#[\w-]+)?$/,fe=ln.Loader=function(){function r(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10;SE(this,r),this.baseUrl=i,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(s,o){return t._loadResource(s,o)},this._queue=ra.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new nr.default,this.onError=new nr.default,this.onLoad=new nr.default,this.onStart=new nr.default,this.onComplete=new nr.default;for(var n=0;n<r._defaultBeforeMiddleware.length;++n)this.pre(r._defaultBeforeMiddleware[n]);for(var a=0;a<r._defaultAfterMiddleware.length;++a)this.use(r._defaultAfterMiddleware[a])}return r.prototype.add=function(i,e,n,a){if(Array.isArray(i)){for(var s=0;s<i.length;++s)this.add(i[s]);return this}if((typeof i>"u"?"undefined":gE(i))==="object"&&(a=e||i.callback||i.onComplete,n=i,e=i.url,i=i.name||i.key||i.url),typeof e!="string"&&(a=n,n=e,e=i),typeof e!="string")throw new Error("No url passed to add resource to loader.");if(typeof n=="function"&&(a=n,n=null),this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[i])throw new Error('Resource named "'+i+'" already exists.');if(e=this._prepareUrl(e),this.resources[i]=new bE.Resource(i,e,n),typeof a=="function"&&this.resources[i].onAfterMiddleware.once(a),this.loading){for(var o=n.parentResource,l=[],h=0;h<o.children.length;++h)o.children[h].isComplete||l.push(o.children[h]);var u=o.progressChunk*(l.length+1),f=u/(l.length+2);o.children.push(this.resources[i]),o.progressChunk=f;for(var d=0;d<l.length;++d)l[d].progressChunk=f;this.resources[i].progressChunk=f}return this._queue.push(this.resources[i]),this},r.prototype.pre=function(i){return this._beforeMiddleware.push(i),this},r.prototype.use=function(i){return this._afterMiddleware.push(i),this},r.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var i in this.resources){var e=this.resources[i];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},r.prototype.load=function(i){if(typeof i=="function"&&this.onComplete.once(i),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=this._queue._tasks.length,n=ia/e,a=0;a<this._queue._tasks.length;++a)this._queue._tasks[a].data.progressChunk=n;this._onStart(),this._queue.resume()}return this},r.prototype._prepareUrl=function(i){var e=(0,xE.default)(i,{strictMode:!0}),n=void 0;if(e.protocol||!e.path||i.indexOf("//")===0?n=i:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&i.charAt(0)!=="/"?n=this.baseUrl+"/"+i:n=this.baseUrl+i,this.defaultQueryString){var a=DE.exec(n)[0];n=n.substr(0,n.length-a.length),n.indexOf("?")!==-1?n+="&"+this.defaultQueryString:n+="?"+this.defaultQueryString,n+=a}return n},r.prototype._loadResource=function(i,e){var n=this;i._dequeue=e,ra.eachSeries(this._beforeMiddleware,function(a,s){a.call(n,i,function(){s(i.isComplete?{}:null)})},function(){i.isComplete?n._onLoad(i):(i._onLoadBinding=i.onComplete.once(n._onLoad,n),i.load())},!0)},r.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},r.prototype._onComplete=function(){this.progress=ia,this.loading=!1,this.onComplete.dispatch(this,this.resources)},r.prototype._onLoad=function(i){var e=this;i._onLoadBinding=null,this._resourcesParsing.push(i),i._dequeue(),ra.eachSeries(this._afterMiddleware,function(n,a){n.call(e,i,a)},function(){i.onAfterMiddleware.dispatch(i),e.progress=Math.min(ia,e.progress+i.progressChunk),e.onProgress.dispatch(e,i),i.error?e.onError.dispatch(i.error,e,i):e.onLoad.dispatch(e,i),e._resourcesParsing.splice(e._resourcesParsing.indexOf(i),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},vE(r,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(i){this._queue.concurrency=i}}]),r}();fe._defaultBeforeMiddleware=[];fe._defaultAfterMiddleware=[];fe.pre=function(t){return fe._defaultBeforeMiddleware.push(t),fe};fe.use=function(t){return fe._defaultAfterMiddleware.push(t),fe};var wr={},AE={get exports(){return wr},set exports(r){wr=r}};(function(r,t){t.__esModule=!0,t.encodeBinary=e;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function e(n){for(var a="",s=0;s<n.length;){for(var o=[0,0,0],l=[0,0,0,0],h=0;h<o.length;++h)s<n.length?o[h]=n.charCodeAt(s++)&255:o[h]=0;l[0]=o[0]>>2,l[1]=(o[0]&3)<<4|o[1]>>4,l[2]=(o[1]&15)<<2|o[2]>>6,l[3]=o[2]&63;var u=s-(n.length-1);switch(u){case 2:l[3]=64,l[2]=64;break;case 1:l[3]=64;break}for(var f=0;f<l.length;++f)a+=i.charAt(l[f])}return a}r.exports.default=e})(AE,wr);var Ie=ln.Loader,ME=Ue.Resource,OE=Gr,jh=wr;Ie.Resource=ME;Ie.async=OE;Ie.encodeBinary=jh;Ie.base64=jh;fE.exports=Ie;jt.Loader=Ie;jt.default=Ie;$r.__esModule=!0;$r.parse=tu;$r.default=function(){return function(t,i){if(!t.data||t.type!==Sl.Resource.TYPE.XML){i();return}if(t.data.getElementsByTagName("page").length===0||t.data.getElementsByTagName("info").length===0||t.data.getElementsByTagName("info")[0].getAttribute("face")===null){i();return}var e=t.isDataUrl?"":RE.dirname(t.url);t.isDataUrl&&(e==="."&&(e=""),this.baseUrl&&e&&this.baseUrl.charAt(this.baseUrl.length-1)==="/"&&(e+="/")),e=e.replace(this.baseUrl,""),e&&e.charAt(e.length-1)!=="/"&&(e+="/");for(var n=t.data.getElementsByTagName("page"),a={},s=function(m){a[m.metadata.pageFile]=m.texture,Object.keys(a).length===n.length&&(tu(t,a),i())},o=0;o<n.length;++o){var l=n[o].getAttribute("file"),h=e+l,u=!1;for(var f in this.resources){var d=this.resources[f];if(d.url===h){d.metadata.pageFile=l,d.texture?s(d):d.onAfterMiddleware.add(s),u=!0;break}}if(!u){var p={crossOrigin:t.crossOrigin,loadType:Sl.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:l},t.metadata.imageMetadata),parentResource:t};this.add(h,p,s)}}}};var PE=Ua,RE=CE(PE),Sl=jt,IE=Ss;function CE(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function tu(r,t){r.bitmapFont=IE.BitmapText.registerFont(r.data,t)}var Xr={};Xr.__esModule=!0;Xr.default=function(){return function(t,i){var e=t.name+"_image";if(!t.data||t.type!==FE.Resource.TYPE.JSON||!t.data.frames||this.resources[e]){i();return}var n={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},a=eu(t,this.baseUrl);this.add(e,a,n,function(o){if(o.error){i(o.error);return}var l=new NE.Spritesheet(o.texture.baseTexture,t.data,t.url);l.parse(function(){t.spritesheet=l,t.textures=l.textures,i()})})}};Xr.getResourcePath=eu;var FE=jt,BE=Ua,LE=kE(BE),NE=at();function kE(r){return r&&r.__esModule?r:{default:r}}function eu(r,t){return r.isDataUrl?r.data.meta.image:LE.default.resolve(r.url.replace(t,""),r.data.meta.image)}var hn={};hn.__esModule=!0;hn.default=function(){return function(t,i){t.data&&t.type===UE.Resource.TYPE.IMAGE&&(t.texture=GE.default.fromLoader(t.data,t.url,t.name)),i()}};var UE=jt,$E=Yt,GE=XE($E);function XE(r){return r&&r.__esModule?r:{default:r}}var Xs={},Vs={};Vs.__esModule=!0;Vs.blobMiddlewareFactory=WE;var na=Ue,VE=wr,Dl=window.URL||window.webkitURL;function WE(){return function(t,i){if(!t.data){i();return}if(t.xhr&&t.xhrType===na.Resource.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof t.data=="string"){var e=t.xhr.getResponseHeader("content-type");if(e&&e.indexOf("image")===0){t.data=new Image,t.data.src="data:"+e+";base64,"+(0,VE.encodeBinary)(t.xhr.responseText),t.type=na.Resource.TYPE.IMAGE,t.data.onload=function(){t.data.onload=null,i()};return}}else if(t.data.type.indexOf("image")===0){var n=Dl.createObjectURL(t.data);t.blob=t.data,t.data=new Image,t.data.src=n,t.type=na.Resource.TYPE.IMAGE,t.data.onload=function(){Dl.revokeObjectURL(n),t.data.onload=null,i()};return}}i()}}Xs.__esModule=!0;var HE=jt,ru=Vr(HE),YE=Vs,zE=Qt,xa=Vr(zE),qE=hn,KE=Vr(qE),ZE=Xr,QE=Vr(ZE),JE=$r,jE=Vr(JE);function Vr(r){return r&&r.__esModule?r:{default:r}}function tS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function eS(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function rS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Ws=function(r){rS(t,r);function t(i,e){tS(this,t);var n=eS(this,r.call(this,i,e));xa.default.call(n);for(var a=0;a<t._pixiMiddleware.length;++a)n.use(t._pixiMiddleware[a]());return n.onStart.add(function(s){return n.emit("start",s)}),n.onProgress.add(function(s,o){return n.emit("progress",s,o)}),n.onError.add(function(s,o,l){return n.emit("error",s,o,l)}),n.onLoad.add(function(s,o){return n.emit("load",s,o)}),n.onComplete.add(function(s,o){return n.emit("complete",s,o)}),n}return t.addPixiMiddleware=function(e){t._pixiMiddleware.push(e)},t.prototype.destroy=function(){this.removeAllListeners(),this.reset()},t}(ru.default);Xs.default=Ws;for(var Al in xa.default.prototype)Ws.prototype[Al]=xa.default.prototype[Al];Ws._pixiMiddleware=[YE.blobMiddlewareFactory,KE.default,QE.default,jE.default];var Ml=ru.default.Resource;Ml.setExtensionXhrType("fnt",Ml.XHR_RESPONSE_TYPE.DOCUMENT);(function(r){r.__esModule=!0,r.shared=r.Resource=r.textureParser=r.getResourcePath=r.spritesheetParser=r.parseBitmapFontData=r.bitmapFontParser=r.Loader=void 0;var t=$r;Object.defineProperty(r,"bitmapFontParser",{enumerable:!0,get:function(){return h(t).default}}),Object.defineProperty(r,"parseBitmapFontData",{enumerable:!0,get:function(){return t.parse}});var i=Xr;Object.defineProperty(r,"spritesheetParser",{enumerable:!0,get:function(){return h(i).default}}),Object.defineProperty(r,"getResourcePath",{enumerable:!0,get:function(){return i.getResourcePath}});var e=hn;Object.defineProperty(r,"textureParser",{enumerable:!0,get:function(){return h(e).default}});var n=jt;Object.defineProperty(r,"Resource",{enumerable:!0,get:function(){return n.Resource}});var a=Ki,s=h(a),o=Xs,l=h(o);function h(d){return d&&d.__esModule?d:{default:d}}r.Loader=l.default;var u=new l.default;u.destroy=function(){},r.shared=u;var f=s.default.prototype;f._loader=null,Object.defineProperty(f,"loader",{get:function(){if(!this._loader){var p=this._options.sharedLoader;this._loader=p?u:new l.default}return this._loader}}),f._parentDestroy=f.destroy,f.destroy=function(p,_){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(p,_)}})(Kh);var iu={},Ce={};Ce.__esModule=!0;var iS=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),nS=at(),ae=lS(nS),aS=Yt,sS=oS(aS);function oS(r){return r&&r.__esModule?r:{default:r}}function lS(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function hS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function uS(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function fS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var aa=new ae.Point,Ol=new ae.Polygon,nu=function(r){fS(t,r);function t(i,e,n,a,s){hS(this,t);var o=uS(this,r.call(this));return o._texture=i||sS.default.EMPTY,o.uvs=n||new Float32Array([0,0,1,0,1,1,0,1]),o.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]),o.indices=a||new Uint16Array([0,1,3,2]),o.dirty=0,o.indexDirty=0,o.vertexDirty=0,o.autoUpdate=!0,o.blendMode=ae.BLEND_MODES.NORMAL,o.canvasPadding=ae.settings.MESH_CANVAS_PADDING,o.drawMode=s||t.DRAW_MODES.TRIANGLE_MESH,o.shader=null,o.tintRgb=new Float32Array([1,1,1]),o._glDatas={},o._uvTransform=new ae.TextureMatrix(o._texture),o.uploadUvTransform=!1,o.pluginName="mesh",o}return t.prototype._renderWebGL=function(e){this.refresh(),e.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._renderCanvas=function(e){this.refresh(),e.plugins[this.pluginName].render(this)},t.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},t.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},t.prototype.refresh=function(e){this.autoUpdate&&this.vertexDirty++,this._uvTransform.update(e)&&this._refresh()},t.prototype._refresh=function(){},t.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,aa);for(var n=this.vertices,a=Ol.points,s=this.indices,o=this.indices.length,l=this.drawMode===t.DRAW_MODES.TRIANGLES?3:1,h=0;h+2<o;h+=l){var u=s[h]*2,f=s[h+1]*2,d=s[h+2]*2;if(a[0]=n[u],a[1]=n[u+1],a[2]=n[f],a[3]=n[f+1],a[4]=n[d],a[5]=n[d+1],Ol.contains(aa.x,aa.y))return!0}return!1},t.prototype.destroy=function(e){for(var n in this._glDatas){var a=this._glDatas[n];a.destroy?a.destroy():(a.vertexBuffer&&(a.vertexBuffer.destroy(),a.vertexBuffer=null),a.indexBuffer&&(a.indexBuffer.destroy(),a.indexBuffer=null),a.uvBuffer&&(a.uvBuffer.destroy(),a.uvBuffer=null),a.vao&&(a.vao.destroy(),a.vao=null))}this._glDatas=null,r.prototype.destroy.call(this,e)},iS(t,[{key:"texture",get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture=e,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return ae.utils.rgb2hex(this.tintRgb)},set:function(e){this.tintRgb=ae.utils.hex2rgb(e,this.tintRgb)}}]),t}(ae.Container);Ce.default=nu;nu.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1};var Hs={};Hs.__esModule=!0;var cS=at(),Le=mS(cS),dS=At,ui=au(dS),_S=Ce,pS=au(_S);function au(r){return r&&r.__esModule?r:{default:r}}function mS(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function gS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function vS(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function yS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var TS=Le.Matrix.IDENTITY,su=function(r){yS(t,r);function t(i){gS(this,t);var e=vS(this,r.call(this,i));return e.shader=null,e}return t.prototype.onContextChange=function(){var e=this.renderer.gl;this.shader=new Le.Shader(e,`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`)},t.prototype.render=function(e){var n=this.renderer,a=n.gl,s=e._texture;if(s.valid){var o=e._glDatas[n.CONTEXT_UID];o||(n.bindVao(null),o={shader:this.shader,vertexBuffer:ui.default.GLBuffer.createVertexBuffer(a,e.vertices,a.STREAM_DRAW),uvBuffer:ui.default.GLBuffer.createVertexBuffer(a,e.uvs,a.STREAM_DRAW),indexBuffer:ui.default.GLBuffer.createIndexBuffer(a,e.indices,a.STATIC_DRAW),vao:null,dirty:e.dirty,indexDirty:e.indexDirty,vertexDirty:e.vertexDirty},o.vao=new ui.default.VertexArrayObject(a).addIndex(o.indexBuffer).addAttribute(o.vertexBuffer,o.shader.attributes.aVertexPosition,a.FLOAT,!1,2*4,0).addAttribute(o.uvBuffer,o.shader.attributes.aTextureCoord,a.FLOAT,!1,2*4,0),e._glDatas[n.CONTEXT_UID]=o),n.bindVao(o.vao),e.dirty!==o.dirty&&(o.dirty=e.dirty,o.uvBuffer.upload(e.uvs)),e.indexDirty!==o.indexDirty&&(o.indexDirty=e.indexDirty,o.indexBuffer.upload(e.indices)),e.vertexDirty!==o.vertexDirty&&(o.vertexDirty=e.vertexDirty,o.vertexBuffer.upload(e.vertices)),n.bindShader(o.shader),o.shader.uniforms.uSampler=n.bindTexture(s),n.state.setBlendMode(Le.utils.correctBlendMode(e.blendMode,s.baseTexture.premultipliedAlpha)),o.shader.uniforms.uTransform&&(e.uploadUvTransform?o.shader.uniforms.uTransform=e._uvTransform.mapCoord.toArray(!0):o.shader.uniforms.uTransform=TS.toArray(!0)),o.shader.uniforms.translationMatrix=e.worldTransform.toArray(!0),o.shader.uniforms.uColor=Le.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,o.shader.uniforms.uColor,s.baseTexture.premultipliedAlpha);var l=e.drawMode===pS.default.DRAW_MODES.TRIANGLE_MESH?a.TRIANGLE_STRIP:a.TRIANGLES;o.vao.draw(l,e.indices.length,0)}},t}(Le.ObjectRenderer);Hs.default=su;Le.WebGLRenderer.registerPlugin("mesh",su);var Ys={};Ys.__esModule=!0;var xS=at(),wS=DS(xS),bS=Ce,ES=SS(bS);function SS(r){return r&&r.__esModule?r:{default:r}}function DS(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function AS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var ou=function(){function r(t){AS(this,r),this.renderer=t}return r.prototype.render=function(i){var e=this.renderer,n=e.context,a=i.worldTransform,s=e.resolution;e.roundPixels?n.setTransform(a.a*s,a.b*s,a.c*s,a.d*s,a.tx*s|0,a.ty*s|0):n.setTransform(a.a*s,a.b*s,a.c*s,a.d*s,a.tx*s,a.ty*s),e.context.globalAlpha=i.worldAlpha,e.setBlendMode(i.blendMode),i.drawMode===ES.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(i):this._renderTriangles(i)},r.prototype._renderTriangleMesh=function(i){for(var e=i.vertices.length/2,n=0;n<e-2;n++){var a=n*2;this._renderDrawTriangle(i,a,a+2,a+4)}},r.prototype._renderTriangles=function(i){for(var e=i.indices,n=e.length,a=0;a<n;a+=3){var s=e[a]*2,o=e[a+1]*2,l=e[a+2]*2;this._renderDrawTriangle(i,s,o,l)}},r.prototype._renderDrawTriangle=function(i,e,n,a){var s=this.renderer.context,o=i.uvs,l=i.vertices,h=i._texture;if(h.valid){var u=h.baseTexture,f=u.source,d=u.width,p=u.height,_=void 0,m=void 0,g=void 0,y=void 0,w=void 0,T=void 0;if(i.uploadUvTransform){var x=i._uvTransform.mapCoord;_=(o[e]*x.a+o[e+1]*x.c+x.tx)*u.width,m=(o[n]*x.a+o[n+1]*x.c+x.tx)*u.width,g=(o[a]*x.a+o[a+1]*x.c+x.tx)*u.width,y=(o[e]*x.b+o[e+1]*x.d+x.ty)*u.height,w=(o[n]*x.b+o[n+1]*x.d+x.ty)*u.height,T=(o[a]*x.b+o[a+1]*x.d+x.ty)*u.height}else _=o[e]*u.width,m=o[n]*u.width,g=o[a]*u.width,y=o[e+1]*u.height,w=o[n+1]*u.height,T=o[a+1]*u.height;var E=l[e],b=l[n],D=l[a],S=l[e+1],M=l[n+1],O=l[a+1],F=i.canvasPadding/this.renderer.resolution;if(F>0){var L=F/Math.abs(i.worldTransform.a),B=F/Math.abs(i.worldTransform.d),I=(E+b+D)/3,U=(S+M+O)/3,G=E-I,$=S-U,k=Math.sqrt(G*G+$*$);E=I+G/k*(k+L),S=U+$/k*(k+B),G=b-I,$=M-U,k=Math.sqrt(G*G+$*$),b=I+G/k*(k+L),M=U+$/k*(k+B),G=D-I,$=O-U,k=Math.sqrt(G*G+$*$),D=I+G/k*(k+L),O=U+$/k*(k+B)}s.save(),s.beginPath(),s.moveTo(E,S),s.lineTo(b,M),s.lineTo(D,O),s.closePath(),s.clip();var q=_*w+y*g+m*T-w*g-y*m-_*T,z=E*w+y*D+b*T-w*D-y*b-E*T,H=_*b+E*g+m*D-b*g-E*m-_*D,et=_*w*D+y*b*g+E*m*T-E*w*g-y*m*D-_*b*T,it=S*w+y*O+M*T-w*O-y*M-S*T,j=_*M+S*g+m*O-M*g-S*m-_*O,wt=_*w*O+y*M*g+S*m*T-S*w*g-y*m*O-_*M*T;s.transform(z/q,it/q,H/q,j/q,et/q,wt/q),s.drawImage(f,0,0,d*u.resolution,p*u.resolution,0,0,d,p),s.restore(),this.renderer.invalidateBlendMode()}},r.prototype.renderMeshFlat=function(i){var e=this.renderer.context,n=i.vertices,a=n.length/2;e.beginPath();for(var s=1;s<a-2;++s){var o=s*2,l=n[o],h=n[o+1],u=n[o+2],f=n[o+3],d=n[o+4],p=n[o+5];e.moveTo(l,h),e.lineTo(u,f),e.lineTo(d,p)}e.fillStyle="#FF0000",e.fill(),e.closePath()},r.prototype.destroy=function(){this.renderer=null},r}();Ys.default=ou;wS.CanvasRenderer.registerPlugin("mesh",ou);var un={};un.__esModule=!0;var MS=Ce,sa=OS(MS);function OS(r){return r&&r.__esModule?r:{default:r}}function PS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function RS(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function IS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var CS=function(r){IS(t,r);function t(i,e,n){PS(this,t);var a=RS(this,r.call(this,i));return a._ready=!0,a.verticesX=e||10,a.verticesY=n||10,a.drawMode=sa.default.DRAW_MODES.TRIANGLES,a.refresh(),a}return t.prototype._refresh=function(){for(var e=this._texture,n=this.verticesX*this.verticesY,a=[],s=[],o=[],l=[],h=this.verticesX-1,u=this.verticesY-1,f=e.width/h,d=e.height/u,p=0;p<n;p++){var _=p%this.verticesX,m=p/this.verticesX|0;a.push(_*f,m*d),o.push(_/h,m/u)}for(var g=h*u,y=0;y<g;y++){var w=y%h,T=y/h|0,x=T*this.verticesX+w,E=T*this.verticesX+w+1,b=(T+1)*this.verticesX+w,D=(T+1)*this.verticesX+w+1;l.push(x,E,b),l.push(E,D,b)}this.vertices=new Float32Array(a),this.uvs=new Float32Array(o),this.colors=new Float32Array(s),this.indices=new Uint16Array(l),this.dirty++,this.indexDirty++,this.multiplyUvs()},t.prototype._onTextureUpdate=function(){sa.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},t}(sa.default);un.default=CS;var zs={};zs.__esModule=!0;var FS=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),BS=un,LS=lu(BS),NS=Ge,kS=lu(NS);function lu(r){return r&&r.__esModule?r:{default:r}}function US(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function $S(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function GS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var fi=10,XS=function(r){GS(t,r);function t(i,e,n,a,s){US(this,t);var o=$S(this,r.call(this,i,4,4));return o._origWidth=i.orig.width,o._origHeight=i.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=typeof e<"u"?e:fi,o._rightWidth=typeof a<"u"?a:fi,o._topHeight=typeof n<"u"?n:fi,o._bottomHeight=typeof s<"u"?s:fi,o._cachedTint=16777215,o._tintedTexture=null,o._canvasUvs=null,o.refresh(!0),o}return t.prototype.updateHorizontalVertices=function(){var e=this.vertices,n=this._topHeight+this._bottomHeight,a=this._height>n?1:this._height/n;e[9]=e[11]=e[13]=e[15]=this._topHeight*a,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*a,e[25]=e[27]=e[29]=e[31]=this._height},t.prototype.updateVerticalVertices=function(){var e=this.vertices,n=this._leftWidth+this._rightWidth,a=this._width>n?1:this._width/n;e[2]=e[10]=e[18]=e[26]=this._leftWidth*a,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*a,e[6]=e[14]=e[22]=e[30]=this._width},t.prototype._renderCanvas=function(e){var n=e.context,a=this.worldTransform,s=e.resolution,o=this.tint!==16777215,l=this._texture;o&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedTexture=kS.default.getTintedTexture(this,this.tint));var h=o?this._tintedTexture:l.baseTexture.source;this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var u=this.vertices,f=this._canvasUvs,d=o?0:l.frame.x,p=o?0:l.frame.y,_=d+l.frame.width,m=p+l.frame.height;f[0]=d,f[1]=d+this._leftWidth,f[2]=_-this._rightWidth,f[3]=_,f[4]=p,f[5]=p+this._topHeight,f[6]=m-this._bottomHeight,f[7]=m;for(var g=0;g<8;g++)f[g]*=l.baseTexture.resolution;n.globalAlpha=this.worldAlpha,e.setBlendMode(this.blendMode),e.roundPixels?n.setTransform(a.a*s,a.b*s,a.c*s,a.d*s,a.tx*s|0,a.ty*s|0):n.setTransform(a.a*s,a.b*s,a.c*s,a.d*s,a.tx*s,a.ty*s);for(var y=0;y<3;y++)for(var w=0;w<3;w++){var T=w*2+y*8,x=Math.max(1,f[w+1]-f[w]),E=Math.max(1,f[y+5]-f[y+4]),b=Math.max(1,u[T+10]-u[T]),D=Math.max(1,u[T+11]-u[T+1]);n.drawImage(h,f[w],f[y+4],x,E,u[T],u[T+1],b,D)}},t.prototype._refresh=function(){r.prototype._refresh.call(this);var e=this.uvs,n=this._texture;this._origWidth=n.orig.width,this._origHeight=n.orig.height;var a=1/this._origWidth,s=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=a*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-a*this._rightWidth,e[9]=e[11]=e[13]=e[15]=s*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-s*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},FS(t,[{key:"width",get:function(){return this._width},set:function(e){this._width=e,this._refresh()}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()}}]),t}(LS.default);zs.default=XS;var qs={};qs.__esModule=!0;var VS=Ce,WS=HS(VS);function HS(r){return r&&r.__esModule?r:{default:r}}function YS(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function zS(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function qS(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var KS=function(r){qS(t,r);function t(i,e){YS(this,t);var n=zS(this,r.call(this,i));return n.points=e,n.vertices=new Float32Array(e.length*4),n.uvs=new Float32Array(e.length*4),n.colors=new Float32Array(e.length*2),n.indices=new Uint16Array(e.length*2),n.autoUpdate=!0,n.refresh(),n}return t.prototype._refresh=function(){var e=this.points;if(!(e.length<1||!this._texture._uvs)){this.vertices.length/4!==e.length&&(this.vertices=new Float32Array(e.length*4),this.uvs=new Float32Array(e.length*4),this.colors=new Float32Array(e.length*2),this.indices=new Uint16Array(e.length*2));var n=this.uvs,a=this.indices,s=this.colors;n[0]=0,n[1]=0,n[2]=0,n[3]=1,s[0]=1,s[1]=1,a[0]=0,a[1]=1;for(var o=e.length,l=1;l<o;l++){var h=l*4,u=l/(o-1);n[h]=u,n[h+1]=0,n[h+2]=u,n[h+3]=1,h=l*2,s[h]=1,s[h+1]=1,h=l*2,a[h]=h,a[h+1]=h+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},t.prototype.refreshVertices=function(){var e=this.points;if(!(e.length<1))for(var n=e[0],a=void 0,s=0,o=0,l=this.vertices,h=e.length,u=0;u<h;u++){var f=e[u],d=u*4;u<e.length-1?a=e[u+1]:a=f,o=-(a.x-n.x),s=a.y-n.y;var p=Math.sqrt(s*s+o*o),_=this._texture.height/2;s/=p,o/=p,s*=_,o*=_,l[d]=f.x+s,l[d+1]=f.y+o,l[d+2]=f.x-s,l[d+3]=f.y-o,n=f}},t.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},t}(WS.default);qs.default=KS;(function(r){r.__esModule=!0;var t=Ce;Object.defineProperty(r,"Mesh",{enumerable:!0,get:function(){return o(t).default}});var i=Hs;Object.defineProperty(r,"MeshRenderer",{enumerable:!0,get:function(){return o(i).default}});var e=Ys;Object.defineProperty(r,"CanvasMeshRenderer",{enumerable:!0,get:function(){return o(e).default}});var n=un;Object.defineProperty(r,"Plane",{enumerable:!0,get:function(){return o(n).default}});var a=zs;Object.defineProperty(r,"NineSlicePlane",{enumerable:!0,get:function(){return o(a).default}});var s=qs;Object.defineProperty(r,"Rope",{enumerable:!0,get:function(){return o(s).default}});function o(l){return l&&l.__esModule?l:{default:l}}})(iu);var hu={},Ks={};Ks.__esModule=!0;var ZS=function(){function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}}(),QS=at(),Pl=jS(QS),JS=X;function jS(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function tD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function eD(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function rD(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var iD=function(r){rD(t,r);function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1500,e=arguments[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:16384,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;tD(this,t);var s=eD(this,r.call(this)),o=16384;return n>o&&(n=o),n>i&&(n=i),s._properties=[!1,!0,!1,!1,!1],s._maxSize=i,s._batchSize=n,s._glBuffers={},s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=Pl.BLEND_MODES.NORMAL,s.autoResize=a,s.roundPixels=!0,s.baseTexture=null,s.setProperties(e),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},t.prototype.renderWebGL=function(e){var n=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return n.onChildrenChange(0)})),e.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var n=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<n;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[n]=++this._updateID},t.prototype.renderCanvas=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable)){var n=e.context,a=this.worldTransform,s=!0,o=0,l=0,h=0,u=0;e.setBlendMode(this.blendMode),n.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var f=0;f<this.children.length;++f){var d=this.children[f];if(d.visible){var p=d._texture.frame;if(n.globalAlpha=this.worldAlpha*d.alpha,d.rotation%(Math.PI*2)===0)s&&(n.setTransform(a.a,a.b,a.c,a.d,a.tx*e.resolution,a.ty*e.resolution),s=!1),o=d.anchor.x*(-p.width*d.scale.x)+d.position.x+.5,l=d.anchor.y*(-p.height*d.scale.y)+d.position.y+.5,h=p.width*d.scale.x,u=p.height*d.scale.y;else{s||(s=!0),d.displayObjectUpdateTransform();var _=d.worldTransform;e.roundPixels?n.setTransform(_.a,_.b,_.c,_.d,_.tx*e.resolution|0,_.ty*e.resolution|0):n.setTransform(_.a,_.b,_.c,_.d,_.tx*e.resolution,_.ty*e.resolution),o=d.anchor.x*-p.width+.5,l=d.anchor.y*-p.height+.5,h=p.width,u=p.height}var m=d._texture.baseTexture.resolution;n.drawImage(d._texture.baseTexture.source,p.x*m,p.y*m,p.width*m,p.height*m,o*e.resolution,l*e.resolution,h*e.resolution,u*e.resolution)}}}},t.prototype.destroy=function(e){if(r.prototype.destroy.call(this,e),this._buffers)for(var n=0;n<this._buffers.length;++n)this._buffers[n].destroy();this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},ZS(t,[{key:"tint",get:function(){return this._tint},set:function(e){this._tint=e,(0,JS.hex2rgb)(e,this.tintRgb)}}]),t}(Pl.Container);Ks.default=iD;var Zs={},Qs={};Qs.__esModule=!0;var nD=Re,aD=sD(nD);function sD(r){return r&&r.__esModule?r:{default:r}}function oD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function lD(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function hD(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var uD=function(r){hD(t,r);function t(i){return oD(this,t),lD(this,r.call(this,i,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join(`
`),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join(`
`)))}return t}(aD.default);Qs.default=uD;var Js={};Js.__esModule=!0;var fD=At,ci=uu(fD),cD=Lr,dD=uu(cD);function uu(r){return r&&r.__esModule?r:{default:r}}function _D(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var pD=function(){function r(t,i,e,n){_D(this,r),this.gl=t,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var a=0;a<i.length;++a){var s=i[a];s={attribute:s.attribute,size:s.size,uploadFunction:s.uploadFunction,unsignedByte:s.unsignedByte,offset:s.offset},e[a]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return r.prototype.initBuffers=function(){var i=this.gl,e=0;this.indices=(0,dD.default)(this.size),this.indexBuffer=ci.default.GLBuffer.createIndexBuffer(i,this.indices,i.STATIC_DRAW),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){var a=this.dynamicProperties[n];a.offset=e,e+=a.size,this.dynamicStride+=a.size}var s=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(s),this.dynamicDataUint32=new Uint32Array(s),this.dynamicBuffer=ci.default.GLBuffer.createVertexBuffer(i,s,i.STREAM_DRAW);var o=0;this.staticStride=0;for(var l=0;l<this.staticProperties.length;++l){var h=this.staticProperties[l];h.offset=o,o+=h.size,this.staticStride+=h.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=ci.default.GLBuffer.createVertexBuffer(i,u,i.STATIC_DRAW),this.vao=new ci.default.VertexArrayObject(i).addIndex(this.indexBuffer);for(var f=0;f<this.dynamicProperties.length;++f){var d=this.dynamicProperties[f];d.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,d.attribute,i.UNSIGNED_BYTE,!0,this.dynamicStride*4,d.offset*4):this.vao.addAttribute(this.dynamicBuffer,d.attribute,i.FLOAT,!1,this.dynamicStride*4,d.offset*4)}for(var p=0;p<this.staticProperties.length;++p){var _=this.staticProperties[p];_.unsignedByte?this.vao.addAttribute(this.staticBuffer,_.attribute,i.UNSIGNED_BYTE,!0,this.staticStride*4,_.offset*4):this.vao.addAttribute(this.staticBuffer,_.attribute,i.FLOAT,!1,this.staticStride*4,_.offset*4)}},r.prototype.uploadDynamic=function(i,e,n){for(var a=0;a<this.dynamicProperties.length;a++){var s=this.dynamicProperties[a];s.uploadFunction(i,e,n,s.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer.upload()},r.prototype.uploadStatic=function(i,e,n){for(var a=0;a<this.staticProperties.length;a++){var s=this.staticProperties[a];s.uploadFunction(i,e,n,s.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer.upload()},r.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},r}();Js.default=pD;Zs.__esModule=!0;var mD=at(),ur=xD(mD),gD=Qs,vD=fu(gD),yD=Js,Rl=fu(yD),TD=X;function fu(r){return r&&r.__esModule?r:{default:r}}function xD(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function wD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bD(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function ED(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var cu=function(r){ED(t,r);function t(i){wD(this,t);var e=bD(this,r.call(this,i));return e.shader=null,e.indexBuffer=null,e.properties=null,e.tempMatrix=new ur.Matrix,e.CONTEXT_UID=0,e}return t.prototype.onContextChange=function(){var e=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new vD.default(e),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},t.prototype.start=function(){this.renderer.bindShader(this.shader)},t.prototype.render=function(e){var n=e.children,a=e._maxSize,s=e._batchSize,o=this.renderer,l=n.length;if(l!==0){l>a&&(l=a);var h=e._glBuffers[o.CONTEXT_UID];h||(h=e._glBuffers[o.CONTEXT_UID]=this.generateBuffers(e));var u=n[0]._texture.baseTexture;this.renderer.setBlendMode(ur.utils.correctBlendMode(e.blendMode,u.premultipliedAlpha));var f=o.gl,d=e.worldTransform.copy(this.tempMatrix);d.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=d.toArray(!0),this.shader.uniforms.uColor=ur.utils.premultiplyRgba(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,u.premultipliedAlpha),this.shader.uniforms.uSampler=o.bindTexture(u);for(var p=!1,_=0,m=0;_<l;_+=s,m+=1){var g=l-_;if(g>s&&(g=s),m>=h.length){if(!e.autoResize)break;h.push(this._generateOneMoreBuffer(e))}var y=h[m];y.uploadDynamic(n,_,g);var w=e._bufferUpdateIDs[m]||0;p=p||y._updateID<w,p&&(y._updateID=e._updateID,y.uploadStatic(n,_,g)),o.bindVao(y.vao),y.vao.draw(f.TRIANGLES,g*6)}}},t.prototype.generateBuffers=function(e){for(var n=this.renderer.gl,a=[],s=e._maxSize,o=e._batchSize,l=e._properties,h=0;h<s;h+=o)a.push(new Rl.default(n,this.properties,l,o));return a},t.prototype._generateOneMoreBuffer=function(e){var n=this.renderer.gl,a=e._batchSize,s=e._properties;return new Rl.default(n,this.properties,s,a)},t.prototype.uploadVertices=function(e,n,a,s,o,l){for(var h=0,u=0,f=0,d=0,p=0;p<a;++p){var _=e[n+p],m=_._texture,g=_.scale.x,y=_.scale.y,w=m.trim,T=m.orig;w?(u=w.x-_.anchor.x*T.width,h=u+w.width,d=w.y-_.anchor.y*T.height,f=d+w.height):(h=T.width*(1-_.anchor.x),u=T.width*-_.anchor.x,f=T.height*(1-_.anchor.y),d=T.height*-_.anchor.y),s[l]=u*g,s[l+1]=d*y,s[l+o]=h*g,s[l+o+1]=d*y,s[l+o*2]=h*g,s[l+o*2+1]=f*y,s[l+o*3]=u*g,s[l+o*3+1]=f*y,l+=o*4}},t.prototype.uploadPosition=function(e,n,a,s,o,l){for(var h=0;h<a;h++){var u=e[n+h].position;s[l]=u.x,s[l+1]=u.y,s[l+o]=u.x,s[l+o+1]=u.y,s[l+o*2]=u.x,s[l+o*2+1]=u.y,s[l+o*3]=u.x,s[l+o*3+1]=u.y,l+=o*4}},t.prototype.uploadRotation=function(e,n,a,s,o,l){for(var h=0;h<a;h++){var u=e[n+h].rotation;s[l]=u,s[l+o]=u,s[l+o*2]=u,s[l+o*3]=u,l+=o*4}},t.prototype.uploadUvs=function(e,n,a,s,o,l){for(var h=0;h<a;++h){var u=e[n+h]._texture._uvs;u?(s[l]=u.x0,s[l+1]=u.y0,s[l+o]=u.x1,s[l+o+1]=u.y1,s[l+o*2]=u.x2,s[l+o*2+1]=u.y2,s[l+o*3]=u.x3,s[l+o*3+1]=u.y3,l+=o*4):(s[l]=0,s[l+1]=0,s[l+o]=0,s[l+o+1]=0,s[l+o*2]=0,s[l+o*2+1]=0,s[l+o*3]=0,s[l+o*3+1]=0,l+=o*4)}},t.prototype.uploadTint=function(e,n,a,s,o,l){for(var h=0;h<a;++h){var u=e[n+h],f=u._texture.baseTexture.premultipliedAlpha,d=u.alpha,p=d<1&&f?(0,TD.premultiplyTint)(u._tintRGB,d):u._tintRGB+(d*255<<24);s[l]=p,s[l+o]=p,s[l+o*2]=p,s[l+o*3]=p,l+=o*4}},t.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),r.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},t}(ur.ObjectRenderer);Zs.default=cu;ur.WebGLRenderer.registerPlugin("particle",cu);(function(r){r.__esModule=!0;var t=Ks;Object.defineProperty(r,"ParticleContainer",{enumerable:!0,get:function(){return e(t).default}});var i=Zs;Object.defineProperty(r,"ParticleRenderer",{enumerable:!0,get:function(){return e(i).default}});function e(n){return n&&n.__esModule?n:{default:n}}})(hu);var du={},js={},Wr={},fn={};fn.__esModule=!0;function SD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var DD=function(){function r(t){SD(this,r),this.maxItemsPerFrame=t,this.itemsLeft=0}return r.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},r.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},r}();fn.default=DD;Wr.__esModule=!0;var AD=at(),Dt=RD(AD),MD=fn,OD=PD(MD);function PD(r){return r&&r.__esModule?r:{default:r}}function RD(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function ID(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var oa=Dt.ticker.shared;Dt.settings.UPLOADS_PER_FRAME=4;var CD=function(){function r(t){var i=this;ID(this,r),this.limiter=new OD.default(Dt.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){i.queue&&i.prepareItems()},this.registerFindHook(UD),this.registerFindHook($D),this.registerFindHook(FD),this.registerFindHook(BD),this.registerFindHook(LD),this.registerUploadHook(ND),this.registerUploadHook(kD)}return r.prototype.upload=function(i,e){typeof i=="function"&&(e=i,i=null),i&&this.add(i),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,oa.addOnce(this.tick,this,Dt.UPDATE_PRIORITY.UTILITY))):e&&e()},r.prototype.tick=function(){setTimeout(this.delayedTick,0)},r.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var i=this.queue[0],e=!1;if(i&&!i._destroyed){for(var n=0,a=this.uploadHooks.length;n<a;n++)if(this.uploadHooks[n](this.uploadHookHelper,i)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)oa.addOnce(this.tick,this,Dt.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var s=this.completes.slice(0);this.completes.length=0;for(var o=0,l=s.length;o<l;o++)s[o]()}},r.prototype.registerFindHook=function(i){return i&&this.addHooks.push(i),this},r.prototype.registerUploadHook=function(i){return i&&this.uploadHooks.push(i),this},r.prototype.add=function(i){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](i,this.queue);e++);if(i instanceof Dt.Container)for(var a=i.children.length-1;a>=0;a--)this.add(i.children[a]);return this},r.prototype.destroy=function(){this.ticking&&oa.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},r}();Wr.default=CD;function FD(r,t){var i=!1;if(r&&r._textures&&r._textures.length){for(var e=0;e<r._textures.length;e++)if(r._textures[e]instanceof Dt.Texture){var n=r._textures[e].baseTexture;t.indexOf(n)===-1&&(t.push(n),i=!0)}}return i}function BD(r,t){return r instanceof Dt.BaseTexture?(t.indexOf(r)===-1&&t.push(r),!0):!1}function LD(r,t){if(r._texture&&r._texture instanceof Dt.Texture){var i=r._texture.baseTexture;return t.indexOf(i)===-1&&t.push(i),!0}return!1}function ND(r,t){return t instanceof Dt.Text?(t.updateText(!0),!0):!1}function kD(r,t){if(t instanceof Dt.TextStyle){var i=t.toFontString();return Dt.TextMetrics.measureFont(i),!0}return!1}function UD(r,t){if(r instanceof Dt.Text){t.indexOf(r.style)===-1&&t.push(r.style),t.indexOf(r)===-1&&t.push(r);var i=r._texture.baseTexture;return t.indexOf(i)===-1&&t.push(i),!0}return!1}function $D(r,t){return r instanceof Dt.TextStyle?(t.indexOf(r)===-1&&t.push(r),!0):!1}js.__esModule=!0;var GD=at(),cn=HD(GD),XD=Wr,VD=WD(XD);function WD(r){return r&&r.__esModule?r:{default:r}}function HD(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function YD(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function zD(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function qD(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var _u=function(r){qD(t,r);function t(i){YD(this,t);var e=zD(this,r.call(this,i));return e.uploadHookHelper=e.renderer,e.registerFindHook(QD),e.registerUploadHook(KD),e.registerUploadHook(ZD),e}return t}(VD.default);js.default=_u;function KD(r,t){return t instanceof cn.BaseTexture?(t._glTextures[r.CONTEXT_UID]||r.textureManager.updateTexture(t),!0):!1}function ZD(r,t){return t instanceof cn.Graphics?((t.dirty||t.clearDirty||!t._webGL[r.plugins.graphics.CONTEXT_UID])&&r.plugins.graphics.updateGraphics(t),!0):!1}function QD(r,t){return r instanceof cn.Graphics?(t.push(r),!0):!1}cn.WebGLRenderer.registerPlugin("prepare",_u);var to={};to.__esModule=!0;var JD=at(),pu=rA(JD),jD=Wr,tA=eA(jD);function eA(r){return r&&r.__esModule?r:{default:r}}function rA(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t.default=r,t}function iA(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function nA(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:r}function aA(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}var Il=16,mu=function(r){aA(t,r);function t(i){iA(this,t);var e=nA(this,r.call(this,i));return e.uploadHookHelper=e,e.canvas=document.createElement("canvas"),e.canvas.width=Il,e.canvas.height=Il,e.ctx=e.canvas.getContext("2d"),e.registerUploadHook(sA),e}return t.prototype.destroy=function(){r.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(tA.default);to.default=mu;function sA(r,t){if(t instanceof pu.BaseTexture){var i=t.source,e=i.width===0?r.canvas.width:Math.min(r.canvas.width,i.width),n=i.height===0?r.canvas.height:Math.min(r.canvas.height,i.height);return r.ctx.drawImage(i,0,0,e,n,0,0,r.canvas.width,r.canvas.height),!0}return!1}pu.CanvasRenderer.registerPlugin("prepare",mu);var eo={};eo.__esModule=!0;function oA(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}var lA=function(){function r(t){oA(this,r),this.maxMilliseconds=t,this.frameStart=0}return r.prototype.beginFrame=function(){this.frameStart=Date.now()},r.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},r}();eo.default=lA;(function(r){r.__esModule=!0;var t=js;Object.defineProperty(r,"webgl",{enumerable:!0,get:function(){return s(t).default}});var i=to;Object.defineProperty(r,"canvas",{enumerable:!0,get:function(){return s(i).default}});var e=Wr;Object.defineProperty(r,"BasePrepare",{enumerable:!0,get:function(){return s(e).default}});var n=fn;Object.defineProperty(r,"CountLimiter",{enumerable:!0,get:function(){return s(n).default}});var a=eo;Object.defineProperty(r,"TimeLimiter",{enumerable:!0,get:function(){return s(a).default}});function s(o){return o&&o.__esModule?o:{default:o}}})(du);(function(r){r.__esModule=!0,r.loader=r.prepare=r.particles=r.mesh=r.loaders=r.interaction=r.filters=r.extras=r.extract=r.accessibility=void 0;var t=Ju;Object.keys(t).forEach(function(O){O==="default"||O==="__esModule"||Object.defineProperty(r,O,{enumerable:!0,get:function(){return t[O]}})});var i=at();Object.keys(i).forEach(function(O){O==="default"||O==="__esModule"||Object.defineProperty(r,O,{enumerable:!0,get:function(){return i[O]}})});var e=Ts,n=S(e),a=Ch,s=D(a),o=Bh,l=D(o),h=Ss,u=D(h),f=Hh,d=D(f),p=zh,_=D(p),m=Kh,g=D(m),y=iu,w=D(y),T=hu,x=D(T),E=du,b=D(E);function D(O){if(O&&O.__esModule)return O;var F={};if(O!=null)for(var L in O)Object.prototype.hasOwnProperty.call(O,L)&&(F[L]=O[L]);return F.default=O,F}function S(O){return O&&O.__esModule?O:{default:O}}i.utils.mixins.performMixins();var M=g.shared||null;r.accessibility=s,r.extract=l,r.extras=u,r.filters=d,r.interaction=_,r.loaders=g,r.mesh=w,r.particles=x,r.prepare=b,r.loader=M,typeof n.default=="function"&&(0,n.default)(r),Tt.PIXI=r})(Z);class Cl extends Z.Sprite{constructor(){super(...arguments);xt(this,"debugDraw",!1);xt(this,"_debugDraw",!1);xt(this,"_armature",null);xt(this,"_debugDrawer",null)}dbInit(i){this._armature=i}dbClear(){this._debugDrawer!==null&&this._debugDrawer.destroy(!0),this._armature=null,this._debugDrawer=null,super.destroy()}dbUpdate(){const i=Ct.debugDraw||this.debugDraw;if(i||this._debugDraw)if(this._debugDraw=i,this._debugDraw){if(this._debugDrawer===null){this._debugDrawer=new Z.Sprite;const s=new Z.Graphics;this._debugDrawer.addChild(s)}this.addChild(this._debugDrawer);const e=this._debugDrawer.getChildAt(0);e.clear();const n=this._armature.getBones();for(let s=0,o=n.length;s<o;++s){const l=n[s],h=l.boneData.length,u=l.globalTransformMatrix.tx,f=l.globalTransformMatrix.ty,d=u+l.globalTransformMatrix.a*h,p=f+l.globalTransformMatrix.b*h;e.lineStyle(2,65535,.7),e.moveTo(u,f),e.lineTo(d,p),e.lineStyle(0,0,0),e.beginFill(65535,.7),e.drawCircle(u,f,3),e.endFill()}const a=this._armature.getSlots();for(let s=0,o=a.length;s<o;++s){const l=a[s],h=l.boundingBoxData;if(h){let u=this._debugDrawer.getChildByName(l.name);switch(u||(u=new Z.Graphics,u.name=l.name,this._debugDrawer.addChild(u)),u.clear(),u.lineStyle(2,16711935,.7),h.type){case yt.Rectangle:u.drawRect(-h.width*.5,-h.height*.5,h.width,h.height);break;case yt.Ellipse:u.drawEllipse(-h.width*.5,-h.height*.5,h.width,h.height);break;case yt.Polygon:const d=h.vertices;for(let p=0,_=d.length;p<_;p+=2){const m=d[p],g=d[p+1];p===0?u.moveTo(m,g):u.lineTo(m,g)}u.lineTo(d[0],d[1]);break}u.endFill(),l.updateTransformAndMatrix(),l.updateGlobalTransform();const f=l.global;u.setTransform(f.x,f.y,f.scaleX,f.scaleY,f.rotation,f.skew,0,l._pivotX,l._pivotY)}else{const u=this._debugDrawer.getChildByName(l.name);u&&this._debugDrawer.removeChild(u)}}}else this._debugDrawer!==null&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer)}dispose(i=!0){this._armature!==null&&(this._armature.dispose(),this._armature=null)}destroy(){this.dispose()}dispatchDBEvent(i,e){this.emit(i,e)}hasDBEventListener(i){return this.listeners(i,!0)}addDBEventListener(i,e,n){this.addListener(i,e,n)}removeDBEventListener(i,e,n){this.removeListener(i,e,n)}get armature(){return this._armature}get animation(){return this._armature.animation}}class gu extends Qu{constructor(){super(...arguments);xt(this,"_renderTexture",null)}static toString(){return"[class dragonBones.PixiTextureAtlasData]"}_onClear(){super._onClear(),this._renderTexture,this._renderTexture=null}createTexture(){return R.borrowObject(hA)}get renderTexture(){return this._renderTexture}set renderTexture(i){if(this._renderTexture!==i)if(this._renderTexture=i,this._renderTexture!==null)for(let e in this.textures){const n=this.textures[e];n.renderTexture=new Z.Texture(this._renderTexture,new Z.Rectangle(n.region.x,n.region.y,n.region.width,n.region.height),new Z.Rectangle(n.region.x,n.region.y,n.region.width,n.region.height),new Z.Rectangle(0,0,n.region.width,n.region.height),n.rotated)}else for(let e in this.textures){const n=this.textures[e];n.renderTexture=null}}}class hA extends Ei{constructor(){super(...arguments);xt(this,"renderTexture",null)}static toString(){return"[class dragonBones.PixiTextureData]"}_onClear(){super._onClear(),this.renderTexture!==null&&this.renderTexture.destroy(!1),this.renderTexture=null}}class uA extends tt{constructor(){super(...arguments);xt(this,"_textureScale",1);xt(this,"_renderDisplay",null)}static toString(){return"[class dragonBones.PixiSlot]"}_onClear(){super._onClear(),this._textureScale=1,this._renderDisplay=null,this._updateTransform=Z.VERSION[0]==="3"?this._updateTransformV3:this._updateTransformV4}_initDisplay(i,e){}_disposeDisplay(i,e){e||i.destroy()}_onUpdateDisplay(){this._renderDisplay=this._display?this._display:this._rawDisplay}_addDisplay(){if(this._armature===null)throw new Error("this._armature is null.");if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");this._armature.display.addChild(this._renderDisplay)}_replaceDisplay(i){if(this._armature===null)throw new Error("this._armature is null.");if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");const e=this._armature.display,n=i;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,n),e.removeChild(n),this._textureScale=1}_removeDisplay(){if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");this._renderDisplay.parent.removeChild(this._renderDisplay)}_updateZOrder(){if(this._armature===null)throw new Error("this._armature is null.");if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");const i=this._armature.display;i.getChildIndex(this._renderDisplay)!==this._zOrder&&i.addChildAt(this._renderDisplay,this._zOrder)}_updateVisible(){if(this._parent===null)throw new Error("this._parent is null.");if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");this._renderDisplay.visible=this._parent.visible&&this._visible}_updateBlendMode(){if(this._renderDisplay instanceof Z.Sprite)switch(this._blendMode){case st.Normal:this._renderDisplay.blendMode=Z.BLEND_MODES.NORMAL;break;case st.Add:this._renderDisplay.blendMode=Z.BLEND_MODES.ADD;break;case st.Darken:this._renderDisplay.blendMode=Z.BLEND_MODES.DARKEN;break;case st.Difference:this._renderDisplay.blendMode=Z.BLEND_MODES.DIFFERENCE;break;case st.HardLight:this._renderDisplay.blendMode=Z.BLEND_MODES.HARD_LIGHT;break;case st.Lighten:this._renderDisplay.blendMode=Z.BLEND_MODES.LIGHTEN;break;case st.Multiply:this._renderDisplay.blendMode=Z.BLEND_MODES.MULTIPLY;break;case st.Overlay:this._renderDisplay.blendMode=Z.BLEND_MODES.OVERLAY;break;case st.Screen:this._renderDisplay.blendMode=Z.BLEND_MODES.SCREEN;break}}_updateColor(){if(this._renderDisplay===null)throw new Error("this._renderDisplay is null.");const i=this._colorTransform.alphaMultiplier*this._globalAlpha;if(this._renderDisplay.alpha=i,this._renderDisplay instanceof Z.Sprite||this._renderDisplay instanceof Z.mesh.Mesh){const e=(Math.round(this._colorTransform.redMultiplier*255)<<16)+(Math.round(this._colorTransform.greenMultiplier*255)<<8)+Math.round(this._colorTransform.blueMultiplier*255);this._renderDisplay.tint=e}}_updateFrame(){let i=this._textureData;if(this._displayIndex>=0&&this._display!==null&&i!==null){let e=i.parent;if(this._armature===null)throw new Error("this._armature is null.");if(i.parent===null)throw new Error("currentTextureData.parent is null.");this._armature.replacedTexture!==null&&(this._armature._replaceTextureAtlasData===null?(e=R.borrowObject(gu),e.copyFrom(i.parent),e.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=e):e=this._armature._replaceTextureAtlasData,i=e.getTexture(i.name));const n=i.renderTexture;if(n!==null){if(this._geometryData!==null){const a=this._geometryData.data;if(a===null)throw new Error("data is null.");const s=a.intArray,o=a.floatArray;if(s===null)throw new Error("intArray is null.");const l=s[this._geometryData.offset+P.GeometryVertexCount],h=s[this._geometryData.offset+P.GeometryTriangleCount];let u=s[this._geometryData.offset+P.GeometryFloatOffset];u<0&&(u+=65536);const f=u+l*2;if(this._armature._armatureData===null)throw new Error("this._armature._armatureData is null.");const d=this._armature._armatureData.scale,p=this._renderDisplay,_=e.width>0?e.width:n.baseTexture.width,m=e.height>0?e.height:n.baseTexture.height,g=i.region;if(o===null)throw new Error("floatArrayis null.");p.vertices=new Float32Array(l*2),p.uvs=new Float32Array(l*2),p.indices=new Uint16Array(h*3);for(let T=0,x=l*2;T<x;++T)p.vertices[T]=o[u+T]*d;for(let T=0;T<h*3;++T)p.indices[T]=s[this._geometryData.offset+P.GeometryVertexIndices+T];for(let T=0,x=l*2;T<x;T+=2){const E=o[f+T],b=o[f+T+1];i.rotated?(p.uvs[T]=(g.x+(1-b)*g.width)/_,p.uvs[T+1]=(g.y+E*g.height)/m):(p.uvs[T]=(g.x+E*g.width)/_,p.uvs[T+1]=(g.y+b*g.height)/m)}if(this._textureScale=1,p.texture=n,p.dirty++,p.indexDirty++,this._parent===null)throw new Error("this._parentis null.");if(this._parent._boneData===null)throw new Error("this._parent._boneDatais null.");const y=this._geometryData.weight!==null,w=this._parent._boneData.type!==mt.Bone;(y||w)&&this._identityTransform()}else{if(i.parent===null)throw new Error("currentTextureData.parentis null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData null.");this._textureScale=i.parent.scale*this._armature._armatureData.scale;const a=this._renderDisplay;a.texture=n}this._visibleDirty=!0;return}}if(this._geometryData!==null){const e=this._renderDisplay;e.texture=null,e.x=0,e.y=0,e.visible=!1}else{const e=this._renderDisplay;e.texture=null,e.x=0,e.y=0,e.visible=!1}}_updateMesh(){if(this._armature===null)throw new Error("this._armature null.");if(this._armature._armatureData===null)throw new Error("this._armature._armatureData null.");const i=this._armature._armatureData.scale,e=this._displayFrame.deformVertices,n=this._geometryBones,a=this._geometryData,s=a.weight,o=e.length>0&&a.inheritDeform,l=this._renderDisplay;if(s!==null){const h=a.data;if(h===null)throw new Error("data null.");const u=h.intArray,f=h.floatArray;if(u===null)throw new Error("intArray null.");const d=u[a.offset+P.GeometryVertexCount];let p=u[s.offset+P.WeigthFloatOffset];p<0&&(p+=65536);for(let _=0,m=0,g=s.offset+P.WeigthBoneIndices+n.length,y=p,w=0;_<d;++_){const T=u[g++];let x=0,E=0;for(let b=0;b<T;++b){const D=u[g++],S=n[D];if(S!==null){const M=S.globalTransformMatrix;if(f===null)throw new Error("floatArray null.");const O=f[y++];let F=f[y++]*i,L=f[y++]*i;o&&(F+=e[w++],L+=e[w++]),x+=(M.a*F+M.c*L+M.tx)*O,E+=(M.b*F+M.d*L+M.ty)*O}}l.vertices[m++]=x,l.vertices[m++]=E}}else{if(this._parent===null)throw new Error("this._parent null.");if(this._parent._boneData===null)throw new Error("this._parent._boneData null.");const h=this._parent._boneData.type!==mt.Bone,u=a.data;if(u===null)throw new Error("data null.");const f=u.intArray,d=u.floatArray;if(f===null)throw new Error("intArray null.");const p=f[a.offset+P.GeometryVertexCount];let _=f[a.offset+P.GeometryFloatOffset];if(_<0&&(_+=65536),d===null)throw new Error("floatArray null.");for(let m=0,g=p*2;m<g;m+=2){let y=d[_+m]*i,w=d[_+m+1]*i;if(o&&(y+=e[m],w+=e[m+1]),h){const T=this._parent._getGlobalTransformMatrix(y,w);l.vertices[m]=T.a*y+T.c*w+T.tx,l.vertices[m+1]=T.b*y+T.d*w+T.ty}else l.vertices[m]=y,l.vertices[m+1]=w}}}_updateTransform(){throw new Error}_updateTransformV3(){this.updateGlobalTransform();const i=this.global;if(this._renderDisplay===null)throw new Error(" this._renderDisplay null.");if(this._renderDisplay===this._rawDisplay||this._renderDisplay===this._meshDisplay){const e=i.x-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),n=i.y-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);this._renderDisplay.setTransform(e,n,i.scaleX*this._textureScale,i.scaleY*this._textureScale,i.rotation,i.skew,0)}else this._renderDisplay.position.set(i.x,i.y),this._renderDisplay.rotation=i.rotation,this._renderDisplay.skew.set(i.skew,0),this._renderDisplay.scale.set(i.scaleX,i.scaleY)}_updateTransformV4(){this.updateGlobalTransform();const i=this.global;if(this._renderDisplay===null)throw new Error(" this._renderDisplay null.");if(this._renderDisplay===this._rawDisplay||this._renderDisplay===this._meshDisplay){const e=i.x-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),n=i.y-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);this._renderDisplay.setTransform(e,n,i.scaleX*this._textureScale,i.scaleY*this._textureScale,i.rotation,-i.skew,0)}else this._renderDisplay.position.set(i.x,i.y),this._renderDisplay.rotation=i.rotation,this._renderDisplay.skew.set(-i.skew,0),this._renderDisplay.scale.set(i.scaleX,i.scaleY)}_identityTransform(){if(this._renderDisplay===null)throw new Error(" this._renderDisplay null.");this._renderDisplay.setTransform(0,0,1,1,0,0,0)}}const Ut=class extends ua{static _clockHandler(t){this._dragonBonesInstance.advanceTime(Z.ticker.shared.elapsedMS*t*.001)}static get factory(){return Ut._factory===null&&(Ut._factory=new Ut),Ut._factory}constructor(t=null){if(super(t),Ut._dragonBonesInstance===null){const i=new Cl;Ut._dragonBonesInstance=new Ct(i),Z.ticker.shared.add(Ut._clockHandler,Ut)}this._dragonBones=Ut._dragonBonesInstance}_buildTextureAtlasData(t,i){return t?t.renderTexture=i:t=R.borrowObject(gu),t}_buildArmature(t){const i=R.borrowObject(le),e=new Cl;if(t.armature===null)throw new Error("dataPackage.armature is null.");if(this._dragonBones===null)throw new Error("this._dragonBones is null.");return i.init(t.armature,e,e,this._dragonBones),i}_buildSlot(t,i,e){const n=R.borrowObject(uA);return n.init(i,e,new Z.Sprite,new Z.mesh.Mesh(null,null,null,null,Z.mesh.Mesh.DRAW_MODES.TRIANGLES)),n}buildArmatureDisplay(t,i="",e="",n=""){const a=this.buildArmature(t,i||"",e||"",n||"");if(a!==null){if(this._dragonBones===null)throw new Error("this._dragonBones is null.");return this._dragonBones.clock.add(a),a.display}return null}getTextureDisplay(t,i=null){const e=this._getTextureData(i!==null?i:"",t);return e!==null&&e.renderTexture!==null?new Z.Sprite(e.renderTexture):null}get soundEventManager(){if(this._dragonBones===null)throw new Error("this._dragonBones is null.");return this._dragonBones.eventManager}};let di=Ut;xt(di,"_dragonBonesInstance",null),xt(di,"_factory",null);const fA=""+new URL("background-61dad7bd.png",import.meta.url).href,yi=class extends Z.Container{constructor(i=!0){super();xt(this,"_renderer",new Z.WebGLRenderer(1136,640));xt(this,"_background",new Z.Sprite(Z.Texture.EMPTY));xt(this,"_resources",[]);xt(this,"_pixiResources",{});this._renderer.backgroundColor=6710886,this._resources.push(yi.BACKGROUND_URL),document.body.appendChild(this._renderer.view),i&&setTimeout(()=>{this.x=this.stageWidth*.5,this.y=this.stageHeight*.5,this._loadResources()},10)}_renderHandler(i){this._renderer.render(this)}_startRenderTick(){Z.ticker.shared.add(this._renderHandler,this)}_loadResources(){const i={loadType:Z.loaders.Resource.LOAD_TYPE.XHR,xhrType:Z.loaders.Resource.XHR_RESPONSE_TYPE.BUFFER};for(const e of this._resources)e.indexOf("dbbin")>0?Z.loader.add(e,e,i):Z.loader.add(e,e);Z.loader.once("complete",(e,n)=>{this._pixiResources=n,this._background.texture=this._pixiResources[yi.BACKGROUND_URL].texture,this._background.x=-this._background.texture.width*.5,this._background.y=-this._background.texture.height*.5,this.addChild(this._background),this._onStart(),this._startRenderTick()}),Z.loader.load()}createText(i){const e=new Z.Text(i,{align:"center"});return e.text=i,e.scale.x=.7,e.scale.y=.7,e.x=-e.width*.5,e.y=this.stageHeight*.5-100,this.addChild(e),e}get stageWidth(){return this._renderer.width}get stageHeight(){return this._renderer.height}};let la=yi;xt(la,"BACKGROUND_URL",fA);export{la as B,R as E,rt as L,Y as N,di as P,Z as l,ar as w};
