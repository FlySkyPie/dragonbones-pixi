var w=Object.defineProperty;var H=(a,s,t)=>s in a?w(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var h=(a,s,t)=>(H(a,typeof s!="symbol"?s+"":s,t),t);import{B as T,l as D,P as o,E as P}from"./BaseDemo-21616005.js";import{m as l,a as m,b as _}from"./mecha_1406_tex-2bd5e653.js";class v extends T{constructor(){super();h(this,"_addingArmature",!1);h(this,"_removingArmature",!1);h(this,"_armatures",[]);h(this,"_text",null);this._resources.push(l,m,_)}_onStart(){this.interactive=!0,this.addListener("touchstart",this._touchHandler,this),this.addListener("touchend",this._touchHandler,this),this.addListener("mousedown",this._touchHandler,this),this.addListener("mouseup",this._touchHandler,this),D.ticker.shared.add(this._enterFrameHandler,this),this._text=this.createText("");for(let t=0;t<300;++t)this._addArmature();this._resetPosition(),this._updateText()}_enterFrameHandler(t){if(this._addingArmature){for(let e=0;e<10;++e)this._addArmature();this._resetPosition(),this._updateText()}if(this._removingArmature){for(let e=0;e<10;++e)this._removeArmature();this._resetPosition(),this._updateText()}}_touchHandler(t){switch(t.type){case"touchstart":case"mousedown":const e=t.data.global.x>this.stageWidth*.5;this._addingArmature=e,this._removingArmature=!e;break;case"touchend":case"mouseup":this._addingArmature=!1,this._removingArmature=!1;break}}_addArmature(){const t=o.factory;this._armatures.length===0&&(t.parseDragonBonesData(this._pixiResources[l].data),t.parseTextureAtlasData(this._pixiResources[m].data,this._pixiResources[_].texture));const e=o.factory.buildArmatureDisplay("mecha_1406");if(e===null)throw new Error("armatureDisplay is null.");e.armature.cacheFrameRate=24,e.animation.play("walk",0),e.scale.x=e.scale.y=.5,this.addChild(e),this._armatures.push(e)}_removeArmature(){if(this._armatures.length===0)return;const t=this._armatures.pop();if(t===void 0)throw new Error("armatureDisplay is undefined.");this.removeChild(t),t.dispose(),this._armatures.length===0&&(o.factory.clear(!0),P.clearPool())}_resetPosition(){const t=this._armatures.length;if(t===0)return;const e=100,n=200,g=100,u=90,d=this.stageWidth-e*2,r=Math.floor(d/u),p=(this.stageWidth-r*u)*.5,f=d/r,x=(this.stageHeight-n-g)/Math.ceil(t/r);for(let i=0,y=t;i<y;++i){const c=this._armatures[i],A=Math.floor(i/r);c.x=i%r*f+p-this.stageWidth*.5,c.y=A*x+n-this.stageHeight*.5}}_updateText(){if(this._text===null)throw new Error("this._text is null.");this._text.text="Count: "+this._armatures.length+". Touch screen left to decrease count / right to increase count.",this._text.x=-this._text.width*.5,this._text.y=this.stageHeight*.5-100,this.addChild(this._text)}}new v;
